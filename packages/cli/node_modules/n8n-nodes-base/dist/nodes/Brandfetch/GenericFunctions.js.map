{"version":3,"sources":["../../../nodes/Brandfetch/GenericFunctions.ts"],"sourcesContent":["import type {\n\tIDataObject,\n\tIExecuteFunctions,\n\tIHookFunctions,\n\tIHttpRequestMethods,\n\tIRequestOptions,\n\tILoadOptionsFunctions,\n\tINodeExecutionData,\n\tJsonObject,\n} from 'n8n-workflow';\nimport { NodeApiError } from 'n8n-workflow';\n\nexport async function brandfetchApiRequest(\n\tthis: IHookFunctions | IExecuteFunctions | ILoadOptionsFunctions,\n\tmethod: IHttpRequestMethods,\n\tresource: string,\n\tbody: any = {},\n\tqs: IDataObject = {},\n\turi?: string,\n\toption: IDataObject = {},\n): Promise<any> {\n\ttry {\n\t\tlet options: IRequestOptions = {\n\t\t\tmethod: method as IHttpRequestMethods,\n\t\t\tqs,\n\t\t\tbody,\n\t\t\turl: uri || `https://api.brandfetch.io/v2${resource}`,\n\t\t\tjson: true,\n\t\t};\n\n\t\toptions = Object.assign({}, options, option);\n\n\t\tif (this.getNodeParameter('operation', 0) === 'logo' && options.json === false) {\n\t\t\tdelete options.headers;\n\t\t}\n\n\t\tif (!Object.keys(body as IDataObject).length) {\n\t\t\tdelete options.body;\n\t\t}\n\t\tif (!Object.keys(qs).length) {\n\t\t\tdelete options.qs;\n\t\t}\n\n\t\tconst response = await this.helpers.requestWithAuthentication.call(\n\t\t\tthis,\n\t\t\t'brandfetchApi',\n\t\t\toptions,\n\t\t);\n\n\t\tif (response.statusCode && response.statusCode !== 200) {\n\t\t\tthrow new NodeApiError(this.getNode(), response as JsonObject);\n\t\t}\n\n\t\treturn response;\n\t} catch (error) {\n\t\tthrow new NodeApiError(this.getNode(), error as JsonObject);\n\t}\n}\n\nexport async function fetchAndPrepareBinaryData(\n\tthis: IExecuteFunctions,\n\timageType: string,\n\timageFormat: string,\n\tlogoFormats: IDataObject,\n\tdomain: string,\n\tnewItem: INodeExecutionData,\n) {\n\tconst data = await brandfetchApiRequest.call(this, 'GET', '', {}, {}, logoFormats.src as string, {\n\t\tjson: false,\n\t\tencoding: null,\n\t});\n\n\tnewItem.binary![`${imageType}_${imageFormat}`] = await this.helpers.prepareBinaryData(\n\t\tBuffer.from(data),\n\t\t`${imageType}_${domain}.${imageFormat}`,\n\t);\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA,0BAA6B;AAE7B,eAAsB,qBAErB,QACA,UACA,OAAY,CAAC,GACb,KAAkB,CAAC,GACnB,KACA,SAAsB,CAAC,GACR;AACf,MAAI;AACH,QAAI,UAA2B;AAAA,MAC9B;AAAA,MACA;AAAA,MACA;AAAA,MACA,KAAK,OAAO,+BAA+B,QAAQ;AAAA,MACnD,MAAM;AAAA,IACP;AAEA,cAAU,OAAO,OAAO,CAAC,GAAG,SAAS,MAAM;AAE3C,QAAI,KAAK,iBAAiB,aAAa,CAAC,MAAM,UAAU,QAAQ,SAAS,OAAO;AAC/E,aAAO,QAAQ;AAAA,IAChB;AAEA,QAAI,CAAC,OAAO,KAAK,IAAmB,EAAE,QAAQ;AAC7C,aAAO,QAAQ;AAAA,IAChB;AACA,QAAI,CAAC,OAAO,KAAK,EAAE,EAAE,QAAQ;AAC5B,aAAO,QAAQ;AAAA,IAChB;AAEA,UAAM,WAAW,MAAM,KAAK,QAAQ,0BAA0B;AAAA,MAC7D;AAAA,MACA;AAAA,MACA;AAAA,IACD;AAEA,QAAI,SAAS,cAAc,SAAS,eAAe,KAAK;AACvD,YAAM,IAAI,iCAAa,KAAK,QAAQ,GAAG,QAAsB;AAAA,IAC9D;AAEA,WAAO;AAAA,EACR,SAAS,OAAO;AACf,UAAM,IAAI,iCAAa,KAAK,QAAQ,GAAG,KAAmB;AAAA,EAC3D;AACD;AAEA,eAAsB,0BAErB,WACA,aACA,aACA,QACA,SACC;AACD,QAAM,OAAO,MAAM,qBAAqB,KAAK,MAAM,OAAO,IAAI,CAAC,GAAG,CAAC,GAAG,YAAY,KAAe;AAAA,IAChG,MAAM;AAAA,IACN,UAAU;AAAA,EACX,CAAC;AAED,UAAQ,OAAQ,GAAG,SAAS,IAAI,WAAW,EAAE,IAAI,MAAM,KAAK,QAAQ;AAAA,IACnE,OAAO,KAAK,IAAI;AAAA,IAChB,GAAG,SAAS,IAAI,MAAM,IAAI,WAAW;AAAA,EACtC;AACD;","names":[]}