{"version":3,"sources":["../../../nodes/ApiTemplateIo/GenericFunctions.ts"],"sourcesContent":["import type {\n\tIExecuteFunctions,\n\tILoadOptionsFunctions,\n\tJsonObject,\n\tIRequestOptions,\n\tIHttpRequestMethods,\n} from 'n8n-workflow';\nimport { NodeApiError } from 'n8n-workflow';\n\nexport async function apiTemplateIoApiRequest(\n\tthis: IExecuteFunctions | ILoadOptionsFunctions,\n\tmethod: IHttpRequestMethods,\n\tendpoint: string,\n\tqs = {},\n\tbody = {},\n) {\n\tconst options: IRequestOptions = {\n\t\theaders: {\n\t\t\t'user-agent': 'n8n',\n\t\t\tAccept: 'application/json',\n\t\t},\n\t\turi: `https://api.apitemplate.io/v1${endpoint}`,\n\t\tmethod,\n\t\tqs,\n\t\tbody,\n\t\tfollowRedirect: true,\n\t\tfollowAllRedirects: true,\n\t\tjson: true,\n\t};\n\n\tif (!Object.keys(body).length) {\n\t\tdelete options.body;\n\t}\n\n\tif (!Object.keys(qs).length) {\n\t\tdelete options.qs;\n\t}\n\n\ttry {\n\t\tconst response = await this.helpers.requestWithAuthentication.call(\n\t\t\tthis,\n\t\t\t'apiTemplateIoApi',\n\t\t\toptions,\n\t\t);\n\t\tif (response.status === 'error') {\n\t\t\tthrow new NodeApiError(this.getNode(), response.message as JsonObject);\n\t\t}\n\t\treturn response;\n\t} catch (error) {\n\t\tthrow new NodeApiError(this.getNode(), error as JsonObject);\n\t}\n}\n\nexport async function loadResource(this: ILoadOptionsFunctions, resource: 'image' | 'pdf') {\n\tconst target = resource === 'image' ? ['JPEG', 'PNG'] : ['PDF'];\n\tconst templates = await apiTemplateIoApiRequest.call(this, 'GET', '/list-templates');\n\tconst filtered = templates.filter(({ format }: { format: 'PDF' | 'JPEG' | 'PNG' }) =>\n\t\ttarget.includes(format),\n\t);\n\n\treturn filtered.map(({ format, name, id }: { format: string; name: string; id: string }) => ({\n\t\tname: `${name} (${format})`,\n\t\tvalue: id,\n\t}));\n}\n\nexport function validateJSON(json: string | object | undefined): any {\n\tlet result;\n\tif (typeof json === 'object') {\n\t\treturn json;\n\t}\n\ttry {\n\t\tresult = JSON.parse(json!);\n\t} catch (exception) {\n\t\tresult = undefined;\n\t}\n\treturn result;\n}\n\nexport async function downloadImage(this: IExecuteFunctions, url: string) {\n\treturn await this.helpers.request({\n\t\turi: url,\n\t\tmethod: 'GET',\n\t\tjson: false,\n\t\tencoding: null,\n\t});\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA,0BAA6B;AAE7B,eAAsB,wBAErB,QACA,UACA,KAAK,CAAC,GACN,OAAO,CAAC,GACP;AACD,QAAM,UAA2B;AAAA,IAChC,SAAS;AAAA,MACR,cAAc;AAAA,MACd,QAAQ;AAAA,IACT;AAAA,IACA,KAAK,gCAAgC,QAAQ;AAAA,IAC7C;AAAA,IACA;AAAA,IACA;AAAA,IACA,gBAAgB;AAAA,IAChB,oBAAoB;AAAA,IACpB,MAAM;AAAA,EACP;AAEA,MAAI,CAAC,OAAO,KAAK,IAAI,EAAE,QAAQ;AAC9B,WAAO,QAAQ;AAAA,EAChB;AAEA,MAAI,CAAC,OAAO,KAAK,EAAE,EAAE,QAAQ;AAC5B,WAAO,QAAQ;AAAA,EAChB;AAEA,MAAI;AACH,UAAM,WAAW,MAAM,KAAK,QAAQ,0BAA0B;AAAA,MAC7D;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,QAAI,SAAS,WAAW,SAAS;AAChC,YAAM,IAAI,iCAAa,KAAK,QAAQ,GAAG,SAAS,OAAqB;AAAA,IACtE;AACA,WAAO;AAAA,EACR,SAAS,OAAO;AACf,UAAM,IAAI,iCAAa,KAAK,QAAQ,GAAG,KAAmB;AAAA,EAC3D;AACD;AAEA,eAAsB,aAA0C,UAA2B;AAC1F,QAAM,SAAS,aAAa,UAAU,CAAC,QAAQ,KAAK,IAAI,CAAC,KAAK;AAC9D,QAAM,YAAY,MAAM,wBAAwB,KAAK,MAAM,OAAO,iBAAiB;AACnF,QAAM,WAAW,UAAU;AAAA,IAAO,CAAC,EAAE,OAAO,MAC3C,OAAO,SAAS,MAAM;AAAA,EACvB;AAEA,SAAO,SAAS,IAAI,CAAC,EAAE,QAAQ,MAAM,GAAG,OAAqD;AAAA,IAC5F,MAAM,GAAG,IAAI,KAAK,MAAM;AAAA,IACxB,OAAO;AAAA,EACR,EAAE;AACH;AAEO,SAAS,aAAa,MAAwC;AACpE,MAAI;AACJ,MAAI,OAAO,SAAS,UAAU;AAC7B,WAAO;AAAA,EACR;AACA,MAAI;AACH,aAAS,KAAK,MAAM,IAAK;AAAA,EAC1B,SAAS,WAAW;AACnB,aAAS;AAAA,EACV;AACA,SAAO;AACR;AAEA,eAAsB,cAAuC,KAAa;AACzE,SAAO,MAAM,KAAK,QAAQ,QAAQ;AAAA,IACjC,KAAK;AAAA,IACL,QAAQ;AAAA,IACR,MAAM;AAAA,IACN,UAAU;AAAA,EACX,CAAC;AACF;","names":[]}