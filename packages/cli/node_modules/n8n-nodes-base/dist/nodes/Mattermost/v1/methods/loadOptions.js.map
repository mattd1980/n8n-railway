{"version":3,"sources":["../../../../../nodes/Mattermost/v1/methods/loadOptions.ts"],"sourcesContent":["import type { IDataObject, ILoadOptionsFunctions, INodePropertyOptions } from 'n8n-workflow';\nimport { NodeOperationError } from 'n8n-workflow';\n\nimport { apiRequestAllItems } from '../transport';\n\n// Get all the available channels\nexport async function getChannels(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\tconst endpoint = 'channels';\n\tconst responseData = await apiRequestAllItems.call(this, 'GET', endpoint, {});\n\n\tif (responseData === undefined) {\n\t\tthrow new NodeOperationError(this.getNode(), 'No data got returned');\n\t}\n\n\tconst returnData: INodePropertyOptions[] = [];\n\tlet name: string;\n\tfor (const data of responseData) {\n\t\tif (data.delete_at !== 0 || !data.display_name || !data.name) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tname = `${data.team_display_name} - ${data.display_name || data.name} (${\n\t\t\tdata.type === 'O' ? 'public' : 'private'\n\t\t})`;\n\n\t\treturnData.push({\n\t\t\tname,\n\t\t\tvalue: data.id as string,\n\t\t});\n\t}\n\n\treturnData.sort((a, b) => {\n\t\tif (a.name < b.name) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (a.name > b.name) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t});\n\n\treturn returnData;\n}\n\n// Get all the channels in a team\nexport async function getChannelsInTeam(\n\tthis: ILoadOptionsFunctions,\n): Promise<INodePropertyOptions[]> {\n\tconst teamId = this.getCurrentNodeParameter('teamId');\n\tconst endpoint = `users/me/teams/${teamId}/channels`;\n\tconst responseData = await apiRequestAllItems.call(this, 'GET', endpoint, {});\n\n\tif (responseData === undefined) {\n\t\tthrow new NodeOperationError(this.getNode(), 'No data got returned');\n\t}\n\n\tconst returnData: INodePropertyOptions[] = [];\n\tlet name: string;\n\tfor (const data of responseData) {\n\t\tif (data.delete_at !== 0 || !data.display_name || !data.name) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst channelTypes: IDataObject = {\n\t\t\tD: 'direct',\n\t\t\tG: 'group',\n\t\t\tO: 'public',\n\t\t\tP: 'private',\n\t\t};\n\n\t\tname = `${data.display_name} (${channelTypes[data.type as string]})`;\n\n\t\treturnData.push({\n\t\t\tname,\n\t\t\tvalue: data.id as string,\n\t\t});\n\t}\n\n\treturnData.sort((a, b) => {\n\t\tif (a.name < b.name) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (a.name > b.name) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t});\n\n\treturn returnData;\n}\n\nexport async function getTeams(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\tconst endpoint = 'users/me/teams';\n\tconst responseData = await apiRequestAllItems.call(this, 'GET', endpoint, {});\n\n\tif (responseData === undefined) {\n\t\tthrow new NodeOperationError(this.getNode(), 'No data got returned');\n\t}\n\n\tconst returnData: INodePropertyOptions[] = [];\n\tlet name: string;\n\tfor (const data of responseData) {\n\t\tif (data.delete_at !== 0) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tname = `${data.display_name} (${data.type === 'O' ? 'public' : 'private'})`;\n\n\t\treturnData.push({\n\t\t\tname,\n\t\t\tvalue: data.id as string,\n\t\t});\n\t}\n\n\treturnData.sort((a, b) => {\n\t\tif (a.name < b.name) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (a.name > b.name) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t});\n\n\treturn returnData;\n}\n\nexport async function getUsers(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\tconst endpoint = 'users';\n\tconst responseData = await apiRequestAllItems.call(this, 'GET', endpoint, {});\n\n\tif (responseData === undefined) {\n\t\tthrow new NodeOperationError(this.getNode(), 'No data got returned');\n\t}\n\n\tconst returnData: INodePropertyOptions[] = [];\n\tfor (const data of responseData) {\n\t\tif (data.delete_at !== 0) {\n\t\t\tcontinue;\n\t\t}\n\n\t\treturnData.push({\n\t\t\tname: data.username as string,\n\t\t\tvalue: data.id as string,\n\t\t});\n\t}\n\n\treturnData.sort((a, b) => {\n\t\tif (a.name < b.name) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (a.name > b.name) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t});\n\n\treturn returnData;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,0BAAmC;AAEnC,uBAAmC;AAGnC,eAAsB,cAA0E;AAC/F,QAAM,WAAW;AACjB,QAAM,eAAe,MAAM,oCAAmB,KAAK,MAAM,OAAO,UAAU,CAAC,CAAC;AAE5E,MAAI,iBAAiB,QAAW;AAC/B,UAAM,IAAI,uCAAmB,KAAK,QAAQ,GAAG,sBAAsB;AAAA,EACpE;AAEA,QAAM,aAAqC,CAAC;AAC5C,MAAI;AACJ,aAAW,QAAQ,cAAc;AAChC,QAAI,KAAK,cAAc,KAAK,CAAC,KAAK,gBAAgB,CAAC,KAAK,MAAM;AAC7D;AAAA,IACD;AAEA,WAAO,GAAG,KAAK,iBAAiB,MAAM,KAAK,gBAAgB,KAAK,IAAI,KACnE,KAAK,SAAS,MAAM,WAAW,SAChC;AAEA,eAAW,KAAK;AAAA,MACf;AAAA,MACA,OAAO,KAAK;AAAA,IACb,CAAC;AAAA,EACF;AAEA,aAAW,KAAK,CAAC,GAAG,MAAM;AACzB,QAAI,EAAE,OAAO,EAAE,MAAM;AACpB,aAAO;AAAA,IACR;AACA,QAAI,EAAE,OAAO,EAAE,MAAM;AACpB,aAAO;AAAA,IACR;AACA,WAAO;AAAA,EACR,CAAC;AAED,SAAO;AACR;AAGA,eAAsB,oBAEa;AAClC,QAAM,SAAS,KAAK,wBAAwB,QAAQ;AACpD,QAAM,WAAW,kBAAkB,MAAM;AACzC,QAAM,eAAe,MAAM,oCAAmB,KAAK,MAAM,OAAO,UAAU,CAAC,CAAC;AAE5E,MAAI,iBAAiB,QAAW;AAC/B,UAAM,IAAI,uCAAmB,KAAK,QAAQ,GAAG,sBAAsB;AAAA,EACpE;AAEA,QAAM,aAAqC,CAAC;AAC5C,MAAI;AACJ,aAAW,QAAQ,cAAc;AAChC,QAAI,KAAK,cAAc,KAAK,CAAC,KAAK,gBAAgB,CAAC,KAAK,MAAM;AAC7D;AAAA,IACD;AAEA,UAAM,eAA4B;AAAA,MACjC,GAAG;AAAA,MACH,GAAG;AAAA,MACH,GAAG;AAAA,MACH,GAAG;AAAA,IACJ;AAEA,WAAO,GAAG,KAAK,YAAY,KAAK,aAAa,KAAK,IAAc,CAAC;AAEjE,eAAW,KAAK;AAAA,MACf;AAAA,MACA,OAAO,KAAK;AAAA,IACb,CAAC;AAAA,EACF;AAEA,aAAW,KAAK,CAAC,GAAG,MAAM;AACzB,QAAI,EAAE,OAAO,EAAE,MAAM;AACpB,aAAO;AAAA,IACR;AACA,QAAI,EAAE,OAAO,EAAE,MAAM;AACpB,aAAO;AAAA,IACR;AACA,WAAO;AAAA,EACR,CAAC;AAED,SAAO;AACR;AAEA,eAAsB,WAAuE;AAC5F,QAAM,WAAW;AACjB,QAAM,eAAe,MAAM,oCAAmB,KAAK,MAAM,OAAO,UAAU,CAAC,CAAC;AAE5E,MAAI,iBAAiB,QAAW;AAC/B,UAAM,IAAI,uCAAmB,KAAK,QAAQ,GAAG,sBAAsB;AAAA,EACpE;AAEA,QAAM,aAAqC,CAAC;AAC5C,MAAI;AACJ,aAAW,QAAQ,cAAc;AAChC,QAAI,KAAK,cAAc,GAAG;AACzB;AAAA,IACD;AAEA,WAAO,GAAG,KAAK,YAAY,KAAK,KAAK,SAAS,MAAM,WAAW,SAAS;AAExE,eAAW,KAAK;AAAA,MACf;AAAA,MACA,OAAO,KAAK;AAAA,IACb,CAAC;AAAA,EACF;AAEA,aAAW,KAAK,CAAC,GAAG,MAAM;AACzB,QAAI,EAAE,OAAO,EAAE,MAAM;AACpB,aAAO;AAAA,IACR;AACA,QAAI,EAAE,OAAO,EAAE,MAAM;AACpB,aAAO;AAAA,IACR;AACA,WAAO;AAAA,EACR,CAAC;AAED,SAAO;AACR;AAEA,eAAsB,WAAuE;AAC5F,QAAM,WAAW;AACjB,QAAM,eAAe,MAAM,oCAAmB,KAAK,MAAM,OAAO,UAAU,CAAC,CAAC;AAE5E,MAAI,iBAAiB,QAAW;AAC/B,UAAM,IAAI,uCAAmB,KAAK,QAAQ,GAAG,sBAAsB;AAAA,EACpE;AAEA,QAAM,aAAqC,CAAC;AAC5C,aAAW,QAAQ,cAAc;AAChC,QAAI,KAAK,cAAc,GAAG;AACzB;AAAA,IACD;AAEA,eAAW,KAAK;AAAA,MACf,MAAM,KAAK;AAAA,MACX,OAAO,KAAK;AAAA,IACb,CAAC;AAAA,EACF;AAEA,aAAW,KAAK,CAAC,GAAG,MAAM;AACzB,QAAI,EAAE,OAAO,EAAE,MAAM;AACpB,aAAO;AAAA,IACR;AACA,QAAI,EAAE,OAAO,EAAE,MAAM;AACpB,aAAO;AAAA,IACR;AACA,WAAO;AAAA,EACR,CAAC;AAED,SAAO;AACR;","names":[]}