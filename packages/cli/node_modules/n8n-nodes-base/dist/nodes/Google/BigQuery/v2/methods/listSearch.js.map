{"version":3,"sources":["../../../../../../nodes/Google/BigQuery/v2/methods/listSearch.ts"],"sourcesContent":["import type { IDataObject, ILoadOptionsFunctions, INodeListSearchResult } from 'n8n-workflow';\n\nimport { googleBigQueryApiRequest } from '../transport';\n\nexport async function searchProjects(\n\tthis: ILoadOptionsFunctions,\n\tfilter?: string,\n\tpaginationToken?: string,\n): Promise<INodeListSearchResult> {\n\tconst qs = {\n\t\tpageToken: (paginationToken as string) || undefined,\n\t};\n\n\tconst response = await googleBigQueryApiRequest.call(this, 'GET', '/v2/projects', undefined, qs);\n\n\tlet { projects } = response;\n\n\tif (filter) {\n\t\tprojects = projects.filter(\n\t\t\t(project: IDataObject) =>\n\t\t\t\t(project.friendlyName as string).includes(filter) ||\n\t\t\t\t(project.id as string).includes(filter),\n\t\t);\n\t}\n\n\treturn {\n\t\tresults: projects.map((project: IDataObject) => ({\n\t\t\tname: project.friendlyName as string,\n\t\t\tvalue: project.id,\n\t\t\turl: `https://console.cloud.google.com/bigquery?project=${project.id as string}`,\n\t\t})),\n\t\tpaginationToken: response.nextPageToken,\n\t};\n}\n\nexport async function searchDatasets(\n\tthis: ILoadOptionsFunctions,\n\tfilter?: string,\n\tpaginationToken?: string,\n): Promise<INodeListSearchResult> {\n\tconst projectId = this.getNodeParameter('projectId', undefined, {\n\t\textractValue: true,\n\t});\n\n\tconst qs = {\n\t\tpageToken: (paginationToken as string) || undefined,\n\t};\n\n\tconst response = await googleBigQueryApiRequest.call(\n\t\tthis,\n\t\t'GET',\n\t\t`/v2/projects/${projectId}/datasets`,\n\t\tundefined,\n\t\tqs,\n\t);\n\n\tlet { datasets } = response;\n\n\tif (filter) {\n\t\tdatasets = datasets.filter((dataset: { datasetReference: IDataObject }) =>\n\t\t\t(dataset.datasetReference.datasetId as string).includes(filter),\n\t\t);\n\t}\n\n\treturn {\n\t\tresults: datasets.map((dataset: { datasetReference: IDataObject }) => ({\n\t\t\tname: dataset.datasetReference.datasetId as string,\n\t\t\tvalue: dataset.datasetReference.datasetId,\n\t\t})),\n\t\tpaginationToken: response.nextPageToken,\n\t};\n}\n\nexport async function searchTables(\n\tthis: ILoadOptionsFunctions,\n\tfilter?: string,\n\tpaginationToken?: string,\n): Promise<INodeListSearchResult> {\n\tconst projectId = this.getNodeParameter('projectId', undefined, {\n\t\textractValue: true,\n\t});\n\n\tconst datasetId = this.getNodeParameter('datasetId', undefined, {\n\t\textractValue: true,\n\t});\n\n\tconst qs = {\n\t\tpageToken: (paginationToken as string) || undefined,\n\t};\n\n\tconst response = await googleBigQueryApiRequest.call(\n\t\tthis,\n\t\t'GET',\n\t\t`/v2/projects/${projectId}/datasets/${datasetId}/tables`,\n\t\tundefined,\n\t\tqs,\n\t);\n\n\tlet { tables } = response;\n\n\tif (filter) {\n\t\ttables = tables.filter((table: { tableReference: IDataObject }) =>\n\t\t\t(table.tableReference.tableId as string).includes(filter),\n\t\t);\n\t}\n\n\tconst returnData = {\n\t\tresults: tables.map((table: { tableReference: IDataObject }) => ({\n\t\t\tname: table.tableReference.tableId as string,\n\t\t\tvalue: table.tableReference.tableId,\n\t\t})),\n\t\tpaginationToken: response.nextPageToken,\n\t};\n\n\treturn returnData;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,uBAAyC;AAEzC,eAAsB,eAErB,QACA,iBACiC;AACjC,QAAM,KAAK;AAAA,IACV,WAAY,mBAA8B;AAAA,EAC3C;AAEA,QAAM,WAAW,MAAM,0CAAyB,KAAK,MAAM,OAAO,gBAAgB,QAAW,EAAE;AAE/F,MAAI,EAAE,SAAS,IAAI;AAEnB,MAAI,QAAQ;AACX,eAAW,SAAS;AAAA,MACnB,CAAC,YACC,QAAQ,aAAwB,SAAS,MAAM,KAC/C,QAAQ,GAAc,SAAS,MAAM;AAAA,IACxC;AAAA,EACD;AAEA,SAAO;AAAA,IACN,SAAS,SAAS,IAAI,CAAC,aAA0B;AAAA,MAChD,MAAM,QAAQ;AAAA,MACd,OAAO,QAAQ;AAAA,MACf,KAAK,qDAAqD,QAAQ,EAAY;AAAA,IAC/E,EAAE;AAAA,IACF,iBAAiB,SAAS;AAAA,EAC3B;AACD;AAEA,eAAsB,eAErB,QACA,iBACiC;AACjC,QAAM,YAAY,KAAK,iBAAiB,aAAa,QAAW;AAAA,IAC/D,cAAc;AAAA,EACf,CAAC;AAED,QAAM,KAAK;AAAA,IACV,WAAY,mBAA8B;AAAA,EAC3C;AAEA,QAAM,WAAW,MAAM,0CAAyB;AAAA,IAC/C;AAAA,IACA;AAAA,IACA,gBAAgB,SAAS;AAAA,IACzB;AAAA,IACA;AAAA,EACD;AAEA,MAAI,EAAE,SAAS,IAAI;AAEnB,MAAI,QAAQ;AACX,eAAW,SAAS;AAAA,MAAO,CAAC,YAC1B,QAAQ,iBAAiB,UAAqB,SAAS,MAAM;AAAA,IAC/D;AAAA,EACD;AAEA,SAAO;AAAA,IACN,SAAS,SAAS,IAAI,CAAC,aAAgD;AAAA,MACtE,MAAM,QAAQ,iBAAiB;AAAA,MAC/B,OAAO,QAAQ,iBAAiB;AAAA,IACjC,EAAE;AAAA,IACF,iBAAiB,SAAS;AAAA,EAC3B;AACD;AAEA,eAAsB,aAErB,QACA,iBACiC;AACjC,QAAM,YAAY,KAAK,iBAAiB,aAAa,QAAW;AAAA,IAC/D,cAAc;AAAA,EACf,CAAC;AAED,QAAM,YAAY,KAAK,iBAAiB,aAAa,QAAW;AAAA,IAC/D,cAAc;AAAA,EACf,CAAC;AAED,QAAM,KAAK;AAAA,IACV,WAAY,mBAA8B;AAAA,EAC3C;AAEA,QAAM,WAAW,MAAM,0CAAyB;AAAA,IAC/C;AAAA,IACA;AAAA,IACA,gBAAgB,SAAS,aAAa,SAAS;AAAA,IAC/C;AAAA,IACA;AAAA,EACD;AAEA,MAAI,EAAE,OAAO,IAAI;AAEjB,MAAI,QAAQ;AACX,aAAS,OAAO;AAAA,MAAO,CAAC,UACtB,MAAM,eAAe,QAAmB,SAAS,MAAM;AAAA,IACzD;AAAA,EACD;AAEA,QAAM,aAAa;AAAA,IAClB,SAAS,OAAO,IAAI,CAAC,WAA4C;AAAA,MAChE,MAAM,MAAM,eAAe;AAAA,MAC3B,OAAO,MAAM,eAAe;AAAA,IAC7B,EAAE;AAAA,IACF,iBAAiB,SAAS;AAAA,EAC3B;AAEA,SAAO;AACR;","names":[]}