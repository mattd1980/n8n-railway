{"version":3,"sources":["../../../../nodes/Google/Drive/GoogleDriveTrigger.node.ts"],"sourcesContent":["import moment from 'moment-timezone';\nimport type {\n\tIPollFunctions,\n\tIDataObject,\n\tILoadOptionsFunctions,\n\tINodeExecutionData,\n\tINodePropertyOptions,\n\tINodeType,\n\tINodeTypeDescription,\n} from 'n8n-workflow';\nimport { NodeConnectionTypes, NodeApiError } from 'n8n-workflow';\n\nimport { extractId, googleApiRequest, googleApiRequestAllItems } from './v1/GenericFunctions';\nimport { fileSearch, folderSearch } from './v2/methods/listSearch';\nimport { GOOGLE_DRIVE_FILE_URL_REGEX, GOOGLE_DRIVE_FOLDER_URL_REGEX } from '../constants';\n\nexport class GoogleDriveTrigger implements INodeType {\n\tdescription: INodeTypeDescription = {\n\t\tdisplayName: 'Google Drive Trigger',\n\t\tname: 'googleDriveTrigger',\n\t\ticon: 'file:googleDrive.svg',\n\t\tgroup: ['trigger'],\n\t\tversion: 1,\n\t\tdescription: 'Starts the workflow when Google Drive events occur',\n\t\tsubtitle: '={{$parameter[\"event\"]}}',\n\t\tdefaults: {\n\t\t\tname: 'Google Drive Trigger',\n\t\t},\n\t\tcredentials: [\n\t\t\t{\n\t\t\t\tname: 'googleApi',\n\t\t\t\trequired: true,\n\t\t\t\tdisplayOptions: {\n\t\t\t\t\tshow: {\n\t\t\t\t\t\tauthentication: ['serviceAccount'],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'googleDriveOAuth2Api',\n\t\t\t\trequired: true,\n\t\t\t\tdisplayOptions: {\n\t\t\t\t\tshow: {\n\t\t\t\t\t\tauthentication: ['oAuth2'],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t\tpolling: true,\n\t\tinputs: [],\n\t\toutputs: [NodeConnectionTypes.Main],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tdisplayName: 'Credential Type',\n\t\t\t\tname: 'authentication',\n\t\t\t\ttype: 'options',\n\t\t\t\toptions: [\n\t\t\t\t\t{\n\t\t\t\t\t\t// eslint-disable-next-line n8n-nodes-base/node-param-display-name-miscased\n\t\t\t\t\t\tname: 'OAuth2 (recommended)',\n\t\t\t\t\t\tvalue: 'oAuth2',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Service Account',\n\t\t\t\t\t\tvalue: 'serviceAccount',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tdefault: 'oAuth2',\n\t\t\t},\n\t\t\t{\n\t\t\t\tdisplayName: 'Trigger On',\n\t\t\t\tname: 'triggerOn',\n\t\t\t\ttype: 'options',\n\t\t\t\trequired: true,\n\t\t\t\tdefault: '',\n\t\t\t\toptions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Changes to a Specific File',\n\t\t\t\t\t\tvalue: 'specificFile',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Changes Involving a Specific Folder',\n\t\t\t\t\t\tvalue: 'specificFolder',\n\t\t\t\t\t},\n\t\t\t\t\t// {\n\t\t\t\t\t// \tname: 'Changes To Any File/Folder',\n\t\t\t\t\t// \tvalue: 'anyFileFolder',\n\t\t\t\t\t// },\n\t\t\t\t],\n\t\t\t},\n\t\t\t{\n\t\t\t\tdisplayName: 'File',\n\t\t\t\tname: 'fileToWatch',\n\t\t\t\ttype: 'resourceLocator',\n\t\t\t\tdefault: { mode: 'list', value: '' },\n\t\t\t\trequired: true,\n\t\t\t\tmodes: [\n\t\t\t\t\t{\n\t\t\t\t\t\tdisplayName: 'File',\n\t\t\t\t\t\tname: 'list',\n\t\t\t\t\t\ttype: 'list',\n\t\t\t\t\t\tplaceholder: 'Select a file...',\n\t\t\t\t\t\ttypeOptions: {\n\t\t\t\t\t\t\tsearchListMethod: 'fileSearch',\n\t\t\t\t\t\t\tsearchable: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tdisplayName: 'Link',\n\t\t\t\t\t\tname: 'url',\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tplaceholder: 'https://drive.google.com/file/d/1wroCSfK-hupQIYf_xzeoUEzOhvfTFH2P/edit',\n\t\t\t\t\t\textractValue: {\n\t\t\t\t\t\t\ttype: 'regex',\n\t\t\t\t\t\t\tregex: GOOGLE_DRIVE_FILE_URL_REGEX,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tvalidation: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'regex',\n\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\tregex: GOOGLE_DRIVE_FILE_URL_REGEX,\n\t\t\t\t\t\t\t\t\terrorMessage: 'Not a valid Google Drive File URL',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tdisplayName: 'ID',\n\t\t\t\t\t\tname: 'id',\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tplaceholder: '1anGBg0b5re2VtF2bKu201_a-Vnz5BHq9Y4r-yBDAj5A',\n\t\t\t\t\t\tvalidation: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'regex',\n\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\tregex: '[a-zA-Z0-9\\\\-_]{2,}',\n\t\t\t\t\t\t\t\t\terrorMessage: 'Not a valid Google Drive File ID',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\turl: '=https://drive.google.com/file/d/{{$value}}/view',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tdisplayOptions: {\n\t\t\t\t\tshow: {\n\t\t\t\t\t\ttriggerOn: ['specificFile'],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tdisplayName: 'Watch For',\n\t\t\t\tname: 'event',\n\t\t\t\ttype: 'options',\n\t\t\t\tdisplayOptions: {\n\t\t\t\t\tshow: {\n\t\t\t\t\t\ttriggerOn: ['specificFile'],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\trequired: true,\n\t\t\t\tdefault: 'fileUpdated',\n\t\t\t\toptions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'File Updated',\n\t\t\t\t\t\tvalue: 'fileUpdated',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tdescription: 'When to trigger this node',\n\t\t\t},\n\t\t\t{\n\t\t\t\tdisplayName: 'Folder',\n\t\t\t\tname: 'folderToWatch',\n\t\t\t\ttype: 'resourceLocator',\n\t\t\t\tdefault: { mode: 'list', value: '' },\n\t\t\t\trequired: true,\n\t\t\t\tmodes: [\n\t\t\t\t\t{\n\t\t\t\t\t\tdisplayName: 'Folder',\n\t\t\t\t\t\tname: 'list',\n\t\t\t\t\t\ttype: 'list',\n\t\t\t\t\t\tplaceholder: 'Select a folder...',\n\t\t\t\t\t\ttypeOptions: {\n\t\t\t\t\t\t\tsearchListMethod: 'folderSearch',\n\t\t\t\t\t\t\tsearchable: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tdisplayName: 'Link',\n\t\t\t\t\t\tname: 'url',\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tplaceholder: 'https://drive.google.com/drive/folders/1Tx9WHbA3wBpPB4C_HcoZDH9WZFWYxAMU',\n\t\t\t\t\t\textractValue: {\n\t\t\t\t\t\t\ttype: 'regex',\n\t\t\t\t\t\t\tregex: GOOGLE_DRIVE_FOLDER_URL_REGEX,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tvalidation: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'regex',\n\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\tregex: GOOGLE_DRIVE_FOLDER_URL_REGEX,\n\t\t\t\t\t\t\t\t\terrorMessage: 'Not a valid Google Drive Folder URL',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tdisplayName: 'ID',\n\t\t\t\t\t\tname: 'id',\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tplaceholder: '1anGBg0b5re2VtF2bKu201_a-Vnz5BHq9Y4r-yBDAj5A',\n\t\t\t\t\t\tvalidation: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'regex',\n\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\tregex: '[a-zA-Z0-9\\\\-_]{2,}',\n\t\t\t\t\t\t\t\t\terrorMessage: 'Not a valid Google Drive Folder ID',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\turl: '=https://drive.google.com/drive/folders/{{$value}}',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tdisplayOptions: {\n\t\t\t\t\tshow: {\n\t\t\t\t\t\ttriggerOn: ['specificFolder'],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tdisplayName: 'Watch For',\n\t\t\t\tname: 'event',\n\t\t\t\ttype: 'options',\n\t\t\t\tdisplayOptions: {\n\t\t\t\t\tshow: {\n\t\t\t\t\t\ttriggerOn: ['specificFolder'],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\trequired: true,\n\t\t\t\tdefault: '',\n\t\t\t\toptions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'File Created',\n\t\t\t\t\t\tvalue: 'fileCreated',\n\t\t\t\t\t\tdescription: 'When a file is created in the watched folder',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'File Updated',\n\t\t\t\t\t\tvalue: 'fileUpdated',\n\t\t\t\t\t\tdescription: 'When a file is updated in the watched folder',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Folder Created',\n\t\t\t\t\t\tvalue: 'folderCreated',\n\t\t\t\t\t\tdescription: 'When a folder is created in the watched folder',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Folder Updated',\n\t\t\t\t\t\tvalue: 'folderUpdated',\n\t\t\t\t\t\tdescription: 'When a folder is updated in the watched folder',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Watch Folder Updated',\n\t\t\t\t\t\tvalue: 'watchFolderUpdated',\n\t\t\t\t\t\tdescription: 'When the watched folder itself is modified',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\t{\n\t\t\t\tdisplayName: \"Changes within subfolders won't trigger this node\",\n\t\t\t\tname: 'asas',\n\t\t\t\ttype: 'notice',\n\t\t\t\tdisplayOptions: {\n\t\t\t\t\tshow: {\n\t\t\t\t\t\ttriggerOn: ['specificFolder'],\n\t\t\t\t\t},\n\t\t\t\t\thide: {\n\t\t\t\t\t\tevent: ['watchFolderUpdated'],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tdefault: '',\n\t\t\t},\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line n8n-nodes-base/node-param-display-name-wrong-for-dynamic-options\n\t\t\t\tdisplayName: 'Drive To Watch',\n\t\t\t\tname: 'driveToWatch',\n\t\t\t\ttype: 'options',\n\t\t\t\tdisplayOptions: {\n\t\t\t\t\tshow: {\n\t\t\t\t\t\ttriggerOn: ['anyFileFolder'],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\ttypeOptions: {\n\t\t\t\t\tloadOptionsMethod: 'getDrives',\n\t\t\t\t},\n\t\t\t\tdefault: 'root',\n\t\t\t\trequired: true,\n\t\t\t\tdescription:\n\t\t\t\t\t'The drive to monitor. Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>.',\n\t\t\t},\n\t\t\t{\n\t\t\t\tdisplayName: 'Watch For',\n\t\t\t\tname: 'event',\n\t\t\t\ttype: 'options',\n\t\t\t\tdisplayOptions: {\n\t\t\t\t\tshow: {\n\t\t\t\t\t\ttriggerOn: ['anyFileFolder'],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\trequired: true,\n\t\t\t\tdefault: 'fileCreated',\n\t\t\t\toptions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'File Created',\n\t\t\t\t\t\tvalue: 'fileCreated',\n\t\t\t\t\t\tdescription: 'When a file is created in the watched drive',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'File Updated',\n\t\t\t\t\t\tvalue: 'fileUpdated',\n\t\t\t\t\t\tdescription: 'When a file is updated in the watched drive',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Folder Created',\n\t\t\t\t\t\tvalue: 'folderCreated',\n\t\t\t\t\t\tdescription: 'When a folder is created in the watched drive',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Folder Updated',\n\t\t\t\t\t\tvalue: 'folderUpdated',\n\t\t\t\t\t\tdescription: 'When a folder is updated in the watched drive',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tdescription: 'When to trigger this node',\n\t\t\t},\n\t\t\t{\n\t\t\t\tdisplayName: 'Options',\n\t\t\t\tname: 'options',\n\t\t\t\ttype: 'collection',\n\t\t\t\tdisplayOptions: {\n\t\t\t\t\tshow: {\n\t\t\t\t\t\tevent: ['fileCreated', 'fileUpdated'],\n\t\t\t\t\t},\n\t\t\t\t\thide: {\n\t\t\t\t\t\ttriggerOn: ['specificFile'],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tplaceholder: 'Add option',\n\t\t\t\tdefault: {},\n\t\t\t\toptions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tdisplayName: 'File Type',\n\t\t\t\t\t\tname: 'fileType',\n\t\t\t\t\t\ttype: 'options',\n\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: '[All]',\n\t\t\t\t\t\t\t\tvalue: 'all',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: 'Audio',\n\t\t\t\t\t\t\t\tvalue: 'application/vnd.google-apps.audio',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: 'Google Docs',\n\t\t\t\t\t\t\t\tvalue: 'application/vnd.google-apps.document',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: 'Google Drawings',\n\t\t\t\t\t\t\t\tvalue: 'application/vnd.google-apps.drawing',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: 'Google Slides',\n\t\t\t\t\t\t\t\tvalue: 'application/vnd.google-apps.presentation',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: 'Google Spreadsheets',\n\t\t\t\t\t\t\t\tvalue: 'application/vnd.google-apps.spreadsheet',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: 'Photos and Images',\n\t\t\t\t\t\t\t\tvalue: 'application/vnd.google-apps.photo',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: 'Videos',\n\t\t\t\t\t\t\t\tvalue: 'application/vnd.google-apps.video',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\tdefault: 'all',\n\t\t\t\t\t\tdescription: 'Triggers only when the file is this type',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t],\n\t};\n\n\tmethods = {\n\t\tlistSearch: {\n\t\t\tfileSearch,\n\t\t\tfolderSearch,\n\t\t},\n\t\tloadOptions: {\n\t\t\t// Get all the calendars to display them to user so that they can\n\t\t\t// select them easily\n\t\t\tasync getDrives(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\t\t\t\tconst returnData: INodePropertyOptions[] = [];\n\t\t\t\tconst drives = await googleApiRequestAllItems.call(\n\t\t\t\t\tthis,\n\t\t\t\t\t'drives',\n\t\t\t\t\t'GET',\n\t\t\t\t\t'/drive/v3/drives',\n\t\t\t\t);\n\t\t\t\treturnData.push({\n\t\t\t\t\tname: 'Root',\n\t\t\t\t\tvalue: 'root',\n\t\t\t\t});\n\t\t\t\tfor (const drive of drives) {\n\t\t\t\t\treturnData.push({\n\t\t\t\t\t\tname: drive.name,\n\t\t\t\t\t\tvalue: drive.id,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn returnData;\n\t\t\t},\n\t\t},\n\t};\n\n\tasync poll(this: IPollFunctions): Promise<INodeExecutionData[][] | null> {\n\t\tconst triggerOn = this.getNodeParameter('triggerOn') as string;\n\t\tconst event = this.getNodeParameter('event') as string;\n\t\tconst webhookData = this.getWorkflowStaticData('node');\n\t\tconst options = this.getNodeParameter('options', {}) as IDataObject;\n\t\tconst qs: IDataObject = {\n\t\t\tincludeItemsFromAllDrives: true,\n\t\t\tsupportsAllDrives: true,\n\t\t\tspaces: 'appDataFolder, drive',\n\t\t\tcorpora: 'allDrives',\n\t\t};\n\n\t\tconst now = moment().utc().format();\n\n\t\tconst startDate = (webhookData.lastTimeChecked as string) || now;\n\n\t\tconst endDate = now;\n\n\t\tconst query = ['trashed = false'];\n\n\t\tif (triggerOn === 'specificFolder' && event !== 'watchFolderUpdated') {\n\t\t\tconst folderToWatch = extractId(\n\t\t\t\tthis.getNodeParameter('folderToWatch', '', { extractValue: true }) as string,\n\t\t\t);\n\t\t\tquery.push(`'${folderToWatch}' in parents`);\n\t\t}\n\n\t\t// if (triggerOn === 'anyFileFolder') {\n\t\t// \tconst driveToWatch = this.getNodeParameter('driveToWatch');\n\t\t// \tquery.push(`'${driveToWatch}' in parents`);\n\t\t// }\n\n\t\tif (event.startsWith('file')) {\n\t\t\tquery.push(\"mimeType != 'application/vnd.google-apps.folder'\");\n\t\t} else {\n\t\t\tquery.push(\"mimeType = 'application/vnd.google-apps.folder'\");\n\t\t}\n\n\t\tif (options.fileType && options.fileType !== 'all') {\n\t\t\tquery.push(`mimeType = '${options.fileType}'`);\n\t\t}\n\n\t\tif (this.getMode() !== 'manual') {\n\t\t\tif (event.includes('Created')) {\n\t\t\t\tquery.push(`createdTime > '${startDate}'`);\n\t\t\t} else {\n\t\t\t\tquery.push(`modifiedTime > '${startDate}'`);\n\t\t\t}\n\t\t}\n\n\t\tqs.q = query.join(' AND ');\n\n\t\tqs.fields = 'nextPageToken, files(*)';\n\n\t\tlet files;\n\n\t\tif (this.getMode() === 'manual') {\n\t\t\tqs.pageSize = 1;\n\t\t\tfiles = await googleApiRequest.call(this, 'GET', '/drive/v3/files', {}, qs);\n\t\t\tfiles = files.files;\n\t\t} else {\n\t\t\tfiles = await googleApiRequestAllItems.call(this, 'files', 'GET', '/drive/v3/files', {}, qs);\n\t\t}\n\n\t\tif (triggerOn === 'specificFile' && this.getMode() !== 'manual') {\n\t\t\tconst fileToWatch = extractId(\n\t\t\t\tthis.getNodeParameter('fileToWatch', '', { extractValue: true }) as string,\n\t\t\t);\n\t\t\tfiles = files.filter((file: { id: string }) => file.id === fileToWatch);\n\t\t}\n\n\t\tif (\n\t\t\ttriggerOn === 'specificFolder' &&\n\t\t\tevent === 'watchFolderUpdated' &&\n\t\t\tthis.getMode() !== 'manual'\n\t\t) {\n\t\t\tconst folderToWatch = extractId(\n\t\t\t\tthis.getNodeParameter('folderToWatch', '', { extractValue: true }) as string,\n\t\t\t);\n\t\t\tfiles = files.filter((file: { id: string }) => file.id === folderToWatch);\n\t\t}\n\n\t\twebhookData.lastTimeChecked = endDate;\n\n\t\tif (Array.isArray(files) && files.length) {\n\t\t\treturn [this.helpers.returnJsonArray(files)];\n\t\t}\n\n\t\tif (this.getMode() === 'manual') {\n\t\t\tthrow new NodeApiError(this.getNode(), {\n\t\t\t\tmessage: 'No data with the current filter could be found',\n\t\t\t});\n\t\t}\n\n\t\treturn null;\n\t}\n}\n"],"mappings":"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","names":["moment"]}