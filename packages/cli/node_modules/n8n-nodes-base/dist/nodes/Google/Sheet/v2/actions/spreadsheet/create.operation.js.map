{"version":3,"sources":["../../../../../../../nodes/Google/Sheet/v2/actions/spreadsheet/create.operation.ts"],"sourcesContent":["import type { IExecuteFunctions, IDataObject, INodeExecutionData } from 'n8n-workflow';\n\nimport { wrapData } from '../../../../../../utils/utilities';\nimport type { SpreadSheetProperties } from '../../helpers/GoogleSheets.types';\nimport { apiRequest } from '../../transport';\n\nexport const description: SpreadSheetProperties = [\n\t{\n\t\tdisplayName: 'Title',\n\t\tname: 'title',\n\t\ttype: 'string',\n\t\tdefault: '',\n\t\tdisplayOptions: {\n\t\t\tshow: {\n\t\t\t\tresource: ['spreadsheet'],\n\t\t\t\toperation: ['create'],\n\t\t\t},\n\t\t},\n\t\tdescription: 'The title of the spreadsheet',\n\t},\n\t{\n\t\tdisplayName: 'Sheets',\n\t\tname: 'sheetsUi',\n\t\tplaceholder: 'Add Sheet',\n\t\ttype: 'fixedCollection',\n\t\ttypeOptions: {\n\t\t\tmultipleValues: true,\n\t\t},\n\t\tdefault: {},\n\t\toptions: [\n\t\t\t{\n\t\t\t\tname: 'sheetValues',\n\t\t\t\tdisplayName: 'Sheet',\n\t\t\t\tvalues: [\n\t\t\t\t\t{\n\t\t\t\t\t\tdisplayName: 'Title',\n\t\t\t\t\t\tname: 'title',\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tdefault: '',\n\t\t\t\t\t\tdescription: 'Title of the property to create',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tdisplayName: 'Hidden',\n\t\t\t\t\t\tname: 'hidden',\n\t\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\t\tdefault: false,\n\t\t\t\t\t\tdescription: 'Whether the Sheet should be hidden in the UI',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t],\n\t\tdisplayOptions: {\n\t\t\tshow: {\n\t\t\t\tresource: ['spreadsheet'],\n\t\t\t\toperation: ['create'],\n\t\t\t},\n\t\t},\n\t},\n\t{\n\t\tdisplayName: 'Options',\n\t\tname: 'options',\n\t\ttype: 'collection',\n\t\tplaceholder: 'Add option',\n\t\tdefault: {},\n\t\tdisplayOptions: {\n\t\t\tshow: {\n\t\t\t\tresource: ['spreadsheet'],\n\t\t\t\toperation: ['create'],\n\t\t\t},\n\t\t},\n\t\toptions: [\n\t\t\t{\n\t\t\t\tdisplayName: 'Locale',\n\t\t\t\tname: 'locale',\n\t\t\t\ttype: 'string',\n\t\t\t\tdefault: '',\n\t\t\t\tplaceholder: 'en_US',\n\t\t\t\tdescription: `The locale of the spreadsheet in one of the following formats:\n\t\t\t\t<ul>\n\t\t\t\t\t<li>en (639-1)</li>\n\t\t\t\t\t<li>fil (639-2 if no 639-1 format exists)</li>\n\t\t\t\t\t<li>en_US (combination of ISO language an country)</li>\n\t\t\t\t<ul>`,\n\t\t\t},\n\t\t\t{\n\t\t\t\tdisplayName: 'Recalculation Interval',\n\t\t\t\tname: 'autoRecalc',\n\t\t\t\ttype: 'options',\n\t\t\t\toptions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Default',\n\t\t\t\t\t\tvalue: '',\n\t\t\t\t\t\tdescription: 'Default value',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'On Change',\n\t\t\t\t\t\tvalue: 'ON_CHANGE',\n\t\t\t\t\t\tdescription: 'Volatile functions are updated on every change',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Minute',\n\t\t\t\t\t\tvalue: 'MINUTE',\n\t\t\t\t\t\tdescription: 'Volatile functions are updated on every change and every minute',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Hour',\n\t\t\t\t\t\tvalue: 'HOUR',\n\t\t\t\t\t\tdescription: 'Volatile functions are updated on every change and hourly',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tdefault: '',\n\t\t\t\tdescription: 'Cell recalculation interval options',\n\t\t\t},\n\t\t],\n\t},\n];\n\nexport async function execute(this: IExecuteFunctions): Promise<INodeExecutionData[]> {\n\tconst items = this.getInputData();\n\tconst returnData: INodeExecutionData[] = [];\n\n\tfor (let i = 0; i < items.length; i++) {\n\t\tconst title = this.getNodeParameter('title', i) as string;\n\t\tconst sheetsUi = this.getNodeParameter('sheetsUi', i, {}) as IDataObject;\n\n\t\tconst body = {\n\t\t\tproperties: {\n\t\t\t\ttitle,\n\t\t\t\tautoRecalc: undefined as undefined | string,\n\t\t\t\tlocale: undefined as undefined | string,\n\t\t\t},\n\t\t\tsheets: [] as IDataObject[],\n\t\t};\n\n\t\tconst options = this.getNodeParameter('options', i, {});\n\n\t\tif (Object.keys(sheetsUi).length) {\n\t\t\tconst data = [];\n\t\t\tconst sheets = sheetsUi.sheetValues as IDataObject[];\n\t\t\tfor (const properties of sheets) {\n\t\t\t\tdata.push({ properties });\n\t\t\t}\n\t\t\tbody.sheets = data;\n\t\t}\n\n\t\tbody.properties.autoRecalc = options.autoRecalc ? (options.autoRecalc as string) : undefined;\n\t\tbody.properties.locale = options.locale ? (options.locale as string) : undefined;\n\n\t\tconst response = await apiRequest.call(this, 'POST', '/v4/spreadsheets', body);\n\n\t\tconst executionData = this.helpers.constructExecutionMetaData(\n\t\t\twrapData(response as IDataObject),\n\t\t\t{ itemData: { item: i } },\n\t\t);\n\n\t\treturnData.push(...executionData);\n\t}\n\n\treturn returnData;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,uBAAyB;AAEzB,uBAA2B;AAEpB,MAAM,cAAqC;AAAA,EACjD;AAAA,IACC,aAAa;AAAA,IACb,MAAM;AAAA,IACN,MAAM;AAAA,IACN,SAAS;AAAA,IACT,gBAAgB;AAAA,MACf,MAAM;AAAA,QACL,UAAU,CAAC,aAAa;AAAA,QACxB,WAAW,CAAC,QAAQ;AAAA,MACrB;AAAA,IACD;AAAA,IACA,aAAa;AAAA,EACd;AAAA,EACA;AAAA,IACC,aAAa;AAAA,IACb,MAAM;AAAA,IACN,aAAa;AAAA,IACb,MAAM;AAAA,IACN,aAAa;AAAA,MACZ,gBAAgB;AAAA,IACjB;AAAA,IACA,SAAS,CAAC;AAAA,IACV,SAAS;AAAA,MACR;AAAA,QACC,MAAM;AAAA,QACN,aAAa;AAAA,QACb,QAAQ;AAAA,UACP;AAAA,YACC,aAAa;AAAA,YACb,MAAM;AAAA,YACN,MAAM;AAAA,YACN,SAAS;AAAA,YACT,aAAa;AAAA,UACd;AAAA,UACA;AAAA,YACC,aAAa;AAAA,YACb,MAAM;AAAA,YACN,MAAM;AAAA,YACN,SAAS;AAAA,YACT,aAAa;AAAA,UACd;AAAA,QACD;AAAA,MACD;AAAA,IACD;AAAA,IACA,gBAAgB;AAAA,MACf,MAAM;AAAA,QACL,UAAU,CAAC,aAAa;AAAA,QACxB,WAAW,CAAC,QAAQ;AAAA,MACrB;AAAA,IACD;AAAA,EACD;AAAA,EACA;AAAA,IACC,aAAa;AAAA,IACb,MAAM;AAAA,IACN,MAAM;AAAA,IACN,aAAa;AAAA,IACb,SAAS,CAAC;AAAA,IACV,gBAAgB;AAAA,MACf,MAAM;AAAA,QACL,UAAU,CAAC,aAAa;AAAA,QACxB,WAAW,CAAC,QAAQ;AAAA,MACrB;AAAA,IACD;AAAA,IACA,SAAS;AAAA,MACR;AAAA,QACC,aAAa;AAAA,QACb,MAAM;AAAA,QACN,MAAM;AAAA,QACN,SAAS;AAAA,QACT,aAAa;AAAA,QACb,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAMd;AAAA,MACA;AAAA,QACC,aAAa;AAAA,QACb,MAAM;AAAA,QACN,MAAM;AAAA,QACN,SAAS;AAAA,UACR;AAAA,YACC,MAAM;AAAA,YACN,OAAO;AAAA,YACP,aAAa;AAAA,UACd;AAAA,UACA;AAAA,YACC,MAAM;AAAA,YACN,OAAO;AAAA,YACP,aAAa;AAAA,UACd;AAAA,UACA;AAAA,YACC,MAAM;AAAA,YACN,OAAO;AAAA,YACP,aAAa;AAAA,UACd;AAAA,UACA;AAAA,YACC,MAAM;AAAA,YACN,OAAO;AAAA,YACP,aAAa;AAAA,UACd;AAAA,QACD;AAAA,QACA,SAAS;AAAA,QACT,aAAa;AAAA,MACd;AAAA,IACD;AAAA,EACD;AACD;AAEA,eAAsB,UAAgE;AACrF,QAAM,QAAQ,KAAK,aAAa;AAChC,QAAM,aAAmC,CAAC;AAE1C,WAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACtC,UAAM,QAAQ,KAAK,iBAAiB,SAAS,CAAC;AAC9C,UAAM,WAAW,KAAK,iBAAiB,YAAY,GAAG,CAAC,CAAC;AAExD,UAAM,OAAO;AAAA,MACZ,YAAY;AAAA,QACX;AAAA,QACA,YAAY;AAAA,QACZ,QAAQ;AAAA,MACT;AAAA,MACA,QAAQ,CAAC;AAAA,IACV;AAEA,UAAM,UAAU,KAAK,iBAAiB,WAAW,GAAG,CAAC,CAAC;AAEtD,QAAI,OAAO,KAAK,QAAQ,EAAE,QAAQ;AACjC,YAAM,OAAO,CAAC;AACd,YAAM,SAAS,SAAS;AACxB,iBAAW,cAAc,QAAQ;AAChC,aAAK,KAAK,EAAE,WAAW,CAAC;AAAA,MACzB;AACA,WAAK,SAAS;AAAA,IACf;AAEA,SAAK,WAAW,aAAa,QAAQ,aAAc,QAAQ,aAAwB;AACnF,SAAK,WAAW,SAAS,QAAQ,SAAU,QAAQ,SAAoB;AAEvE,UAAM,WAAW,MAAM,4BAAW,KAAK,MAAM,QAAQ,oBAAoB,IAAI;AAE7E,UAAM,gBAAgB,KAAK,QAAQ;AAAA,UAClC,2BAAS,QAAuB;AAAA,MAChC,EAAE,UAAU,EAAE,MAAM,EAAE,EAAE;AAAA,IACzB;AAEA,eAAW,KAAK,GAAG,aAAa;AAAA,EACjC;AAEA,SAAO;AACR;","names":[]}