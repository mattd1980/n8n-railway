{"version":3,"sources":["../../../../../nodes/TheHiveProject/actions/page/search.operation.ts"],"sourcesContent":["import type {\n\tIDataObject,\n\tIExecuteFunctions,\n\tINodeExecutionData,\n\tINodeProperties,\n} from 'n8n-workflow';\n\nimport { updateDisplayOptions, wrapData } from '@utils/utilities';\n\nimport {\n\tcaseRLC,\n\tgenericFiltersCollection,\n\treturnAllAndLimit,\n\tsortCollection,\n\tsearchOptions,\n} from '../../descriptions';\nimport type { QueryScope } from '../../helpers/interfaces';\nimport { theHiveApiQuery } from '../../transport';\n\nconst properties: INodeProperties[] = [\n\t{\n\t\tdisplayName: 'Search in Knowledge Base',\n\t\tname: 'searchInKnowledgeBase',\n\t\ttype: 'boolean',\n\t\tdefault: true,\n\t\tdescription: 'Whether to search in knowledge base or only in the selected case',\n\t},\n\t{\n\t\t...caseRLC,\n\t\tdisplayOptions: {\n\t\t\tshow: {\n\t\t\t\tsearchInKnowledgeBase: [false],\n\t\t\t},\n\t\t},\n\t},\n\t...returnAllAndLimit,\n\tgenericFiltersCollection,\n\tsortCollection,\n\t{\n\t\t...searchOptions,\n\t\tdisplayOptions: {\n\t\t\tshow: {\n\t\t\t\treturnAll: [true],\n\t\t\t},\n\t\t},\n\t},\n];\n\nconst displayOptions = {\n\tshow: {\n\t\tresource: ['page'],\n\t\toperation: ['search'],\n\t},\n};\n\nexport const description = updateDisplayOptions(displayOptions, properties);\n\nexport async function execute(this: IExecuteFunctions, i: number): Promise<INodeExecutionData[]> {\n\tlet responseData: IDataObject | IDataObject[] = [];\n\n\tconst searchInKnowledgeBase = this.getNodeParameter('searchInKnowledgeBase', i) as boolean;\n\tconst filtersValues = this.getNodeParameter('filters.values', i, []) as IDataObject[];\n\tconst sortFields = this.getNodeParameter('sort.fields', i, []) as IDataObject[];\n\tconst returnAll = this.getNodeParameter('returnAll', i);\n\tlet returnCount = false;\n\tif (!returnAll) {\n\t\treturnCount = this.getNodeParameter('options.returnCount', i, false) as boolean;\n\t}\n\n\tlet limit;\n\tlet scope: QueryScope;\n\n\tif (searchInKnowledgeBase) {\n\t\tscope = { query: 'listOrganisationPage' };\n\t} else {\n\t\tconst caseId = this.getNodeParameter('caseId', i, '', { extractValue: true }) as string;\n\t\tscope = { query: 'getCase', id: caseId, restrictTo: 'pages' };\n\t}\n\n\tif (!returnAll) {\n\t\tlimit = this.getNodeParameter('limit', i);\n\t}\n\n\tresponseData = await theHiveApiQuery.call(\n\t\tthis,\n\t\tscope,\n\t\tfiltersValues,\n\t\tsortFields,\n\t\tlimit,\n\t\treturnCount,\n\t);\n\n\tconst executionData = this.helpers.constructExecutionMetaData(wrapData(responseData), {\n\t\titemData: { item: i },\n\t});\n\n\treturn executionData;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA,uBAA+C;AAE/C,0BAMO;AAEP,uBAAgC;AAEhC,MAAM,aAAgC;AAAA,EACrC;AAAA,IACC,aAAa;AAAA,IACb,MAAM;AAAA,IACN,MAAM;AAAA,IACN,SAAS;AAAA,IACT,aAAa;AAAA,EACd;AAAA,EACA;AAAA,IACC,GAAG;AAAA,IACH,gBAAgB;AAAA,MACf,MAAM;AAAA,QACL,uBAAuB,CAAC,KAAK;AAAA,MAC9B;AAAA,IACD;AAAA,EACD;AAAA,EACA,GAAG;AAAA,EACH;AAAA,EACA;AAAA,EACA;AAAA,IACC,GAAG;AAAA,IACH,gBAAgB;AAAA,MACf,MAAM;AAAA,QACL,WAAW,CAAC,IAAI;AAAA,MACjB;AAAA,IACD;AAAA,EACD;AACD;AAEA,MAAM,iBAAiB;AAAA,EACtB,MAAM;AAAA,IACL,UAAU,CAAC,MAAM;AAAA,IACjB,WAAW,CAAC,QAAQ;AAAA,EACrB;AACD;AAEO,MAAM,kBAAc,uCAAqB,gBAAgB,UAAU;AAE1E,eAAsB,QAAiC,GAA0C;AAChG,MAAI,eAA4C,CAAC;AAEjD,QAAM,wBAAwB,KAAK,iBAAiB,yBAAyB,CAAC;AAC9E,QAAM,gBAAgB,KAAK,iBAAiB,kBAAkB,GAAG,CAAC,CAAC;AACnE,QAAM,aAAa,KAAK,iBAAiB,eAAe,GAAG,CAAC,CAAC;AAC7D,QAAM,YAAY,KAAK,iBAAiB,aAAa,CAAC;AACtD,MAAI,cAAc;AAClB,MAAI,CAAC,WAAW;AACf,kBAAc,KAAK,iBAAiB,uBAAuB,GAAG,KAAK;AAAA,EACpE;AAEA,MAAI;AACJ,MAAI;AAEJ,MAAI,uBAAuB;AAC1B,YAAQ,EAAE,OAAO,uBAAuB;AAAA,EACzC,OAAO;AACN,UAAM,SAAS,KAAK,iBAAiB,UAAU,GAAG,IAAI,EAAE,cAAc,KAAK,CAAC;AAC5E,YAAQ,EAAE,OAAO,WAAW,IAAI,QAAQ,YAAY,QAAQ;AAAA,EAC7D;AAEA,MAAI,CAAC,WAAW;AACf,YAAQ,KAAK,iBAAiB,SAAS,CAAC;AAAA,EACzC;AAEA,iBAAe,MAAM,iCAAgB;AAAA,IACpC;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACD;AAEA,QAAM,gBAAgB,KAAK,QAAQ,+BAA2B,2BAAS,YAAY,GAAG;AAAA,IACrF,UAAU,EAAE,MAAM,EAAE;AAAA,EACrB,CAAC;AAED,SAAO;AACR;","names":[]}