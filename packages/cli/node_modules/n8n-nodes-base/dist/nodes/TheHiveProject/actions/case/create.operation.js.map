{"version":3,"sources":["../../../../../nodes/TheHiveProject/actions/case/create.operation.ts"],"sourcesContent":["import set from 'lodash/set';\nimport type {\n\tIDataObject,\n\tIExecuteFunctions,\n\tINodeExecutionData,\n\tINodeProperties,\n} from 'n8n-workflow';\n\nimport { updateDisplayOptions, wrapData } from '@utils/utilities';\n\nimport { fixFieldType, prepareInputItem } from '../../helpers/utils';\nimport { theHiveApiRequest } from '../../transport';\n\nconst properties: INodeProperties[] = [\n\t{\n\t\tdisplayName: 'Fields',\n\t\tname: 'caseFields',\n\t\ttype: 'resourceMapper',\n\t\tdefault: {\n\t\t\tmappingMode: 'defineBelow',\n\t\t\tvalue: null,\n\t\t},\n\t\tnoDataExpression: true,\n\t\trequired: true,\n\t\ttypeOptions: {\n\t\t\tresourceMapper: {\n\t\t\t\tresourceMapperMethod: 'getCaseFields',\n\t\t\t\tmode: 'add',\n\t\t\t\tvaluesLabel: 'Fields',\n\t\t\t},\n\t\t},\n\t},\n];\n\nconst displayOptions = {\n\tshow: {\n\t\tresource: ['case'],\n\t\toperation: ['create'],\n\t},\n};\n\nexport const description = updateDisplayOptions(displayOptions, properties);\n\nexport async function execute(\n\tthis: IExecuteFunctions,\n\ti: number,\n\titem: INodeExecutionData,\n): Promise<INodeExecutionData[]> {\n\tlet responseData: IDataObject | IDataObject[] = [];\n\tlet inputData: IDataObject = {};\n\n\tconst dataMode = this.getNodeParameter('caseFields.mappingMode', i) as string;\n\n\tif (dataMode === 'autoMapInputData') {\n\t\tconst schema = this.getNodeParameter('caseFields.schema', i) as IDataObject[];\n\t\tinputData = prepareInputItem(item.json, schema, i);\n\t}\n\n\tif (dataMode === 'defineBelow') {\n\t\tconst caseFields = this.getNodeParameter('caseFields.value', i, []) as IDataObject;\n\t\tinputData = caseFields;\n\t}\n\n\tinputData = fixFieldType(inputData);\n\n\tconst body: IDataObject = {};\n\n\tfor (const field of Object.keys(inputData)) {\n\t\t// use set to construct the updateBody, as it allows to process customFields.fieldName\n\t\t// if customFields provided under customFields property, it will be send as is\n\t\tset(body, field, inputData[field]);\n\t}\n\n\tresponseData = await theHiveApiRequest.call(this, 'POST', '/v1/case' as string, body);\n\n\tconst executionData = this.helpers.constructExecutionMetaData(wrapData(responseData), {\n\t\titemData: { item: i },\n\t});\n\n\treturn executionData;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAgB;AAQhB,uBAA+C;AAE/C,mBAA+C;AAC/C,uBAAkC;AAElC,MAAM,aAAgC;AAAA,EACrC;AAAA,IACC,aAAa;AAAA,IACb,MAAM;AAAA,IACN,MAAM;AAAA,IACN,SAAS;AAAA,MACR,aAAa;AAAA,MACb,OAAO;AAAA,IACR;AAAA,IACA,kBAAkB;AAAA,IAClB,UAAU;AAAA,IACV,aAAa;AAAA,MACZ,gBAAgB;AAAA,QACf,sBAAsB;AAAA,QACtB,MAAM;AAAA,QACN,aAAa;AAAA,MACd;AAAA,IACD;AAAA,EACD;AACD;AAEA,MAAM,iBAAiB;AAAA,EACtB,MAAM;AAAA,IACL,UAAU,CAAC,MAAM;AAAA,IACjB,WAAW,CAAC,QAAQ;AAAA,EACrB;AACD;AAEO,MAAM,kBAAc,uCAAqB,gBAAgB,UAAU;AAE1E,eAAsB,QAErB,GACA,MACgC;AAChC,MAAI,eAA4C,CAAC;AACjD,MAAI,YAAyB,CAAC;AAE9B,QAAM,WAAW,KAAK,iBAAiB,0BAA0B,CAAC;AAElE,MAAI,aAAa,oBAAoB;AACpC,UAAM,SAAS,KAAK,iBAAiB,qBAAqB,CAAC;AAC3D,oBAAY,+BAAiB,KAAK,MAAM,QAAQ,CAAC;AAAA,EAClD;AAEA,MAAI,aAAa,eAAe;AAC/B,UAAM,aAAa,KAAK,iBAAiB,oBAAoB,GAAG,CAAC,CAAC;AAClE,gBAAY;AAAA,EACb;AAEA,kBAAY,2BAAa,SAAS;AAElC,QAAM,OAAoB,CAAC;AAE3B,aAAW,SAAS,OAAO,KAAK,SAAS,GAAG;AAG3C,mBAAAA,SAAI,MAAM,OAAO,UAAU,KAAK,CAAC;AAAA,EAClC;AAEA,iBAAe,MAAM,mCAAkB,KAAK,MAAM,QAAQ,YAAsB,IAAI;AAEpF,QAAM,gBAAgB,KAAK,QAAQ,+BAA2B,2BAAS,YAAY,GAAG;AAAA,IACrF,UAAU,EAAE,MAAM,EAAE;AAAA,EACrB,CAAC;AAED,SAAO;AACR;","names":["set"]}