{"version":3,"sources":["../../../../../nodes/Discord/v2/transport/helpers.ts"],"sourcesContent":["import type {\n\tIDataObject,\n\tIExecuteFunctions,\n\tIExecuteSingleFunctions,\n\tIHookFunctions,\n\tILoadOptionsFunctions,\n\tIRequestOptions,\n} from 'n8n-workflow';\n\nexport const getCredentialsType = (authentication: string) => {\n\tlet credentialType = '';\n\tswitch (authentication) {\n\t\tcase 'botToken':\n\t\t\tcredentialType = 'discordBotApi';\n\t\t\tbreak;\n\t\tcase 'oAuth2':\n\t\t\tcredentialType = 'discordOAuth2Api';\n\t\t\tbreak;\n\t\tcase 'webhook':\n\t\t\tcredentialType = 'discordWebhookApi';\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tcredentialType = 'discordBotApi';\n\t}\n\treturn credentialType;\n};\n\nexport async function requestApi(\n\tthis: IHookFunctions | IExecuteFunctions | IExecuteSingleFunctions | ILoadOptionsFunctions,\n\toptions: IRequestOptions,\n\tcredentialType: string,\n\tendpoint: string,\n) {\n\tlet response;\n\tif (credentialType === 'discordOAuth2Api' && endpoint !== '/users/@me/guilds') {\n\t\tconst credentials = await this.getCredentials('discordOAuth2Api');\n\t\t(options.headers as IDataObject).Authorization = `Bot ${credentials.botToken}`;\n\t\tresponse = await this.helpers.request({ ...options, resolveWithFullResponse: true });\n\t} else {\n\t\tresponse = await this.helpers.requestWithAuthentication.call(this, credentialType, {\n\t\t\t...options,\n\t\t\tresolveWithFullResponse: true,\n\t\t});\n\t}\n\treturn response;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASO,MAAM,qBAAqB,CAAC,mBAA2B;AAC7D,MAAI,iBAAiB;AACrB,UAAQ,gBAAgB;AAAA,IACvB,KAAK;AACJ,uBAAiB;AACjB;AAAA,IACD,KAAK;AACJ,uBAAiB;AACjB;AAAA,IACD,KAAK;AACJ,uBAAiB;AACjB;AAAA,IACD;AACC,uBAAiB;AAAA,EACnB;AACA,SAAO;AACR;AAEA,eAAsB,WAErB,SACA,gBACA,UACC;AACD,MAAI;AACJ,MAAI,mBAAmB,sBAAsB,aAAa,qBAAqB;AAC9E,UAAM,cAAc,MAAM,KAAK,eAAe,kBAAkB;AAChE,IAAC,QAAQ,QAAwB,gBAAgB,OAAO,YAAY,QAAQ;AAC5E,eAAW,MAAM,KAAK,QAAQ,QAAQ,EAAE,GAAG,SAAS,yBAAyB,KAAK,CAAC;AAAA,EACpF,OAAO;AACN,eAAW,MAAM,KAAK,QAAQ,0BAA0B,KAAK,MAAM,gBAAgB;AAAA,MAClF,GAAG;AAAA,MACH,yBAAyB;AAAA,IAC1B,CAAC;AAAA,EACF;AACA,SAAO;AACR;","names":[]}