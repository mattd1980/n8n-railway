{"version":3,"sources":["../../../nodes/InvoiceNinja/GenericFunctions.ts"],"sourcesContent":["import get from 'lodash/get';\nimport type {\n\tIDataObject,\n\tIExecuteFunctions,\n\tIHookFunctions,\n\tILoadOptionsFunctions,\n\tJsonObject,\n\tIRequestOptions,\n\tIHttpRequestMethods,\n} from 'n8n-workflow';\nimport { NodeApiError, NodeOperationError } from 'n8n-workflow';\n\nexport const eventID: { [key: string]: string } = {\n\tcreate_client: '1',\n\tcreate_invoice: '2',\n\tcreate_quote: '3',\n\tcreate_payment: '4',\n\tcreate_vendor: '5',\n};\n\nexport async function invoiceNinjaApiRequest(\n\tthis: IHookFunctions | IExecuteFunctions | ILoadOptionsFunctions,\n\tmethod: IHttpRequestMethods,\n\tendpoint: string,\n\tbody: IDataObject = {},\n\tquery?: IDataObject,\n\turi?: string,\n) {\n\tconst credentials = await this.getCredentials('invoiceNinjaApi');\n\n\tif (credentials === undefined) {\n\t\tthrow new NodeOperationError(this.getNode(), 'No credentials got returned!');\n\t}\n\n\tconst version = this.getNodeParameter('apiVersion', 0) as string;\n\n\tconst defaultUrl = version === 'v4' ? 'https://app.invoiceninja.com' : 'https://invoicing.co';\n\tconst baseUrl = credentials.url || defaultUrl;\n\n\tconst options: IRequestOptions = {\n\t\tmethod,\n\t\tqs: query,\n\t\turi: uri || `${baseUrl}/api/v1${endpoint}`,\n\t\tbody,\n\t\tjson: true,\n\t};\n\n\ttry {\n\t\treturn await this.helpers.requestWithAuthentication.call(this, 'invoiceNinjaApi', options);\n\t} catch (error) {\n\t\tthrow new NodeApiError(this.getNode(), error as JsonObject);\n\t}\n}\n\nexport async function invoiceNinjaApiRequestAllItems(\n\tthis: IExecuteFunctions | ILoadOptionsFunctions | IHookFunctions,\n\tpropertyName: string,\n\tmethod: IHttpRequestMethods,\n\tendpoint: string,\n\tbody: IDataObject = {},\n\tquery: IDataObject = {},\n) {\n\tconst returnData: IDataObject[] = [];\n\n\tlet responseData;\n\tlet uri;\n\tquery.per_page = 100;\n\n\tdo {\n\t\tresponseData = await invoiceNinjaApiRequest.call(this, method, endpoint, body, query, uri);\n\t\tconst next = get(responseData, 'meta.pagination.links.next') as string | undefined;\n\t\tif (next) {\n\t\t\turi = next;\n\t\t}\n\t\treturnData.push.apply(returnData, responseData[propertyName] as IDataObject[]);\n\t} while (responseData.meta?.pagination?.links?.next);\n\n\treturn returnData;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAgB;AAUhB,0BAAiD;AAE1C,MAAM,UAAqC;AAAA,EACjD,eAAe;AAAA,EACf,gBAAgB;AAAA,EAChB,cAAc;AAAA,EACd,gBAAgB;AAAA,EAChB,eAAe;AAChB;AAEA,eAAsB,uBAErB,QACA,UACA,OAAoB,CAAC,GACrB,OACA,KACC;AACD,QAAM,cAAc,MAAM,KAAK,eAAe,iBAAiB;AAE/D,MAAI,gBAAgB,QAAW;AAC9B,UAAM,IAAI,uCAAmB,KAAK,QAAQ,GAAG,8BAA8B;AAAA,EAC5E;AAEA,QAAM,UAAU,KAAK,iBAAiB,cAAc,CAAC;AAErD,QAAM,aAAa,YAAY,OAAO,iCAAiC;AACvE,QAAM,UAAU,YAAY,OAAO;AAEnC,QAAM,UAA2B;AAAA,IAChC;AAAA,IACA,IAAI;AAAA,IACJ,KAAK,OAAO,GAAG,OAAO,UAAU,QAAQ;AAAA,IACxC;AAAA,IACA,MAAM;AAAA,EACP;AAEA,MAAI;AACH,WAAO,MAAM,KAAK,QAAQ,0BAA0B,KAAK,MAAM,mBAAmB,OAAO;AAAA,EAC1F,SAAS,OAAO;AACf,UAAM,IAAI,iCAAa,KAAK,QAAQ,GAAG,KAAmB;AAAA,EAC3D;AACD;AAEA,eAAsB,+BAErB,cACA,QACA,UACA,OAAoB,CAAC,GACrB,QAAqB,CAAC,GACrB;AACD,QAAM,aAA4B,CAAC;AAEnC,MAAI;AACJ,MAAI;AACJ,QAAM,WAAW;AAEjB,KAAG;AACF,mBAAe,MAAM,uBAAuB,KAAK,MAAM,QAAQ,UAAU,MAAM,OAAO,GAAG;AACzF,UAAM,WAAO,WAAAA,SAAI,cAAc,4BAA4B;AAC3D,QAAI,MAAM;AACT,YAAM;AAAA,IACP;AACA,eAAW,KAAK,MAAM,YAAY,aAAa,YAAY,CAAkB;AAAA,EAC9E,SAAS,aAAa,MAAM,YAAY,OAAO;AAE/C,SAAO;AACR;","names":["get"]}