{"version":3,"sources":["../../../../../../../nodes/Microsoft/Teams/v2/actions/channelMessage/getAll.operation.ts"],"sourcesContent":["import type { INodeProperties, IExecuteFunctions } from 'n8n-workflow';\n\nimport { returnAllOrLimit } from '@utils/descriptions';\nimport { updateDisplayOptions } from '@utils/utilities';\n\nimport { channelRLC, teamRLC } from '../../descriptions';\nimport { microsoftApiRequestAllItems } from '../../transport';\n\nconst properties: INodeProperties[] = [teamRLC, channelRLC, ...returnAllOrLimit];\n\nconst displayOptions = {\n\tshow: {\n\t\tresource: ['channelMessage'],\n\t\toperation: ['getAll'],\n\t},\n};\n\nexport const description = updateDisplayOptions(displayOptions, properties);\n\nexport async function execute(this: IExecuteFunctions, i: number) {\n\t//https://docs.microsoft.com/en-us/graph/api/channel-list-messages?view=graph-rest-beta&tabs=http\n\n\tconst teamId = this.getNodeParameter('teamId', i, '', { extractValue: true }) as string;\n\tconst channelId = this.getNodeParameter('channelId', i, '', { extractValue: true }) as string;\n\tconst returnAll = this.getNodeParameter('returnAll', i);\n\n\tif (returnAll) {\n\t\treturn await microsoftApiRequestAllItems.call(\n\t\t\tthis,\n\t\t\t'value',\n\t\t\t'GET',\n\t\t\t`/beta/teams/${teamId}/channels/${channelId}/messages`,\n\t\t);\n\t} else {\n\t\tconst limit = this.getNodeParameter('limit', i);\n\t\tconst responseData = await microsoftApiRequestAllItems.call(\n\t\t\tthis,\n\t\t\t'value',\n\t\t\t'GET',\n\t\t\t`/beta/teams/${teamId}/channels/${channelId}/messages`,\n\t\t\t{},\n\t\t);\n\t\treturn responseData.splice(0, limit);\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,0BAAiC;AACjC,uBAAqC;AAErC,IAAAA,uBAAoC;AACpC,uBAA4C;AAE5C,MAAM,aAAgC,CAAC,8BAAS,iCAAY,GAAG,oCAAgB;AAE/E,MAAM,iBAAiB;AAAA,EACtB,MAAM;AAAA,IACL,UAAU,CAAC,gBAAgB;AAAA,IAC3B,WAAW,CAAC,QAAQ;AAAA,EACrB;AACD;AAEO,MAAM,kBAAc,uCAAqB,gBAAgB,UAAU;AAE1E,eAAsB,QAAiC,GAAW;AAGjE,QAAM,SAAS,KAAK,iBAAiB,UAAU,GAAG,IAAI,EAAE,cAAc,KAAK,CAAC;AAC5E,QAAM,YAAY,KAAK,iBAAiB,aAAa,GAAG,IAAI,EAAE,cAAc,KAAK,CAAC;AAClF,QAAM,YAAY,KAAK,iBAAiB,aAAa,CAAC;AAEtD,MAAI,WAAW;AACd,WAAO,MAAM,6CAA4B;AAAA,MACxC;AAAA,MACA;AAAA,MACA;AAAA,MACA,eAAe,MAAM,aAAa,SAAS;AAAA,IAC5C;AAAA,EACD,OAAO;AACN,UAAM,QAAQ,KAAK,iBAAiB,SAAS,CAAC;AAC9C,UAAM,eAAe,MAAM,6CAA4B;AAAA,MACtD;AAAA,MACA;AAAA,MACA;AAAA,MACA,eAAe,MAAM,aAAa,SAAS;AAAA,MAC3C,CAAC;AAAA,IACF;AACA,WAAO,aAAa,OAAO,GAAG,KAAK;AAAA,EACpC;AACD;","names":["import_descriptions"]}