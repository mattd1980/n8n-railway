{"version":3,"sources":["../../../../../../nodes/Microsoft/Teams/v2/actions/router.ts"],"sourcesContent":["import {\n\ttype IExecuteFunctions,\n\ttype IDataObject,\n\ttype INodeExecutionData,\n\tNodeOperationError,\n\tSEND_AND_WAIT_OPERATION,\n} from 'n8n-workflow';\n\nimport * as channel from './channel';\nimport * as channelMessage from './channelMessage';\nimport * as chatMessage from './chatMessage';\nimport type { MicrosoftTeamsType } from './node.type';\nimport * as task from './task';\nimport { configureWaitTillDate } from '../../../../../utils/sendAndWait/configureWaitTillDate.util';\n\nexport async function router(this: IExecuteFunctions): Promise<INodeExecutionData[][]> {\n\tconst items = this.getInputData();\n\tconst returnData: INodeExecutionData[] = [];\n\tlet responseData;\n\n\tconst resource = this.getNodeParameter<MicrosoftTeamsType>('resource', 0);\n\tconst operation = this.getNodeParameter('operation', 0);\n\n\tconst nodeVersion = this.getNode().typeVersion;\n\tconst instanceId = this.getInstanceId();\n\n\tconst microsoftTeamsTypeData = {\n\t\tresource,\n\t\toperation,\n\t} as MicrosoftTeamsType;\n\n\tif (\n\t\tmicrosoftTeamsTypeData.resource === 'chatMessage' &&\n\t\tmicrosoftTeamsTypeData.operation === SEND_AND_WAIT_OPERATION\n\t) {\n\t\tawait chatMessage[microsoftTeamsTypeData.operation].execute.call(this, 0, instanceId);\n\n\t\tconst waitTill = configureWaitTillDate(this);\n\n\t\tawait this.putExecutionToWait(waitTill);\n\t\treturn [items];\n\t}\n\n\tfor (let i = 0; i < items.length; i++) {\n\t\ttry {\n\t\t\tswitch (microsoftTeamsTypeData.resource) {\n\t\t\t\tcase 'channel':\n\t\t\t\t\tresponseData = await channel[microsoftTeamsTypeData.operation].execute.call(this, i);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'channelMessage':\n\t\t\t\t\tresponseData = await channelMessage[microsoftTeamsTypeData.operation].execute.call(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\ti,\n\t\t\t\t\t\tnodeVersion,\n\t\t\t\t\t\tinstanceId,\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'chatMessage':\n\t\t\t\t\tresponseData = await chatMessage[microsoftTeamsTypeData.operation].execute.call(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\ti,\n\t\t\t\t\t\tinstanceId,\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'task':\n\t\t\t\t\tresponseData = await task[microsoftTeamsTypeData.operation].execute.call(this, i);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new NodeOperationError(\n\t\t\t\t\t\tthis.getNode(),\n\t\t\t\t\t\t`The operation \"${operation}\" is not supported!`,\n\t\t\t\t\t);\n\t\t\t}\n\n\t\t\tconst executionData = this.helpers.constructExecutionMetaData(\n\t\t\t\tthis.helpers.returnJsonArray(responseData as IDataObject),\n\t\t\t\t{ itemData: { item: i } },\n\t\t\t);\n\n\t\t\treturnData.push(...executionData);\n\t\t} catch (error) {\n\t\t\tif (this.continueOnFail()) {\n\t\t\t\tconst executionErrorData = this.helpers.constructExecutionMetaData(\n\t\t\t\t\tthis.helpers.returnJsonArray({ error: error.message }),\n\t\t\t\t\t{ itemData: { item: i } },\n\t\t\t\t);\n\t\t\t\treturnData.push(...executionErrorData);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tthrow error;\n\t\t}\n\t}\n\treturn [returnData];\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAMO;AAEP,cAAyB;AACzB,qBAAgC;AAChC,kBAA6B;AAE7B,WAAsB;AACtB,mCAAsC;AAEtC,eAAsB,SAAiE;AACtF,QAAM,QAAQ,KAAK,aAAa;AAChC,QAAM,aAAmC,CAAC;AAC1C,MAAI;AAEJ,QAAM,WAAW,KAAK,iBAAqC,YAAY,CAAC;AACxE,QAAM,YAAY,KAAK,iBAAiB,aAAa,CAAC;AAEtD,QAAM,cAAc,KAAK,QAAQ,EAAE;AACnC,QAAM,aAAa,KAAK,cAAc;AAEtC,QAAM,yBAAyB;AAAA,IAC9B;AAAA,IACA;AAAA,EACD;AAEA,MACC,uBAAuB,aAAa,iBACpC,uBAAuB,cAAc,6CACpC;AACD,UAAM,YAAY,uBAAuB,SAAS,EAAE,QAAQ,KAAK,MAAM,GAAG,UAAU;AAEpF,UAAM,eAAW,oDAAsB,IAAI;AAE3C,UAAM,KAAK,mBAAmB,QAAQ;AACtC,WAAO,CAAC,KAAK;AAAA,EACd;AAEA,WAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACtC,QAAI;AACH,cAAQ,uBAAuB,UAAU;AAAA,QACxC,KAAK;AACJ,yBAAe,MAAM,QAAQ,uBAAuB,SAAS,EAAE,QAAQ,KAAK,MAAM,CAAC;AACnF;AAAA,QACD,KAAK;AACJ,yBAAe,MAAM,eAAe,uBAAuB,SAAS,EAAE,QAAQ;AAAA,YAC7E;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,UACD;AACA;AAAA,QACD,KAAK;AACJ,yBAAe,MAAM,YAAY,uBAAuB,SAAS,EAAE,QAAQ;AAAA,YAC1E;AAAA,YACA;AAAA,YACA;AAAA,UACD;AACA;AAAA,QACD,KAAK;AACJ,yBAAe,MAAM,KAAK,uBAAuB,SAAS,EAAE,QAAQ,KAAK,MAAM,CAAC;AAChF;AAAA,QACD;AACC,gBAAM,IAAI;AAAA,YACT,KAAK,QAAQ;AAAA,YACb,kBAAkB,SAAS;AAAA,UAC5B;AAAA,MACF;AAEA,YAAM,gBAAgB,KAAK,QAAQ;AAAA,QAClC,KAAK,QAAQ,gBAAgB,YAA2B;AAAA,QACxD,EAAE,UAAU,EAAE,MAAM,EAAE,EAAE;AAAA,MACzB;AAEA,iBAAW,KAAK,GAAG,aAAa;AAAA,IACjC,SAAS,OAAO;AACf,UAAI,KAAK,eAAe,GAAG;AAC1B,cAAM,qBAAqB,KAAK,QAAQ;AAAA,UACvC,KAAK,QAAQ,gBAAgB,EAAE,OAAO,MAAM,QAAQ,CAAC;AAAA,UACrD,EAAE,UAAU,EAAE,MAAM,EAAE,EAAE;AAAA,QACzB;AACA,mBAAW,KAAK,GAAG,kBAAkB;AACrC;AAAA,MACD;AACA,YAAM;AAAA,IACP;AAAA,EACD;AACA,SAAO,CAAC,UAAU;AACnB;","names":[]}