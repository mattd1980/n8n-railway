{"version":3,"sources":["../../../../../nodes/Microsoft/AzureCosmosDb/methods/listSearch.ts"],"sourcesContent":["import type {\n\tIDataObject,\n\tILoadOptionsFunctions,\n\tINodeListSearchResult,\n\tINodeListSearchItems,\n} from 'n8n-workflow';\n\nimport { HeaderConstants } from '../helpers/constants';\nimport { azureCosmosDbApiRequest } from '../transport';\n\nfunction formatResults(items: IDataObject[], filter?: string): INodeListSearchItems[] {\n\treturn items\n\t\t.map(({ id }) => ({\n\t\t\tname: String(id).replace(/ /g, ''),\n\t\t\tvalue: String(id),\n\t\t}))\n\t\t.filter(({ name }) => !filter || name.includes(filter))\n\t\t.sort((a, b) => a.name.localeCompare(b.name));\n}\n\nexport async function searchContainers(\n\tthis: ILoadOptionsFunctions,\n\tfilter?: string,\n\tpaginationToken?: string,\n): Promise<INodeListSearchResult> {\n\tconst headers = paginationToken ? { [HeaderConstants.X_MS_CONTINUATION]: paginationToken } : {};\n\tconst responseData = (await azureCosmosDbApiRequest.call(\n\t\tthis,\n\t\t'GET',\n\t\t'/colls',\n\t\t{},\n\t\t{},\n\t\theaders,\n\t\ttrue,\n\t)) as {\n\t\tbody: IDataObject;\n\t\theaders: IDataObject;\n\t};\n\n\tconst containers = responseData.body.DocumentCollections as IDataObject[];\n\n\treturn {\n\t\tresults: formatResults(containers, filter),\n\t\tpaginationToken: responseData.headers[HeaderConstants.X_MS_CONTINUATION],\n\t};\n}\n\nexport async function searchItems(\n\tthis: ILoadOptionsFunctions,\n\tfilter?: string,\n\tpaginationToken?: string,\n): Promise<INodeListSearchResult> {\n\tconst container = this.getCurrentNodeParameter('container', {\n\t\textractValue: true,\n\t}) as string;\n\tconst headers = paginationToken ? { [HeaderConstants.X_MS_CONTINUATION]: paginationToken } : {};\n\tconst responseData = (await azureCosmosDbApiRequest.call(\n\t\tthis,\n\t\t'GET',\n\t\t`/colls/${container}/docs`,\n\t\t{},\n\t\t{},\n\t\theaders,\n\t\ttrue,\n\t)) as {\n\t\tbody: IDataObject;\n\t\theaders: IDataObject;\n\t};\n\n\tconst items = responseData.body.Documents as IDataObject[];\n\n\treturn {\n\t\tresults: formatResults(items, filter),\n\t\tpaginationToken: responseData.headers[HeaderConstants.X_MS_CONTINUATION],\n\t};\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA,uBAAgC;AAChC,uBAAwC;AAExC,SAAS,cAAc,OAAsB,QAAyC;AACrF,SAAO,MACL,IAAI,CAAC,EAAE,GAAG,OAAO;AAAA,IACjB,MAAM,OAAO,EAAE,EAAE,QAAQ,MAAM,EAAE;AAAA,IACjC,OAAO,OAAO,EAAE;AAAA,EACjB,EAAE,EACD,OAAO,CAAC,EAAE,KAAK,MAAM,CAAC,UAAU,KAAK,SAAS,MAAM,CAAC,EACrD,KAAK,CAAC,GAAG,MAAM,EAAE,KAAK,cAAc,EAAE,IAAI,CAAC;AAC9C;AAEA,eAAsB,iBAErB,QACA,iBACiC;AACjC,QAAM,UAAU,kBAAkB,EAAE,CAAC,iCAAgB,iBAAiB,GAAG,gBAAgB,IAAI,CAAC;AAC9F,QAAM,eAAgB,MAAM,yCAAwB;AAAA,IACnD;AAAA,IACA;AAAA,IACA;AAAA,IACA,CAAC;AAAA,IACD,CAAC;AAAA,IACD;AAAA,IACA;AAAA,EACD;AAKA,QAAM,aAAa,aAAa,KAAK;AAErC,SAAO;AAAA,IACN,SAAS,cAAc,YAAY,MAAM;AAAA,IACzC,iBAAiB,aAAa,QAAQ,iCAAgB,iBAAiB;AAAA,EACxE;AACD;AAEA,eAAsB,YAErB,QACA,iBACiC;AACjC,QAAM,YAAY,KAAK,wBAAwB,aAAa;AAAA,IAC3D,cAAc;AAAA,EACf,CAAC;AACD,QAAM,UAAU,kBAAkB,EAAE,CAAC,iCAAgB,iBAAiB,GAAG,gBAAgB,IAAI,CAAC;AAC9F,QAAM,eAAgB,MAAM,yCAAwB;AAAA,IACnD;AAAA,IACA;AAAA,IACA,UAAU,SAAS;AAAA,IACnB,CAAC;AAAA,IACD,CAAC;AAAA,IACD;AAAA,IACA;AAAA,EACD;AAKA,QAAM,QAAQ,aAAa,KAAK;AAEhC,SAAO;AAAA,IACN,SAAS,cAAc,OAAO,MAAM;AAAA,IACpC,iBAAiB,aAAa,QAAQ,iCAAgB,iBAAiB;AAAA,EACxE;AACD;","names":[]}