{"version":3,"sources":["../../../nodes/Magento/Magento2.node.ts"],"sourcesContent":["import { capitalCase } from 'change-case';\nimport type {\n\tIExecuteFunctions,\n\tIDataObject,\n\tILoadOptionsFunctions,\n\tINodeExecutionData,\n\tINodePropertyOptions,\n\tINodeType,\n\tINodeTypeDescription,\n} from 'n8n-workflow';\nimport { NodeConnectionTypes, NodeApiError } from 'n8n-workflow';\n\nimport { customerFields, customerOperations } from './CustomerDescription';\nimport {\n\tadjustAddresses,\n\tgetFilterQuery,\n\tgetOrderFields,\n\tgetProductAttributes,\n\tmagentoApiRequest,\n\tmagentoApiRequestAllItems,\n\tsort,\n\tvalidateJSON,\n} from './GenericFunctions';\nimport { invoiceFields, invoiceOperations } from './InvoiceDescription';\nimport { orderFields, orderOperations } from './OrderDescription';\nimport { productFields, productOperations } from './ProductDescription';\nimport type {\n\tCustomAttribute,\n\tCustomerAttributeMetadata,\n\tFilter,\n\tNewCustomer,\n\tNewProduct,\n\tSearch,\n} from './types';\n\nexport class Magento2 implements INodeType {\n\tdescription: INodeTypeDescription = {\n\t\tdisplayName: 'Magento 2',\n\t\tname: 'magento2',\n\t\ticon: 'file:magento.svg',\n\t\tgroup: ['input'],\n\t\tversion: 1,\n\t\tsubtitle: '={{$parameter[\"operation\"] + \": \" + $parameter[\"resource\"]}}',\n\t\tdescription: 'Consume Magento API',\n\t\tdefaults: {\n\t\t\tname: 'Magento 2',\n\t\t},\n\t\tusableAsTool: true,\n\t\tinputs: [NodeConnectionTypes.Main],\n\t\toutputs: [NodeConnectionTypes.Main],\n\t\tcredentials: [\n\t\t\t{\n\t\t\t\tname: 'magento2Api',\n\t\t\t\trequired: true,\n\t\t\t},\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tdisplayName: 'Resource',\n\t\t\t\tname: 'resource',\n\t\t\t\ttype: 'options',\n\t\t\t\tnoDataExpression: true,\n\t\t\t\toptions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Customer',\n\t\t\t\t\t\tvalue: 'customer',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Invoice',\n\t\t\t\t\t\tvalue: 'invoice',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Order',\n\t\t\t\t\t\tvalue: 'order',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Product',\n\t\t\t\t\t\tvalue: 'product',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tdefault: 'customer',\n\t\t\t},\n\t\t\t...customerOperations,\n\t\t\t...customerFields,\n\t\t\t...invoiceOperations,\n\t\t\t...invoiceFields,\n\t\t\t...orderOperations,\n\t\t\t...orderFields,\n\t\t\t...productOperations,\n\t\t\t...productFields,\n\t\t],\n\t};\n\n\tmethods = {\n\t\tloadOptions: {\n\t\t\tasync getCountries(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/directorycountries\n\t\t\t\tconst countries = await magentoApiRequest.call(\n\t\t\t\t\tthis,\n\t\t\t\t\t'GET',\n\t\t\t\t\t'/rest/default/V1/directory/countries',\n\t\t\t\t);\n\t\t\t\tconst returnData: INodePropertyOptions[] = [];\n\t\t\t\tfor (const country of countries) {\n\t\t\t\t\treturnData.push({\n\t\t\t\t\t\tname: country.full_name_english,\n\t\t\t\t\t\tvalue: country.id,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturnData.sort(sort);\n\t\t\t\treturn returnData;\n\t\t\t},\n\t\t\tasync getGroups(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/customerGroupsdefault#operation/customerGroupManagementV1GetDefaultGroupGet\n\t\t\t\tconst group = await magentoApiRequest.call(\n\t\t\t\t\tthis,\n\t\t\t\t\t'GET',\n\t\t\t\t\t'/rest/default/V1/customerGroups/default',\n\t\t\t\t);\n\t\t\t\tconst returnData: INodePropertyOptions[] = [];\n\t\t\t\treturnData.push({\n\t\t\t\t\tname: group.code,\n\t\t\t\t\tvalue: group.id,\n\t\t\t\t});\n\t\t\t\treturnData.sort(sort);\n\t\t\t\treturn returnData;\n\t\t\t},\n\t\t\tasync getStores(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/storestoreConfigs\n\t\t\t\tconst stores = await magentoApiRequest.call(\n\t\t\t\t\tthis,\n\t\t\t\t\t'GET',\n\t\t\t\t\t'/rest/default/V1/store/storeConfigs',\n\t\t\t\t);\n\t\t\t\tconst returnData: INodePropertyOptions[] = [];\n\t\t\t\tfor (const store of stores) {\n\t\t\t\t\treturnData.push({\n\t\t\t\t\t\tname: store.base_url,\n\t\t\t\t\t\tvalue: store.id,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturnData.sort(sort);\n\t\t\t\treturn returnData;\n\t\t\t},\n\t\t\tasync getWebsites(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/storewebsites\n\t\t\t\tconst websites = await magentoApiRequest.call(\n\t\t\t\t\tthis,\n\t\t\t\t\t'GET',\n\t\t\t\t\t'/rest/default/V1/store/websites',\n\t\t\t\t);\n\t\t\t\tconst returnData: INodePropertyOptions[] = [];\n\t\t\t\tfor (const website of websites) {\n\t\t\t\t\treturnData.push({\n\t\t\t\t\t\tname: website.name,\n\t\t\t\t\t\tvalue: website.id,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturnData.sort(sort);\n\t\t\t\treturn returnData;\n\t\t\t},\n\t\t\tasync getCustomAttributes(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/attributeMetadatacustomer#operation/customerCustomerMetadataV1GetAllAttributesMetadataGet\n\t\t\t\tconst resource = this.getCurrentNodeParameter('resource') as string;\n\t\t\t\tconst attributes = (await magentoApiRequest.call(\n\t\t\t\t\tthis,\n\t\t\t\t\t'GET',\n\t\t\t\t\t`/rest/default/V1/attributeMetadata/${resource}`,\n\t\t\t\t)) as CustomerAttributeMetadata[];\n\t\t\t\tconst returnData: INodePropertyOptions[] = [];\n\t\t\t\tfor (const attribute of attributes) {\n\t\t\t\t\tif (attribute.system === false && attribute.frontend_label !== '') {\n\t\t\t\t\t\treturnData.push({\n\t\t\t\t\t\t\tname: attribute.frontend_label as string,\n\t\t\t\t\t\t\tvalue: attribute.attribute_code as string,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturnData.sort(sort);\n\t\t\t\treturn returnData;\n\t\t\t},\n\t\t\tasync getSystemAttributes(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/attributeMetadatacustomer#operation/customerCustomerMetadataV1GetAllAttributesMetadataGet\n\t\t\t\tconst resource = this.getCurrentNodeParameter('resource') as string;\n\t\t\t\tconst attributes = (await magentoApiRequest.call(\n\t\t\t\t\tthis,\n\t\t\t\t\t'GET',\n\t\t\t\t\t`/rest/default/V1/attributeMetadata/${resource}`,\n\t\t\t\t)) as CustomerAttributeMetadata[];\n\t\t\t\tconst returnData: INodePropertyOptions[] = [];\n\t\t\t\tfor (const attribute of attributes) {\n\t\t\t\t\tif (attribute.system === true && attribute.frontend_label !== null) {\n\t\t\t\t\t\treturnData.push({\n\t\t\t\t\t\t\tname: attribute.frontend_label as string,\n\t\t\t\t\t\t\tvalue: attribute.attribute_code as string,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturnData.sort(sort);\n\t\t\t\treturn returnData;\n\t\t\t},\n\t\t\tasync getProductTypes(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/productslinkstypes\n\t\t\t\tconst types = (await magentoApiRequest.call(\n\t\t\t\t\tthis,\n\t\t\t\t\t'GET',\n\t\t\t\t\t'/rest/default/V1/products/types',\n\t\t\t\t)) as IDataObject[];\n\t\t\t\tconst returnData: INodePropertyOptions[] = [];\n\t\t\t\tfor (const type of types) {\n\t\t\t\t\treturnData.push({\n\t\t\t\t\t\tname: type.label as string,\n\t\t\t\t\t\tvalue: type.name as string,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturnData.sort(sort);\n\t\t\t\treturn returnData;\n\t\t\t},\n\t\t\tasync getCategories(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/categories#operation/catalogCategoryManagementV1GetTreeGet\n\t\t\t\tconst { items: categories } = (await magentoApiRequest.call(\n\t\t\t\t\tthis,\n\t\t\t\t\t'GET',\n\t\t\t\t\t'/rest/default/V1/categories/list',\n\t\t\t\t\t{},\n\t\t\t\t\t{\n\t\t\t\t\t\tsearch_criteria: {\n\t\t\t\t\t\t\tfilter_groups: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfilters: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tfield: 'is_active',\n\t\t\t\t\t\t\t\t\t\t\tcondition_type: 'eq',\n\t\t\t\t\t\t\t\t\t\t\tvalue: 1,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t)) as { items: IDataObject[] };\n\t\t\t\tconst returnData: INodePropertyOptions[] = [];\n\t\t\t\tfor (const category of categories) {\n\t\t\t\t\treturnData.push({\n\t\t\t\t\t\tname: category.name as string,\n\t\t\t\t\t\tvalue: category.id as string,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturnData.sort(sort);\n\t\t\t\treturn returnData;\n\t\t\t},\n\t\t\tasync getAttributeSets(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/productsattribute-setssetslist#operation/catalogAttributeSetRepositoryV1GetListGet\n\t\t\t\tconst { items: attributeSets } = (await magentoApiRequest.call(\n\t\t\t\t\tthis,\n\t\t\t\t\t'GET',\n\t\t\t\t\t'/rest/default/V1/products/attribute-sets/sets/list',\n\t\t\t\t\t{},\n\t\t\t\t\t{\n\t\t\t\t\t\tsearch_criteria: 0,\n\t\t\t\t\t},\n\t\t\t\t)) as { items: IDataObject[] };\n\t\t\t\tconst returnData: INodePropertyOptions[] = [];\n\t\t\t\tfor (const attributeSet of attributeSets) {\n\t\t\t\t\treturnData.push({\n\t\t\t\t\t\tname: attributeSet.attribute_set_name as string,\n\t\t\t\t\t\tvalue: attributeSet.attribute_set_id as string,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturnData.sort(sort);\n\t\t\t\treturn returnData;\n\t\t\t},\n\t\t\tasync getFilterableCustomerAttributes(\n\t\t\t\tthis: ILoadOptionsFunctions,\n\t\t\t): Promise<INodePropertyOptions[]> {\n\t\t\t\treturn await getProductAttributes.call(this, (attribute) => attribute.is_filterable);\n\t\t\t},\n\t\t\tasync getProductAttributes(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\t\t\t\treturn await getProductAttributes.call(this);\n\t\t\t},\n\t\t\t// async getProductAttributesFields(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\t\t\t// \treturn getProductAttributes.call(this, undefined, { name: '*', value: '*', description: 'All properties' });\n\t\t\t// },\n\t\t\tasync getFilterableProductAttributes(\n\t\t\t\tthis: ILoadOptionsFunctions,\n\t\t\t): Promise<INodePropertyOptions[]> {\n\t\t\t\treturn await getProductAttributes.call(\n\t\t\t\t\tthis,\n\t\t\t\t\t(attribute) => attribute.is_searchable === '1',\n\t\t\t\t);\n\t\t\t},\n\t\t\tasync getSortableProductAttributes(\n\t\t\t\tthis: ILoadOptionsFunctions,\n\t\t\t): Promise<INodePropertyOptions[]> {\n\t\t\t\treturn await getProductAttributes.call(this, (attribute) => attribute.used_for_sort_by);\n\t\t\t},\n\t\t\tasync getOrderAttributes(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\t\t\t\treturn getOrderFields()\n\t\t\t\t\t.map((field) => ({ name: capitalCase(field), value: field }))\n\t\t\t\t\t.sort(sort);\n\t\t\t},\n\t\t},\n\t};\n\n\tasync execute(this: IExecuteFunctions): Promise<INodeExecutionData[][]> {\n\t\tconst items = this.getInputData();\n\t\tconst returnData: INodeExecutionData[] = [];\n\t\tconst length = items.length;\n\t\tlet responseData;\n\t\tconst resource = this.getNodeParameter('resource', 0);\n\t\tconst operation = this.getNodeParameter('operation', 0);\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\ttry {\n\t\t\t\tif (resource === 'customer') {\n\t\t\t\t\tif (operation === 'create') {\n\t\t\t\t\t\t// https://magento.redoc.ly/2.3.7-admin/tag/customerscustomerId#operation/customerCustomerRepositoryV1SavePut\n\t\t\t\t\t\tconst email = this.getNodeParameter('email', i) as string;\n\t\t\t\t\t\tconst firstname = this.getNodeParameter('firstname', i) as string;\n\t\t\t\t\t\tconst lastname = this.getNodeParameter('lastname', i) as string;\n\n\t\t\t\t\t\tconst { addresses, customAttributes, password, ...rest } = this.getNodeParameter(\n\t\t\t\t\t\t\t'additionalFields',\n\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t) as {\n\t\t\t\t\t\t\taddresses: {\n\t\t\t\t\t\t\t\taddress: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tstreet: string;\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tcustomAttributes: {\n\t\t\t\t\t\t\t\tcustomAttribute: CustomAttribute[];\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tpassword: string;\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tconst body: NewCustomer = {\n\t\t\t\t\t\t\tcustomer: {\n\t\t\t\t\t\t\t\temail,\n\t\t\t\t\t\t\t\tfirstname,\n\t\t\t\t\t\t\t\tlastname,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tbody.customer!.addresses = adjustAddresses(addresses?.address || []);\n\n\t\t\t\t\t\tbody.customer!.custom_attributes = customAttributes?.customAttribute || {};\n\n\t\t\t\t\t\tbody.customer!.extension_attributes = [\n\t\t\t\t\t\t\t'amazon_id',\n\t\t\t\t\t\t\t'is_subscribed',\n\t\t\t\t\t\t\t'vertex_customer_code',\n\t\t\t\t\t\t\t'vertex_customer_country',\n\t\t\t\t\t\t].reduce((obj, value: string): any => {\n\t\t\t\t\t\t\tif ((rest as IDataObject).hasOwnProperty(value)) {\n\t\t\t\t\t\t\t\tconst data = Object.assign(obj, { [value]: (rest as IDataObject)[value] });\n\t\t\t\t\t\t\t\tdelete (rest as IDataObject)[value];\n\t\t\t\t\t\t\t\treturn data;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn obj;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {});\n\n\t\t\t\t\t\tif (password) {\n\t\t\t\t\t\t\tbody.password = password;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tObject.assign(body.customer!, rest);\n\n\t\t\t\t\t\tresponseData = await magentoApiRequest.call(this, 'POST', '/rest/V1/customers', body);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (operation === 'delete') {\n\t\t\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/customerscustomerId#operation/customerCustomerRepositoryV1SavePut\n\t\t\t\t\t\tconst customerId = this.getNodeParameter('customerId', i) as string;\n\n\t\t\t\t\t\tresponseData = await magentoApiRequest.call(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t'DELETE',\n\t\t\t\t\t\t\t`/rest/default/V1/customers/${customerId}`,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tresponseData = { success: true };\n\t\t\t\t\t}\n\n\t\t\t\t\tif (operation === 'get') {\n\t\t\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/customerscustomerId#operation/customerCustomerRepositoryV1GetByIdGet\n\t\t\t\t\t\tconst customerId = this.getNodeParameter('customerId', i) as string;\n\n\t\t\t\t\t\tresponseData = await magentoApiRequest.call(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t'GET',\n\t\t\t\t\t\t\t`/rest/default/V1/customers/${customerId}`,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (operation === 'getAll') {\n\t\t\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/customerssearch\n\t\t\t\t\t\tconst filterType = this.getNodeParameter('filterType', i) as string;\n\t\t\t\t\t\tconst sortOption = this.getNodeParameter('options.sort', i, {}) as {\n\t\t\t\t\t\t\tsort: [{ direction: string; field: string }];\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst returnAll = this.getNodeParameter('returnAll', 0);\n\t\t\t\t\t\tlet qs: Search = {};\n\n\t\t\t\t\t\tif (filterType === 'manual') {\n\t\t\t\t\t\t\tconst filters = this.getNodeParameter('filters', i) as { conditions: Filter[] };\n\t\t\t\t\t\t\tconst matchType = this.getNodeParameter('matchType', i) as string;\n\t\t\t\t\t\t\tqs = getFilterQuery(Object.assign(filters, { matchType }, sortOption));\n\t\t\t\t\t\t} else if (filterType === 'json') {\n\t\t\t\t\t\t\tconst filterJson = this.getNodeParameter('filterJson', i) as string;\n\t\t\t\t\t\t\tif (validateJSON(filterJson) !== undefined) {\n\t\t\t\t\t\t\t\tqs = JSON.parse(filterJson);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthrow new NodeApiError(this.getNode(), {\n\t\t\t\t\t\t\t\t\tmessage: 'Filter (JSON) must be a valid json',\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tqs = {\n\t\t\t\t\t\t\t\tsearch_criteria: {},\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tif (Object.keys(sortOption).length !== 0) {\n\t\t\t\t\t\t\t\tqs.search_criteria = {\n\t\t\t\t\t\t\t\t\tsort_orders: sortOption.sort,\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (returnAll) {\n\t\t\t\t\t\t\tqs.search_criteria!.page_size = 100;\n\t\t\t\t\t\t\tresponseData = await magentoApiRequestAllItems.call(\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\t'items',\n\t\t\t\t\t\t\t\t'GET',\n\t\t\t\t\t\t\t\t'/rest/default/V1/customers/search',\n\t\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t\tqs as unknown as IDataObject,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst limit = this.getNodeParameter('limit', 0);\n\t\t\t\t\t\t\tqs.search_criteria!.page_size = limit;\n\t\t\t\t\t\t\tresponseData = await magentoApiRequest.call(\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\t'GET',\n\t\t\t\t\t\t\t\t'/rest/default/V1/customers/search',\n\t\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t\tqs as unknown as IDataObject,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tresponseData = responseData.items;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (operation === 'update') {\n\t\t\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/customerscustomerId#operation/customerCustomerRepositoryV1SavePut\n\t\t\t\t\t\tconst customerId = this.getNodeParameter('customerId', i) as string;\n\t\t\t\t\t\tconst firstName = this.getNodeParameter('firstName', i) as string;\n\t\t\t\t\t\tconst lastName = this.getNodeParameter('lastName', i) as string;\n\t\t\t\t\t\tconst email = this.getNodeParameter('email', i) as string;\n\n\t\t\t\t\t\tconst { addresses, customAttributes, password, ...rest } = this.getNodeParameter(\n\t\t\t\t\t\t\t'updateFields',\n\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t) as {\n\t\t\t\t\t\t\taddresses: {\n\t\t\t\t\t\t\t\taddress: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tstreet: string;\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tcustomAttributes: {\n\t\t\t\t\t\t\t\tcustomAttribute: CustomAttribute[];\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tpassword: string;\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tconst body: NewCustomer = {\n\t\t\t\t\t\t\tcustomer: {\n\t\t\t\t\t\t\t\temail,\n\t\t\t\t\t\t\t\tfirstname: firstName,\n\t\t\t\t\t\t\t\tlastname: lastName,\n\t\t\t\t\t\t\t\tid: parseInt(customerId, 10),\n\t\t\t\t\t\t\t\twebsite_id: 0,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tbody.customer!.addresses = adjustAddresses(addresses?.address || []);\n\n\t\t\t\t\t\tbody.customer!.custom_attributes = customAttributes?.customAttribute || {};\n\n\t\t\t\t\t\tbody.customer!.extension_attributes = [\n\t\t\t\t\t\t\t'amazon_id',\n\t\t\t\t\t\t\t'is_subscribed',\n\t\t\t\t\t\t\t'vertex_customer_code',\n\t\t\t\t\t\t\t'vertex_customer_country',\n\t\t\t\t\t\t].reduce((obj, value: string): any => {\n\t\t\t\t\t\t\tif ((rest as IDataObject).hasOwnProperty(value)) {\n\t\t\t\t\t\t\t\tconst data = Object.assign(obj, { [value]: (rest as IDataObject)[value] });\n\t\t\t\t\t\t\t\tdelete (rest as IDataObject)[value];\n\t\t\t\t\t\t\t\treturn data;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn obj;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {});\n\n\t\t\t\t\t\tif (password) {\n\t\t\t\t\t\t\tbody.password = password;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tObject.assign(body.customer!, rest);\n\n\t\t\t\t\t\tresponseData = await magentoApiRequest.call(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t'PUT',\n\t\t\t\t\t\t\t`/rest/V1/customers/${customerId}`,\n\t\t\t\t\t\t\tbody,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (resource === 'invoice') {\n\t\t\t\t\tif (operation === 'create') {\n\t\t\t\t\t\t///https://magento.redoc.ly/2.3.7-admin/tag/orderorderIdinvoice\n\t\t\t\t\t\tconst orderId = this.getNodeParameter('orderId', i) as string;\n\n\t\t\t\t\t\tresponseData = await magentoApiRequest.call(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t'POST',\n\t\t\t\t\t\t\t`/rest/default/V1/order/${orderId}/invoice`,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tresponseData = { success: true };\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (resource === 'order') {\n\t\t\t\t\tif (operation === 'cancel') {\n\t\t\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/ordersidcancel\n\t\t\t\t\t\tconst orderId = this.getNodeParameter('orderId', i) as string;\n\n\t\t\t\t\t\tresponseData = await magentoApiRequest.call(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t'POST',\n\t\t\t\t\t\t\t`/rest/default/V1/orders/${orderId}/cancel`,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tresponseData = { success: true };\n\t\t\t\t\t}\n\n\t\t\t\t\tif (operation === 'get') {\n\t\t\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/ordersid#operation/salesOrderRepositoryV1GetGet\n\t\t\t\t\t\tconst orderId = this.getNodeParameter('orderId', i) as string;\n\n\t\t\t\t\t\tresponseData = await magentoApiRequest.call(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t'GET',\n\t\t\t\t\t\t\t`/rest/default/V1/orders/${orderId}`,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (operation === 'ship') {\n\t\t\t\t\t\t///https://magento.redoc.ly/2.3.7-admin/tag/orderorderIdship#operation/salesShipOrderV1ExecutePost\n\t\t\t\t\t\tconst orderId = this.getNodeParameter('orderId', i) as string;\n\n\t\t\t\t\t\tresponseData = await magentoApiRequest.call(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t'POST',\n\t\t\t\t\t\t\t`/rest/default/V1/order/${orderId}/ship`,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tresponseData = { success: true };\n\t\t\t\t\t}\n\n\t\t\t\t\tif (operation === 'getAll') {\n\t\t\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/orders#operation/salesOrderRepositoryV1GetListGet\n\t\t\t\t\t\tconst filterType = this.getNodeParameter('filterType', i) as string;\n\t\t\t\t\t\tconst sortOption = this.getNodeParameter('options.sort', i, {}) as {\n\t\t\t\t\t\t\tsort: [{ direction: string; field: string }];\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst returnAll = this.getNodeParameter('returnAll', 0);\n\t\t\t\t\t\tlet qs: Search = {};\n\n\t\t\t\t\t\tif (filterType === 'manual') {\n\t\t\t\t\t\t\tconst filters = this.getNodeParameter('filters', i) as { conditions: Filter[] };\n\t\t\t\t\t\t\tconst matchType = this.getNodeParameter('matchType', i) as string;\n\t\t\t\t\t\t\tqs = getFilterQuery(Object.assign(filters, { matchType }, sortOption));\n\t\t\t\t\t\t} else if (filterType === 'json') {\n\t\t\t\t\t\t\tconst filterJson = this.getNodeParameter('filterJson', i) as string;\n\t\t\t\t\t\t\tif (validateJSON(filterJson) !== undefined) {\n\t\t\t\t\t\t\t\tqs = JSON.parse(filterJson);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthrow new NodeApiError(this.getNode(), {\n\t\t\t\t\t\t\t\t\tmessage: 'Filter (JSON) must be a valid json',\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tqs = {\n\t\t\t\t\t\t\t\tsearch_criteria: {},\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tif (Object.keys(sortOption).length !== 0) {\n\t\t\t\t\t\t\t\tqs.search_criteria = {\n\t\t\t\t\t\t\t\t\tsort_orders: sortOption.sort,\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (returnAll) {\n\t\t\t\t\t\t\tqs.search_criteria!.page_size = 100;\n\t\t\t\t\t\t\tresponseData = await magentoApiRequestAllItems.call(\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\t'items',\n\t\t\t\t\t\t\t\t'GET',\n\t\t\t\t\t\t\t\t'/rest/default/V1/orders',\n\t\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t\tqs as unknown as IDataObject,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst limit = this.getNodeParameter('limit', 0);\n\t\t\t\t\t\t\tqs.search_criteria!.page_size = limit;\n\t\t\t\t\t\t\tresponseData = await magentoApiRequest.call(\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\t'GET',\n\t\t\t\t\t\t\t\t'/rest/default/V1/orders',\n\t\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t\tqs as unknown as IDataObject,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tresponseData = responseData.items;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (resource === 'product') {\n\t\t\t\t\tif (operation === 'create') {\n\t\t\t\t\t\t// https://magento.redoc.ly/2.3.7-admin/tag/products#operation/catalogProductRepositoryV1SavePost\n\t\t\t\t\t\tconst sku = this.getNodeParameter('sku', i) as string;\n\t\t\t\t\t\tconst name = this.getNodeParameter('name', i) as string;\n\t\t\t\t\t\tconst attributeSetId = this.getNodeParameter('attributeSetId', i) as string;\n\t\t\t\t\t\tconst price = this.getNodeParameter('price', i) as number;\n\n\t\t\t\t\t\tconst {\n\t\t\t\t\t\t\tcustomAttributes,\n\t\t\t\t\t\t\tcategory: _category,\n\t\t\t\t\t\t\t...rest\n\t\t\t\t\t\t} = this.getNodeParameter('additionalFields', i) as {\n\t\t\t\t\t\t\tcustomAttributes: {\n\t\t\t\t\t\t\t\tcustomAttribute: CustomAttribute[];\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tcategory: string;\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tconst body: NewProduct = {\n\t\t\t\t\t\t\tproduct: {\n\t\t\t\t\t\t\t\tsku,\n\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\tattribute_set_id: parseInt(attributeSetId, 10),\n\t\t\t\t\t\t\t\tprice,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tbody.product!.custom_attributes = customAttributes?.customAttribute || {};\n\n\t\t\t\t\t\tObject.assign(body.product!, rest);\n\n\t\t\t\t\t\tresponseData = await magentoApiRequest.call(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t'POST',\n\t\t\t\t\t\t\t'/rest/default/V1/products',\n\t\t\t\t\t\t\tbody,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (operation === 'delete') {\n\t\t\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/productssku#operation/catalogProductRepositoryV1DeleteByIdDelete\n\t\t\t\t\t\tconst sku = this.getNodeParameter('sku', i) as string;\n\n\t\t\t\t\t\tresponseData = await magentoApiRequest.call(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t'DELETE',\n\t\t\t\t\t\t\t`/rest/default/V1/products/${sku}`,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tresponseData = { success: true };\n\t\t\t\t\t}\n\n\t\t\t\t\tif (operation === 'get') {\n\t\t\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/productssku#operation/catalogProductRepositoryV1GetGet\n\t\t\t\t\t\tconst sku = this.getNodeParameter('sku', i) as string;\n\n\t\t\t\t\t\tresponseData = await magentoApiRequest.call(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t'GET',\n\t\t\t\t\t\t\t`/rest/default/V1/products/${sku}`,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (operation === 'getAll') {\n\t\t\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/customerssearch\n\t\t\t\t\t\tconst filterType = this.getNodeParameter('filterType', i) as string;\n\t\t\t\t\t\tconst sortOption = this.getNodeParameter('options.sort', i, {}) as {\n\t\t\t\t\t\t\tsort: [{ direction: string; field: string }];\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst returnAll = this.getNodeParameter('returnAll', 0);\n\t\t\t\t\t\tlet qs: Search = {};\n\n\t\t\t\t\t\tif (filterType === 'manual') {\n\t\t\t\t\t\t\tconst filters = this.getNodeParameter('filters', i) as { conditions: Filter[] };\n\t\t\t\t\t\t\tconst matchType = this.getNodeParameter('matchType', i) as string;\n\t\t\t\t\t\t\tqs = getFilterQuery(Object.assign(filters, { matchType }, sortOption));\n\t\t\t\t\t\t} else if (filterType === 'json') {\n\t\t\t\t\t\t\tconst filterJson = this.getNodeParameter('filterJson', i) as string;\n\t\t\t\t\t\t\tif (validateJSON(filterJson) !== undefined) {\n\t\t\t\t\t\t\t\tqs = JSON.parse(filterJson);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthrow new NodeApiError(this.getNode(), {\n\t\t\t\t\t\t\t\t\tmessage: 'Filter (JSON) must be a valid json',\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tqs = {\n\t\t\t\t\t\t\t\tsearch_criteria: {},\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tif (Object.keys(sortOption).length !== 0) {\n\t\t\t\t\t\t\t\tqs.search_criteria = {\n\t\t\t\t\t\t\t\t\tsort_orders: sortOption.sort,\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (returnAll) {\n\t\t\t\t\t\t\tqs.search_criteria!.page_size = 100;\n\t\t\t\t\t\t\tresponseData = await magentoApiRequestAllItems.call(\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\t'items',\n\t\t\t\t\t\t\t\t'GET',\n\t\t\t\t\t\t\t\t'/rest/default/V1/products',\n\t\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t\tqs as unknown as IDataObject,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst limit = this.getNodeParameter('limit', 0);\n\t\t\t\t\t\t\tqs.search_criteria!.page_size = limit;\n\t\t\t\t\t\t\tresponseData = await magentoApiRequest.call(\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\t'GET',\n\t\t\t\t\t\t\t\t'/rest/default/V1/products',\n\t\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t\tqs as unknown as IDataObject,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tresponseData = responseData.items;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (operation === 'update') {\n\t\t\t\t\t\t//https://magento.redoc.ly/2.3.7-admin/tag/productssku#operation/catalogProductRepositoryV1SavePut\n\t\t\t\t\t\tconst sku = this.getNodeParameter('sku', i) as string;\n\n\t\t\t\t\t\tconst { customAttributes, ...rest } = this.getNodeParameter('updateFields', i) as {\n\t\t\t\t\t\t\tcustomAttributes: {\n\t\t\t\t\t\t\t\tcustomAttribute: CustomAttribute[];\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (!Object.keys(rest).length) {\n\t\t\t\t\t\t\tthrow new NodeApiError(this.getNode(), {\n\t\t\t\t\t\t\t\tmessage: 'At least one parameter has to be updated',\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst body: NewProduct = {\n\t\t\t\t\t\t\tproduct: {\n\t\t\t\t\t\t\t\tsku,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tbody.product!.custom_attributes = customAttributes?.customAttribute || {};\n\n\t\t\t\t\t\tObject.assign(body.product!, rest);\n\n\t\t\t\t\t\tresponseData = await magentoApiRequest.call(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t'PUT',\n\t\t\t\t\t\t\t`/rest/default/V1/products/${sku}`,\n\t\t\t\t\t\t\tbody,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst executionData = this.helpers.constructExecutionMetaData(\n\t\t\t\t\tthis.helpers.returnJsonArray(responseData as IDataObject[]),\n\t\t\t\t\t{ itemData: { item: i } },\n\t\t\t\t);\n\n\t\t\t\treturnData.push(...executionData);\n\t\t\t} catch (error) {\n\t\t\t\tif (this.continueOnFail()) {\n\t\t\t\t\tconst executionErrorData = this.helpers.constructExecutionMetaData(\n\t\t\t\t\t\tthis.helpers.returnJsonArray({ error: error.message }),\n\t\t\t\t\t\t{ itemData: { item: i } },\n\t\t\t\t\t);\n\t\t\t\t\treturnData.push(...executionErrorData);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\n\t\treturn [returnData];\n\t}\n}\n"],"mappings":"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","names":[]}