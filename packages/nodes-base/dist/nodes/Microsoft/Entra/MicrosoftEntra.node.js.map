{"version":3,"sources":["../../../../nodes/Microsoft/Entra/MicrosoftEntra.node.ts"],"sourcesContent":["import type {\n\tILoadOptionsFunctions,\n\tINodePropertyOptions,\n\tINodeType,\n\tINodeTypeDescription,\n} from 'n8n-workflow';\nimport { NodeConnectionTypes } from 'n8n-workflow';\n\nimport { groupFields, groupOperations, userFields, userOperations } from './descriptions';\nimport { getGroupProperties, getGroups, getUserProperties, getUsers } from './GenericFunctions';\n\nexport class MicrosoftEntra implements INodeType {\n\tdescription: INodeTypeDescription = {\n\t\tdisplayName: 'Microsoft Entra ID',\n\t\tname: 'microsoftEntra',\n\t\ticon: {\n\t\t\tlight: 'file:microsoftEntra.svg',\n\t\t\tdark: 'file:microsoftEntra.dark.svg',\n\t\t},\n\t\tgroup: ['transform'],\n\t\tversion: 1,\n\t\tsubtitle: '={{$parameter[\"operation\"] + \": \" + $parameter[\"resource\"]}}',\n\t\tdescription: 'Interact with Microsoft Entra ID API',\n\t\tdefaults: {\n\t\t\tname: 'Microsoft Entra ID',\n\t\t},\n\t\tusableAsTool: true,\n\t\tinputs: [NodeConnectionTypes.Main],\n\t\toutputs: [NodeConnectionTypes.Main],\n\t\tcredentials: [\n\t\t\t{\n\t\t\t\tname: 'microsoftEntraOAuth2Api',\n\t\t\t\trequired: true,\n\t\t\t},\n\t\t],\n\t\trequestDefaults: {\n\t\t\tbaseURL: 'https://graph.microsoft.com/v1.0',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t},\n\t\t},\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tdisplayName: 'Resource',\n\t\t\t\tname: 'resource',\n\t\t\t\ttype: 'options',\n\t\t\t\tnoDataExpression: true,\n\t\t\t\toptions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Group',\n\t\t\t\t\t\tvalue: 'group',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'User',\n\t\t\t\t\t\tvalue: 'user',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tdefault: 'user',\n\t\t\t},\n\n\t\t\t...groupOperations,\n\t\t\t...groupFields,\n\t\t\t...userOperations,\n\t\t\t...userFields,\n\t\t],\n\t};\n\n\tmethods = {\n\t\tloadOptions: {\n\t\t\tgetGroupProperties,\n\n\t\t\tasync getGroupPropertiesGetAll(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\t\t\t\t// Filter items not supported for list endpoint\n\t\t\t\treturn (await getGroupProperties.call(this)).filter(\n\t\t\t\t\t(x) =>\n\t\t\t\t\t\t![\n\t\t\t\t\t\t\t'allowExternalSenders',\n\t\t\t\t\t\t\t'autoSubscribeNewMembers',\n\t\t\t\t\t\t\t'hideFromAddressLists',\n\t\t\t\t\t\t\t'hideFromOutlookClients',\n\t\t\t\t\t\t\t'isSubscribedByMail',\n\t\t\t\t\t\t\t'unseenCount',\n\t\t\t\t\t\t].includes(x.value as string),\n\t\t\t\t);\n\t\t\t},\n\n\t\t\tgetUserProperties,\n\n\t\t\tasync getUserPropertiesGetAll(this: ILoadOptionsFunctions): Promise<INodePropertyOptions[]> {\n\t\t\t\t// Filter items not supported for list endpoint\n\t\t\t\treturn (await getUserProperties.call(this)).filter(\n\t\t\t\t\t(x) =>\n\t\t\t\t\t\t![\n\t\t\t\t\t\t\t'aboutMe',\n\t\t\t\t\t\t\t'birthday',\n\t\t\t\t\t\t\t'hireDate',\n\t\t\t\t\t\t\t'interests',\n\t\t\t\t\t\t\t'mySite',\n\t\t\t\t\t\t\t'pastProjects',\n\t\t\t\t\t\t\t'preferredName',\n\t\t\t\t\t\t\t'responsibilities',\n\t\t\t\t\t\t\t'schools',\n\t\t\t\t\t\t\t'skills',\n\t\t\t\t\t\t\t'mailboxSettings',\n\t\t\t\t\t\t].includes(x.value as string),\n\t\t\t\t);\n\t\t\t},\n\t\t},\n\n\t\tlistSearch: {\n\t\t\tgetGroups,\n\n\t\t\tgetUsers,\n\t\t},\n\t};\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA,0BAAoC;AAEpC,0BAAyE;AACzE,8BAA2E;AAEpE,MAAM,eAAoC;AAAA,EAA1C;AACN,uBAAoC;AAAA,MACnC,aAAa;AAAA,MACb,MAAM;AAAA,MACN,MAAM;AAAA,QACL,OAAO;AAAA,QACP,MAAM;AAAA,MACP;AAAA,MACA,OAAO,CAAC,WAAW;AAAA,MACnB,SAAS;AAAA,MACT,UAAU;AAAA,MACV,aAAa;AAAA,MACb,UAAU;AAAA,QACT,MAAM;AAAA,MACP;AAAA,MACA,cAAc;AAAA,MACd,QAAQ,CAAC,wCAAoB,IAAI;AAAA,MACjC,SAAS,CAAC,wCAAoB,IAAI;AAAA,MAClC,aAAa;AAAA,QACZ;AAAA,UACC,MAAM;AAAA,UACN,UAAU;AAAA,QACX;AAAA,MACD;AAAA,MACA,iBAAiB;AAAA,QAChB,SAAS;AAAA,QACT,SAAS;AAAA,UACR,gBAAgB;AAAA,QACjB;AAAA,MACD;AAAA,MACA,YAAY;AAAA,QACX;AAAA,UACC,aAAa;AAAA,UACb,MAAM;AAAA,UACN,MAAM;AAAA,UACN,kBAAkB;AAAA,UAClB,SAAS;AAAA,YACR;AAAA,cACC,MAAM;AAAA,cACN,OAAO;AAAA,YACR;AAAA,YACA;AAAA,cACC,MAAM;AAAA,cACN,OAAO;AAAA,YACR;AAAA,UACD;AAAA,UACA,SAAS;AAAA,QACV;AAAA,QAEA,GAAG;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,QACH,GAAG;AAAA,MACJ;AAAA,IACD;AAEA,mBAAU;AAAA,MACT,aAAa;AAAA,QACZ;AAAA,QAEA,MAAM,2BAAuF;AAE5F,kBAAQ,MAAM,2CAAmB,KAAK,IAAI,GAAG;AAAA,YAC5C,CAAC,MACA,CAAC;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,YACD,EAAE,SAAS,EAAE,KAAe;AAAA,UAC9B;AAAA,QACD;AAAA,QAEA;AAAA,QAEA,MAAM,0BAAsF;AAE3F,kBAAQ,MAAM,0CAAkB,KAAK,IAAI,GAAG;AAAA,YAC3C,CAAC,MACA,CAAC;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,YACD,EAAE,SAAS,EAAE,KAAe;AAAA,UAC9B;AAAA,QACD;AAAA,MACD;AAAA,MAEA,YAAY;AAAA,QACX;AAAA,QAEA;AAAA,MACD;AAAA,IACD;AAAA;AACD;","names":[]}