{"version":3,"sources":["../../../../../../../nodes/Microsoft/Teams/v2/actions/chatMessage/sendAndWait.operation.ts"],"sourcesContent":["import type { INodeProperties, IExecuteFunctions } from 'n8n-workflow';\n\nimport {\n\tgetSendAndWaitConfig,\n\tgetSendAndWaitProperties,\n} from '../../../../../../utils/sendAndWait/utils';\nimport { createUtmCampaignLink } from '../../../../../../utils/utilities';\nimport { chatRLC } from '../../descriptions';\nimport { microsoftApiRequest } from '../../transport';\n\nexport const description: INodeProperties[] = getSendAndWaitProperties(\n\t[chatRLC],\n\t'chatMessage',\n\tundefined,\n\t{\n\t\tnoButtonStyle: true,\n\t\tdefaultApproveLabel: '✓ Approve',\n\t\tdefaultDisapproveLabel: '✗ Decline',\n\t},\n).filter((p) => p.name !== 'subject');\n\nexport async function execute(this: IExecuteFunctions, i: number, instanceId: string) {\n\tconst chatId = this.getNodeParameter('chatId', i, '', { extractValue: true }) as string;\n\tconst config = getSendAndWaitConfig(this);\n\n\tconst buttons = config.options.map(\n\t\t(option) => `<a href=\"${config.url}?approved=${option.value}\">${option.label}</a>`,\n\t);\n\n\tlet content = `${config.message}<br><br>${buttons.join(' ')}`;\n\n\tif (config.appendAttribution !== false) {\n\t\tconst attributionText = 'This message was sent automatically with';\n\t\tconst link = createUtmCampaignLink('n8n-nodes-base.microsoftTeams', instanceId);\n\t\tconst attribution = `<em>${attributionText} <a href=\"${link}\">n8n</a></em>`;\n\t\tcontent += `<br><br>${attribution}`;\n\t}\n\n\tconst body = {\n\t\tbody: {\n\t\t\tcontentType: 'html',\n\t\t\tcontent,\n\t\t},\n\t};\n\n\treturn await microsoftApiRequest.call(this, 'POST', `/v1.0/chats/${chatId}/messages`, body);\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,mBAGO;AACP,uBAAsC;AACtC,0BAAwB;AACxB,uBAAoC;AAE7B,MAAM,kBAAiC;AAAA,EAC7C,CAAC,2BAAO;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,IACC,eAAe;AAAA,IACf,qBAAqB;AAAA,IACrB,wBAAwB;AAAA,EACzB;AACD,EAAE,OAAO,CAAC,MAAM,EAAE,SAAS,SAAS;AAEpC,eAAsB,QAAiC,GAAW,YAAoB;AACrF,QAAM,SAAS,KAAK,iBAAiB,UAAU,GAAG,IAAI,EAAE,cAAc,KAAK,CAAC;AAC5E,QAAM,aAAS,mCAAqB,IAAI;AAExC,QAAM,UAAU,OAAO,QAAQ;AAAA,IAC9B,CAAC,WAAW,YAAY,OAAO,GAAG,aAAa,OAAO,KAAK,KAAK,OAAO,KAAK;AAAA,EAC7E;AAEA,MAAI,UAAU,GAAG,OAAO,OAAO,WAAW,QAAQ,KAAK,GAAG,CAAC;AAE3D,MAAI,OAAO,sBAAsB,OAAO;AACvC,UAAM,kBAAkB;AACxB,UAAM,WAAO,wCAAsB,iCAAiC,UAAU;AAC9E,UAAM,cAAc,OAAO,eAAe,aAAa,IAAI;AAC3D,eAAW,WAAW,WAAW;AAAA,EAClC;AAEA,QAAM,OAAO;AAAA,IACZ,MAAM;AAAA,MACL,aAAa;AAAA,MACb;AAAA,IACD;AAAA,EACD;AAEA,SAAO,MAAM,qCAAoB,KAAK,MAAM,QAAQ,eAAe,MAAM,aAAa,IAAI;AAC3F;","names":[]}