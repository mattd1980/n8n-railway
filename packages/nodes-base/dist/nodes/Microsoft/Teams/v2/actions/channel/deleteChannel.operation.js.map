{"version":3,"sources":["../../../../../../../nodes/Microsoft/Teams/v2/actions/channel/deleteChannel.operation.ts"],"sourcesContent":["import { type INodeProperties, type IExecuteFunctions, NodeOperationError } from 'n8n-workflow';\n\nimport { updateDisplayOptions } from '@utils/utilities';\n\nimport { channelRLC, teamRLC } from '../../descriptions';\nimport { microsoftApiRequest } from '../../transport';\n\nconst properties: INodeProperties[] = [teamRLC, channelRLC];\n\nconst displayOptions = {\n\tshow: {\n\t\tresource: ['channel'],\n\t\toperation: ['deleteChannel'],\n\t},\n};\n\nexport const description = updateDisplayOptions(displayOptions, properties);\n\nexport async function execute(this: IExecuteFunctions, i: number) {\n\t//https://docs.microsoft.com/en-us/graph/api/channel-delete?view=graph-rest-beta&tabs=http\n\n\ttry {\n\t\tconst teamId = this.getNodeParameter('teamId', i, '', { extractValue: true }) as string;\n\t\tconst channelId = this.getNodeParameter('channelId', i, '', { extractValue: true }) as string;\n\n\t\tawait microsoftApiRequest.call(this, 'DELETE', `/v1.0/teams/${teamId}/channels/${channelId}`);\n\t\treturn { success: true };\n\t} catch (error) {\n\t\tthrow new NodeOperationError(\n\t\t\tthis.getNode(),\n\t\t\t\"The channel you are trying to delete doesn't exist\",\n\t\t\t{\n\t\t\t\tdescription: \"Check that the 'Channel' parameter is correctly set\",\n\t\t\t},\n\t\t);\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAiF;AAEjF,uBAAqC;AAErC,0BAAoC;AACpC,uBAAoC;AAEpC,MAAM,aAAgC,CAAC,6BAAS,8BAAU;AAE1D,MAAM,iBAAiB;AAAA,EACtB,MAAM;AAAA,IACL,UAAU,CAAC,SAAS;AAAA,IACpB,WAAW,CAAC,eAAe;AAAA,EAC5B;AACD;AAEO,MAAM,kBAAc,uCAAqB,gBAAgB,UAAU;AAE1E,eAAsB,QAAiC,GAAW;AAGjE,MAAI;AACH,UAAM,SAAS,KAAK,iBAAiB,UAAU,GAAG,IAAI,EAAE,cAAc,KAAK,CAAC;AAC5E,UAAM,YAAY,KAAK,iBAAiB,aAAa,GAAG,IAAI,EAAE,cAAc,KAAK,CAAC;AAElF,UAAM,qCAAoB,KAAK,MAAM,UAAU,eAAe,MAAM,aAAa,SAAS,EAAE;AAC5F,WAAO,EAAE,SAAS,KAAK;AAAA,EACxB,SAAS,OAAO;AACf,UAAM,IAAI;AAAA,MACT,KAAK,QAAQ;AAAA,MACb;AAAA,MACA;AAAA,QACC,aAAa;AAAA,MACd;AAAA,IACD;AAAA,EACD;AACD;","names":[]}