{"version":3,"sources":["../../../../../../../nodes/Microsoft/Teams/v2/actions/task/deleteTask.operation.ts"],"sourcesContent":["import type { INodeProperties, IExecuteFunctions } from 'n8n-workflow';\n\nimport { updateDisplayOptions } from '@utils/utilities';\n\nimport { microsoftApiRequest } from '../../transport';\n\nconst properties: INodeProperties[] = [\n\t{\n\t\tdisplayName: 'Task ID',\n\t\tname: 'taskId',\n\t\trequired: true,\n\t\ttype: 'string',\n\t\tplaceholder: 'e.g. h3ufgLvXPkSRzYm-zO5cY5gANtBQ',\n\t\tdescription: 'The ID of the task to delete',\n\t\tdefault: '',\n\t},\n];\n\nconst displayOptions = {\n\tshow: {\n\t\tresource: ['task'],\n\t\toperation: ['deleteTask'],\n\t},\n};\n\nexport const description = updateDisplayOptions(displayOptions, properties);\n\nexport async function execute(this: IExecuteFunctions, i: number) {\n\t//https://docs.microsoft.com/en-us/graph/api/plannertask-delete?view=graph-rest-1.0&tabs=http\n\n\tconst taskId = this.getNodeParameter('taskId', i) as string;\n\tconst task = await microsoftApiRequest.call(this, 'GET', `/v1.0/planner/tasks/${taskId}`);\n\tawait microsoftApiRequest.call(\n\t\tthis,\n\t\t'DELETE',\n\t\t`/v1.0/planner/tasks/${taskId}`,\n\t\t{},\n\t\t{},\n\t\tundefined,\n\t\t{ 'If-Match': task['@odata.etag'] },\n\t);\n\treturn { success: true };\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,uBAAqC;AAErC,uBAAoC;AAEpC,MAAM,aAAgC;AAAA,EACrC;AAAA,IACC,aAAa;AAAA,IACb,MAAM;AAAA,IACN,UAAU;AAAA,IACV,MAAM;AAAA,IACN,aAAa;AAAA,IACb,aAAa;AAAA,IACb,SAAS;AAAA,EACV;AACD;AAEA,MAAM,iBAAiB;AAAA,EACtB,MAAM;AAAA,IACL,UAAU,CAAC,MAAM;AAAA,IACjB,WAAW,CAAC,YAAY;AAAA,EACzB;AACD;AAEO,MAAM,kBAAc,uCAAqB,gBAAgB,UAAU;AAE1E,eAAsB,QAAiC,GAAW;AAGjE,QAAM,SAAS,KAAK,iBAAiB,UAAU,CAAC;AAChD,QAAM,OAAO,MAAM,qCAAoB,KAAK,MAAM,OAAO,uBAAuB,MAAM,EAAE;AACxF,QAAM,qCAAoB;AAAA,IACzB;AAAA,IACA;AAAA,IACA,uBAAuB,MAAM;AAAA,IAC7B,CAAC;AAAA,IACD,CAAC;AAAA,IACD;AAAA,IACA,EAAE,YAAY,KAAK,aAAa,EAAE;AAAA,EACnC;AACA,SAAO,EAAE,SAAS,KAAK;AACxB;","names":[]}