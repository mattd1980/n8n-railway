{"version":3,"sources":["../../../../../../../nodes/Microsoft/Teams/v2/actions/chatMessage/getAll.operation.ts"],"sourcesContent":["import type { INodeProperties, IExecuteFunctions } from 'n8n-workflow';\n\nimport { returnAllOrLimit } from '@utils/descriptions';\nimport { updateDisplayOptions } from '@utils/utilities';\n\nimport { chatRLC } from '../../descriptions';\nimport { microsoftApiRequestAllItems } from '../../transport';\n\nconst properties: INodeProperties[] = [chatRLC, ...returnAllOrLimit];\n\nconst displayOptions = {\n\tshow: {\n\t\tresource: ['chatMessage'],\n\t\toperation: ['getAll'],\n\t},\n};\n\nexport const description = updateDisplayOptions(displayOptions, properties);\n\nexport async function execute(this: IExecuteFunctions, i: number) {\n\t// https://docs.microsoft.com/en-us/graph/api/chat-list-messages?view=graph-rest-1.0&tabs=http\n\n\tconst chatId = this.getNodeParameter('chatId', i, '', { extractValue: true }) as string;\n\tconst returnAll = this.getNodeParameter('returnAll', i);\n\n\tif (returnAll) {\n\t\treturn await microsoftApiRequestAllItems.call(\n\t\t\tthis,\n\t\t\t'value',\n\t\t\t'GET',\n\t\t\t`/v1.0/chats/${chatId}/messages`,\n\t\t);\n\t} else {\n\t\tconst limit = this.getNodeParameter('limit', i);\n\t\tconst responseData = await microsoftApiRequestAllItems.call(\n\t\t\tthis,\n\t\t\t'value',\n\t\t\t'GET',\n\t\t\t`/v1.0/chats/${chatId}/messages`,\n\t\t\t{},\n\t\t);\n\t\treturn responseData.splice(0, limit);\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,0BAAiC;AACjC,uBAAqC;AAErC,IAAAA,uBAAwB;AACxB,uBAA4C;AAE5C,MAAM,aAAgC,CAAC,8BAAS,GAAG,oCAAgB;AAEnE,MAAM,iBAAiB;AAAA,EACtB,MAAM;AAAA,IACL,UAAU,CAAC,aAAa;AAAA,IACxB,WAAW,CAAC,QAAQ;AAAA,EACrB;AACD;AAEO,MAAM,kBAAc,uCAAqB,gBAAgB,UAAU;AAE1E,eAAsB,QAAiC,GAAW;AAGjE,QAAM,SAAS,KAAK,iBAAiB,UAAU,GAAG,IAAI,EAAE,cAAc,KAAK,CAAC;AAC5E,QAAM,YAAY,KAAK,iBAAiB,aAAa,CAAC;AAEtD,MAAI,WAAW;AACd,WAAO,MAAM,6CAA4B;AAAA,MACxC;AAAA,MACA;AAAA,MACA;AAAA,MACA,eAAe,MAAM;AAAA,IACtB;AAAA,EACD,OAAO;AACN,UAAM,QAAQ,KAAK,iBAAiB,SAAS,CAAC;AAC9C,UAAM,eAAe,MAAM,6CAA4B;AAAA,MACtD;AAAA,MACA;AAAA,MACA;AAAA,MACA,eAAe,MAAM;AAAA,MACrB,CAAC;AAAA,IACF;AACA,WAAO,aAAa,OAAO,GAAG,KAAK;AAAA,EACpC;AACD;","names":["import_descriptions"]}