{"version":3,"sources":["../../../../../../nodes/Microsoft/Outlook/v2/actions/router.ts"],"sourcesContent":["import type { IExecuteFunctions, INodeExecutionData } from 'n8n-workflow';\nimport { NodeApiError, NodeOperationError, SEND_AND_WAIT_OPERATION } from 'n8n-workflow';\n\nimport * as calendar from './calendar';\nimport * as contact from './contact';\nimport * as draft from './draft';\nimport * as event from './event';\nimport * as folder from './folder';\nimport * as folderMessage from './folderMessage';\nimport * as message from './message';\nimport * as messageAttachment from './messageAttachment';\nimport type { MicrosoftOutlook } from './node.type';\nimport { configureWaitTillDate } from '../../../../../utils/sendAndWait/configureWaitTillDate.util';\n\nexport async function router(this: IExecuteFunctions) {\n\tconst items = this.getInputData();\n\tconst returnData: INodeExecutionData[] = [];\n\n\tconst resource = this.getNodeParameter<MicrosoftOutlook>('resource', 0) as string;\n\tconst operation = this.getNodeParameter('operation', 0);\n\n\tlet responseData;\n\n\tconst microsoftOutlook = {\n\t\tresource,\n\t\toperation,\n\t} as MicrosoftOutlook;\n\n\tif (\n\t\tmicrosoftOutlook.resource === 'message' &&\n\t\tmicrosoftOutlook.operation === SEND_AND_WAIT_OPERATION\n\t) {\n\t\tawait message[microsoftOutlook.operation].execute.call(this, 0, items);\n\n\t\tconst waitTill = configureWaitTillDate(this);\n\n\t\tawait this.putExecutionToWait(waitTill);\n\t\treturn [items];\n\t}\n\n\tfor (let i = 0; i < items.length; i++) {\n\t\ttry {\n\t\t\tswitch (microsoftOutlook.resource) {\n\t\t\t\tcase 'calendar':\n\t\t\t\t\tresponseData = await calendar[microsoftOutlook.operation].execute.call(this, i);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'contact':\n\t\t\t\t\tresponseData = await contact[microsoftOutlook.operation].execute.call(this, i);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'draft':\n\t\t\t\t\tresponseData = await draft[microsoftOutlook.operation].execute.call(this, i, items);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'event':\n\t\t\t\t\tresponseData = await event[microsoftOutlook.operation].execute.call(this, i);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'folder':\n\t\t\t\t\tresponseData = await folder[microsoftOutlook.operation].execute.call(this, i);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'folderMessage':\n\t\t\t\t\tresponseData = await folderMessage[microsoftOutlook.operation].execute.call(this, i);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'message':\n\t\t\t\t\tresponseData = await message[microsoftOutlook.operation].execute.call(this, i, items);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'messageAttachment':\n\t\t\t\t\tresponseData = await messageAttachment[microsoftOutlook.operation].execute.call(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\ti,\n\t\t\t\t\t\titems,\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new NodeOperationError(this.getNode(), `The resource \"${resource}\" is not known`);\n\t\t\t}\n\n\t\t\treturnData.push(...responseData);\n\t\t} catch (error) {\n\t\t\tif (this.continueOnFail()) {\n\t\t\t\tconst executionErrorData = this.helpers.constructExecutionMetaData(\n\t\t\t\t\tthis.helpers.returnJsonArray({ error: error.message }),\n\t\t\t\t\t{ itemData: { item: i } },\n\t\t\t\t);\n\t\t\t\treturnData.push(...executionErrorData);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t//NodeApiError will be missing the itemIndex, add it\n\t\t\tif (error instanceof NodeApiError && error?.context?.itemIndex === undefined) {\n\t\t\t\tif (error.context === undefined) {\n\t\t\t\t\terror.context = {};\n\t\t\t\t}\n\t\t\t\terror.context.itemIndex = i;\n\t\t\t}\n\t\t\tthrow error;\n\t\t}\n\t}\n\treturn [returnData];\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,0BAA0E;AAE1E,eAA0B;AAC1B,cAAyB;AACzB,YAAuB;AACvB,YAAuB;AACvB,aAAwB;AACxB,oBAA+B;AAC/B,cAAyB;AACzB,wBAAmC;AAEnC,mCAAsC;AAEtC,eAAsB,SAAgC;AACrD,QAAM,QAAQ,KAAK,aAAa;AAChC,QAAM,aAAmC,CAAC;AAE1C,QAAM,WAAW,KAAK,iBAAmC,YAAY,CAAC;AACtE,QAAM,YAAY,KAAK,iBAAiB,aAAa,CAAC;AAEtD,MAAI;AAEJ,QAAM,mBAAmB;AAAA,IACxB;AAAA,IACA;AAAA,EACD;AAEA,MACC,iBAAiB,aAAa,aAC9B,iBAAiB,cAAc,6CAC9B;AACD,UAAM,QAAQ,iBAAiB,SAAS,EAAE,QAAQ,KAAK,MAAM,GAAG,KAAK;AAErE,UAAM,eAAW,oDAAsB,IAAI;AAE3C,UAAM,KAAK,mBAAmB,QAAQ;AACtC,WAAO,CAAC,KAAK;AAAA,EACd;AAEA,WAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACtC,QAAI;AACH,cAAQ,iBAAiB,UAAU;AAAA,QAClC,KAAK;AACJ,yBAAe,MAAM,SAAS,iBAAiB,SAAS,EAAE,QAAQ,KAAK,MAAM,CAAC;AAC9E;AAAA,QACD,KAAK;AACJ,yBAAe,MAAM,QAAQ,iBAAiB,SAAS,EAAE,QAAQ,KAAK,MAAM,CAAC;AAC7E;AAAA,QACD,KAAK;AACJ,yBAAe,MAAM,MAAM,iBAAiB,SAAS,EAAE,QAAQ,KAAK,MAAM,GAAG,KAAK;AAClF;AAAA,QACD,KAAK;AACJ,yBAAe,MAAM,MAAM,iBAAiB,SAAS,EAAE,QAAQ,KAAK,MAAM,CAAC;AAC3E;AAAA,QACD,KAAK;AACJ,yBAAe,MAAM,OAAO,iBAAiB,SAAS,EAAE,QAAQ,KAAK,MAAM,CAAC;AAC5E;AAAA,QACD,KAAK;AACJ,yBAAe,MAAM,cAAc,iBAAiB,SAAS,EAAE,QAAQ,KAAK,MAAM,CAAC;AACnF;AAAA,QACD,KAAK;AACJ,yBAAe,MAAM,QAAQ,iBAAiB,SAAS,EAAE,QAAQ,KAAK,MAAM,GAAG,KAAK;AACpF;AAAA,QACD,KAAK;AACJ,yBAAe,MAAM,kBAAkB,iBAAiB,SAAS,EAAE,QAAQ;AAAA,YAC1E;AAAA,YACA;AAAA,YACA;AAAA,UACD;AACA;AAAA,QACD;AACC,gBAAM,IAAI,uCAAmB,KAAK,QAAQ,GAAG,iBAAiB,QAAQ,gBAAgB;AAAA,MACxF;AAEA,iBAAW,KAAK,GAAG,YAAY;AAAA,IAChC,SAAS,OAAO;AACf,UAAI,KAAK,eAAe,GAAG;AAC1B,cAAM,qBAAqB,KAAK,QAAQ;AAAA,UACvC,KAAK,QAAQ,gBAAgB,EAAE,OAAO,MAAM,QAAQ,CAAC;AAAA,UACrD,EAAE,UAAU,EAAE,MAAM,EAAE,EAAE;AAAA,QACzB;AACA,mBAAW,KAAK,GAAG,kBAAkB;AACrC;AAAA,MACD;AAEA,UAAI,iBAAiB,oCAAgB,OAAO,SAAS,cAAc,QAAW;AAC7E,YAAI,MAAM,YAAY,QAAW;AAChC,gBAAM,UAAU,CAAC;AAAA,QAClB;AACA,cAAM,QAAQ,YAAY;AAAA,MAC3B;AACA,YAAM;AAAA,IACP;AAAA,EACD;AACA,SAAO,CAAC,UAAU;AACnB;","names":[]}