{"version":3,"sources":["../../../../../../../nodes/Microsoft/Outlook/v2/actions/message/sendAndWait.operation.ts"],"sourcesContent":["import type {\n\tIDataObject,\n\tIExecuteFunctions,\n\tINodeExecutionData,\n\tINodeProperties,\n} from 'n8n-workflow';\n\nimport {\n\tcreateEmailBodyWithN8nAttribution,\n\tcreateEmailBodyWithoutN8nAttribution,\n} from '../../../../../../utils/sendAndWait/email-templates';\nimport {\n\tgetSendAndWaitConfig,\n\tgetSendAndWaitProperties,\n\tcreateButton,\n} from '../../../../../../utils/sendAndWait/utils';\nimport { createMessage } from '../../helpers/utils';\nimport { microsoftApiRequest } from '../../transport';\n\nexport const description: INodeProperties[] = getSendAndWaitProperties([\n\t{\n\t\tdisplayName: 'To',\n\t\tname: 'toRecipients',\n\t\tdescription: 'Comma-separated list of email addresses of recipients',\n\t\ttype: 'string',\n\t\trequired: true,\n\t\tdefault: '',\n\t},\n]);\n\nexport async function execute(this: IExecuteFunctions, index: number, items: INodeExecutionData[]) {\n\tconst toRecipients = this.getNodeParameter('toRecipients', index) as string;\n\n\tconst config = getSendAndWaitConfig(this);\n\tconst buttons: string[] = [];\n\tfor (const option of config.options) {\n\t\tbuttons.push(createButton(config.url, option.label, option.value, option.style));\n\t}\n\n\tlet bodyContent: string;\n\tif (config.appendAttribution !== false) {\n\t\tconst instanceId = this.getInstanceId();\n\t\tbodyContent = createEmailBodyWithN8nAttribution(config.message, buttons.join('\\n'), instanceId);\n\t} else {\n\t\tbodyContent = createEmailBodyWithoutN8nAttribution(config.message, buttons.join('\\n'));\n\t}\n\n\tconst fields: IDataObject = {\n\t\tsubject: config.title,\n\t\tbodyContent,\n\t\ttoRecipients,\n\t\tbodyContentType: 'html',\n\t};\n\n\tconst message: IDataObject = createMessage(fields);\n\n\tconst body: IDataObject = { message };\n\n\tawait microsoftApiRequest.call(this, 'POST', '/sendMail', body);\n\n\treturn items;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA,6BAGO;AACP,mBAIO;AACP,IAAAA,gBAA8B;AAC9B,uBAAoC;AAE7B,MAAM,kBAAiC,uCAAyB;AAAA,EACtE;AAAA,IACC,aAAa;AAAA,IACb,MAAM;AAAA,IACN,aAAa;AAAA,IACb,MAAM;AAAA,IACN,UAAU;AAAA,IACV,SAAS;AAAA,EACV;AACD,CAAC;AAED,eAAsB,QAAiC,OAAe,OAA6B;AAClG,QAAM,eAAe,KAAK,iBAAiB,gBAAgB,KAAK;AAEhE,QAAM,aAAS,mCAAqB,IAAI;AACxC,QAAM,UAAoB,CAAC;AAC3B,aAAW,UAAU,OAAO,SAAS;AACpC,YAAQ,SAAK,2BAAa,OAAO,KAAK,OAAO,OAAO,OAAO,OAAO,OAAO,KAAK,CAAC;AAAA,EAChF;AAEA,MAAI;AACJ,MAAI,OAAO,sBAAsB,OAAO;AACvC,UAAM,aAAa,KAAK,cAAc;AACtC,sBAAc,0DAAkC,OAAO,SAAS,QAAQ,KAAK,IAAI,GAAG,UAAU;AAAA,EAC/F,OAAO;AACN,sBAAc,6DAAqC,OAAO,SAAS,QAAQ,KAAK,IAAI,CAAC;AAAA,EACtF;AAEA,QAAM,SAAsB;AAAA,IAC3B,SAAS,OAAO;AAAA,IAChB;AAAA,IACA;AAAA,IACA,iBAAiB;AAAA,EAClB;AAEA,QAAM,cAAuB,6BAAc,MAAM;AAEjD,QAAM,OAAoB,EAAE,QAAQ;AAEpC,QAAM,qCAAoB,KAAK,MAAM,QAAQ,aAAa,IAAI;AAE9D,SAAO;AACR;","names":["import_utils"]}