{"version":3,"sources":["../../../nodes/Interval/Interval.node.ts"],"sourcesContent":["import type {\n\tITriggerFunctions,\n\tINodeType,\n\tINodeTypeDescription,\n\tITriggerResponse,\n} from 'n8n-workflow';\nimport { NodeConnectionTypes, NodeOperationError } from 'n8n-workflow';\n\nexport class Interval implements INodeType {\n\tdescription: INodeTypeDescription = {\n\t\tdisplayName: 'Interval',\n\t\tname: 'interval',\n\t\ticon: 'fa:hourglass',\n\t\tgroup: ['trigger', 'schedule'],\n\t\tversion: 1,\n\t\thidden: true,\n\t\tdescription: 'Triggers the workflow in a given interval',\n\t\teventTriggerDescription: '',\n\t\tactivationMessage:\n\t\t\t'Your interval trigger will now trigger executions on the schedule you have defined.',\n\t\tdefaults: {\n\t\t\tname: 'Interval',\n\t\t\tcolor: '#00FF00',\n\t\t},\n\n\t\tinputs: [],\n\t\toutputs: [NodeConnectionTypes.Main],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tdisplayName:\n\t\t\t\t\t'This workflow will run on the schedule you define here once you <a data-key=\"activate\">activate</a> it.<br><br>For testing, you can also trigger it manually: by going back to the canvas and clicking \\'execute workflow\\'',\n\t\t\t\tname: 'notice',\n\t\t\t\ttype: 'notice',\n\t\t\t\tdefault: '',\n\t\t\t},\n\t\t\t{\n\t\t\t\tdisplayName: 'Interval',\n\t\t\t\tname: 'interval',\n\t\t\t\ttype: 'number',\n\t\t\t\ttypeOptions: {\n\t\t\t\t\tminValue: 1,\n\t\t\t\t},\n\t\t\t\tdefault: 1,\n\t\t\t\tdescription: 'Interval value',\n\t\t\t},\n\t\t\t{\n\t\t\t\tdisplayName: 'Unit',\n\t\t\t\tname: 'unit',\n\t\t\t\ttype: 'options',\n\t\t\t\toptions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Seconds',\n\t\t\t\t\t\tvalue: 'seconds',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Minutes',\n\t\t\t\t\t\tvalue: 'minutes',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Hours',\n\t\t\t\t\t\tvalue: 'hours',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tdefault: 'seconds',\n\t\t\t\tdescription: 'Unit of the interval value',\n\t\t\t},\n\t\t],\n\t};\n\n\tasync trigger(this: ITriggerFunctions): Promise<ITriggerResponse> {\n\t\tconst interval = this.getNodeParameter('interval') as number;\n\t\tconst unit = this.getNodeParameter('unit') as string;\n\n\t\tif (interval <= 0) {\n\t\t\tthrow new NodeOperationError(\n\t\t\t\tthis.getNode(),\n\t\t\t\t'The interval has to be set to at least 1 or higher!',\n\t\t\t);\n\t\t}\n\n\t\tlet intervalValue = interval;\n\t\tif (unit === 'minutes') {\n\t\t\tintervalValue *= 60;\n\t\t}\n\t\tif (unit === 'hours') {\n\t\t\tintervalValue *= 60 * 60;\n\t\t}\n\n\t\tconst executeTrigger = () => {\n\t\t\tthis.emit([this.helpers.returnJsonArray([{}])]);\n\t\t};\n\n\t\tintervalValue *= 1000;\n\n\t\t// Reference: https://nodejs.org/api/timers.html#timers_setinterval_callback_delay_args\n\t\tif (intervalValue > 2147483647) {\n\t\t\tthrow new NodeOperationError(this.getNode(), 'The interval value is too large.');\n\t\t}\n\n\t\tconst intervalObj = setInterval(executeTrigger, intervalValue);\n\n\t\tasync function closeFunction() {\n\t\t\tclearInterval(intervalObj);\n\t\t}\n\n\t\tasync function manualTriggerFunction() {\n\t\t\texecuteTrigger();\n\t\t}\n\n\t\treturn {\n\t\t\tcloseFunction,\n\t\t\tmanualTriggerFunction,\n\t\t};\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA,0BAAwD;AAEjD,MAAM,SAA8B;AAAA,EAApC;AACN,uBAAoC;AAAA,MACnC,aAAa;AAAA,MACb,MAAM;AAAA,MACN,MAAM;AAAA,MACN,OAAO,CAAC,WAAW,UAAU;AAAA,MAC7B,SAAS;AAAA,MACT,QAAQ;AAAA,MACR,aAAa;AAAA,MACb,yBAAyB;AAAA,MACzB,mBACC;AAAA,MACD,UAAU;AAAA,QACT,MAAM;AAAA,QACN,OAAO;AAAA,MACR;AAAA,MAEA,QAAQ,CAAC;AAAA,MACT,SAAS,CAAC,wCAAoB,IAAI;AAAA,MAClC,YAAY;AAAA,QACX;AAAA,UACC,aACC;AAAA,UACD,MAAM;AAAA,UACN,MAAM;AAAA,UACN,SAAS;AAAA,QACV;AAAA,QACA;AAAA,UACC,aAAa;AAAA,UACb,MAAM;AAAA,UACN,MAAM;AAAA,UACN,aAAa;AAAA,YACZ,UAAU;AAAA,UACX;AAAA,UACA,SAAS;AAAA,UACT,aAAa;AAAA,QACd;AAAA,QACA;AAAA,UACC,aAAa;AAAA,UACb,MAAM;AAAA,UACN,MAAM;AAAA,UACN,SAAS;AAAA,YACR;AAAA,cACC,MAAM;AAAA,cACN,OAAO;AAAA,YACR;AAAA,YACA;AAAA,cACC,MAAM;AAAA,cACN,OAAO;AAAA,YACR;AAAA,YACA;AAAA,cACC,MAAM;AAAA,cACN,OAAO;AAAA,YACR;AAAA,UACD;AAAA,UACA,SAAS;AAAA,UACT,aAAa;AAAA,QACd;AAAA,MACD;AAAA,IACD;AAAA;AAAA,EAEA,MAAM,UAA4D;AACjE,UAAM,WAAW,KAAK,iBAAiB,UAAU;AACjD,UAAM,OAAO,KAAK,iBAAiB,MAAM;AAEzC,QAAI,YAAY,GAAG;AAClB,YAAM,IAAI;AAAA,QACT,KAAK,QAAQ;AAAA,QACb;AAAA,MACD;AAAA,IACD;AAEA,QAAI,gBAAgB;AACpB,QAAI,SAAS,WAAW;AACvB,uBAAiB;AAAA,IAClB;AACA,QAAI,SAAS,SAAS;AACrB,uBAAiB,KAAK;AAAA,IACvB;AAEA,UAAM,iBAAiB,MAAM;AAC5B,WAAK,KAAK,CAAC,KAAK,QAAQ,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AAAA,IAC/C;AAEA,qBAAiB;AAGjB,QAAI,gBAAgB,YAAY;AAC/B,YAAM,IAAI,uCAAmB,KAAK,QAAQ,GAAG,kCAAkC;AAAA,IAChF;AAEA,UAAM,cAAc,YAAY,gBAAgB,aAAa;AAE7D,mBAAe,gBAAgB;AAC9B,oBAAc,WAAW;AAAA,IAC1B;AAEA,mBAAe,wBAAwB;AACtC,qBAAe;AAAA,IAChB;AAEA,WAAO;AAAA,MACN;AAAA,MACA;AAAA,IACD;AAAA,EACD;AACD;","names":[]}