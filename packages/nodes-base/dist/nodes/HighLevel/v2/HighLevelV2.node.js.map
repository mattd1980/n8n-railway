{"version":3,"sources":["../../../../nodes/HighLevel/v2/HighLevelV2.node.ts"],"sourcesContent":["import type {\n\tIDataObject,\n\tILoadOptionsFunctions,\n\tINodeListSearchItems,\n\tINodeListSearchResult,\n\tINodeProperties,\n\tINodeType,\n\tINodeTypeBaseDescription,\n\tINodeTypeDescription,\n} from 'n8n-workflow';\nimport { NodeConnectionTypes } from 'n8n-workflow';\n\nimport { calendarFields, calendarOperations } from './description/CalendarDescription';\nimport { contactFields, contactNotes, contactOperations } from './description/ContactDescription';\nimport { opportunityFields, opportunityOperations } from './description/OpportunityDescription';\nimport { taskFields, taskOperations } from './description/TaskDescription';\nimport {\n\tgetContacts,\n\tgetPipelines,\n\tgetPipelineStages,\n\tgetUsers,\n\thighLevelApiPagination,\n} from './GenericFunctions';\n\nconst resources: INodeProperties[] = [\n\t{\n\t\tdisplayName: 'Resource',\n\t\tname: 'resource',\n\t\ttype: 'options',\n\t\tnoDataExpression: true,\n\t\toptions: [\n\t\t\t{\n\t\t\t\tname: 'Contact',\n\t\t\t\tvalue: 'contact',\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'Opportunity',\n\t\t\t\tvalue: 'opportunity',\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'Task',\n\t\t\t\tvalue: 'task',\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'Calendar',\n\t\t\t\tvalue: 'calendar',\n\t\t\t},\n\t\t],\n\t\tdefault: 'contact',\n\t\trequired: true,\n\t},\n];\n\nconst versionDescription: INodeTypeDescription = {\n\tdisplayName: 'HighLevel',\n\tname: 'highLevel',\n\ticon: 'file:highLevel.svg',\n\tgroup: ['transform'],\n\tversion: 2,\n\tdescription: 'Consume HighLevel API v2',\n\tsubtitle: '={{$parameter[\"operation\"] + \": \" + $parameter[\"resource\"]}}',\n\tdefaults: {\n\t\tname: 'HighLevel',\n\t},\n\tusableAsTool: true,\n\tinputs: [NodeConnectionTypes.Main],\n\toutputs: [NodeConnectionTypes.Main],\n\tcredentials: [\n\t\t{\n\t\t\tname: 'highLevelOAuth2Api',\n\t\t\trequired: true,\n\t\t},\n\t],\n\trequestDefaults: {\n\t\tbaseURL: 'https://services.leadconnectorhq.com',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tVersion: '2021-07-28',\n\t\t},\n\t},\n\trequestOperations: {\n\t\tpagination: highLevelApiPagination,\n\t},\n\tproperties: [\n\t\t...resources,\n\t\t...contactOperations,\n\t\t...contactNotes,\n\t\t...contactFields,\n\t\t...opportunityOperations,\n\t\t...opportunityFields,\n\t\t...taskOperations,\n\t\t...taskFields,\n\t\t...calendarOperations,\n\t\t...calendarFields,\n\t],\n};\n\nexport class HighLevelV2 implements INodeType {\n\tdescription: INodeTypeDescription;\n\n\tconstructor(baseDescription: INodeTypeBaseDescription) {\n\t\tthis.description = {\n\t\t\t...baseDescription,\n\t\t\t...versionDescription,\n\t\t};\n\t}\n\n\tmethods = {\n\t\tloadOptions: {\n\t\t\tgetPipelines,\n\t\t\tgetContacts,\n\t\t\tgetPipelineStages,\n\t\t\tgetUsers,\n\t\t},\n\t\tlistSearch: {\n\t\t\tasync searchCustomFields(\n\t\t\t\tthis: ILoadOptionsFunctions,\n\t\t\t\tfilter?: string,\n\t\t\t): Promise<INodeListSearchResult> {\n\t\t\t\tconst { locationId } =\n\t\t\t\t\t((await this.getCredentials('highLevelOAuth2Api'))?.oauthTokenData as IDataObject) ?? {};\n\n\t\t\t\tconst responseData: IDataObject = (await this.helpers.httpRequestWithAuthentication.call(\n\t\t\t\t\tthis,\n\t\t\t\t\t'highLevelOAuth2Api',\n\t\t\t\t\t{\n\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n\t\t\t\t\t\turl: `https://services.leadconnectorhq.com/locations/${locationId}/customFields?model=contact`,\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\tAccept: 'application/json',\n\t\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\t\tVersion: '2021-07-28',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t)) as IDataObject;\n\n\t\t\t\tconst customFields = responseData.customFields as Array<{ name: string; id: string }>;\n\n\t\t\t\tconst results: INodeListSearchItems[] = customFields\n\t\t\t\t\t.map((a) => ({\n\t\t\t\t\t\tname: a.name,\n\t\t\t\t\t\tvalue: a.id,\n\t\t\t\t\t}))\n\t\t\t\t\t.filter((a) => !filter || a.name.toLowerCase().includes(filter.toLowerCase()))\n\t\t\t\t\t.sort((a, b) => {\n\t\t\t\t\t\tif (a.name.toLowerCase() < b.name.toLowerCase()) return -1;\n\t\t\t\t\t\tif (a.name.toLowerCase() > b.name.toLowerCase()) return 1;\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t});\n\n\t\t\t\treturn { results };\n\t\t\t},\n\t\t\tasync searchTimezones(\n\t\t\t\tthis: ILoadOptionsFunctions,\n\t\t\t\tfilter?: string,\n\t\t\t): Promise<INodeListSearchResult> {\n\t\t\t\tconst { locationId } =\n\t\t\t\t\t((await this.getCredentials('highLevelOAuth2Api'))?.oauthTokenData as IDataObject) ?? {};\n\n\t\t\t\tconst responseData: IDataObject = (await this.helpers.httpRequestWithAuthentication.call(\n\t\t\t\t\tthis,\n\t\t\t\t\t'highLevelOAuth2Api',\n\t\t\t\t\t{\n\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n\t\t\t\t\t\turl: `https://services.leadconnectorhq.com/locations/${locationId}/timezones`,\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\tAccept: 'application/json',\n\t\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\t\tVersion: '2021-07-28',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t)) as IDataObject;\n\n\t\t\t\tconst timezones = responseData.timeZones as string[];\n\n\t\t\t\tconst results: INodeListSearchItems[] = timezones\n\t\t\t\t\t.map((zone) => ({\n\t\t\t\t\t\tname: zone.trim(),\n\t\t\t\t\t\tvalue: zone.trim(),\n\t\t\t\t\t}))\n\t\t\t\t\t.filter((zone) => !filter || zone.name.toLowerCase().includes(filter.toLowerCase()))\n\t\t\t\t\t.sort((a, b) => {\n\t\t\t\t\t\tif (a.name.toLowerCase() < b.name.toLowerCase()) return -1;\n\t\t\t\t\t\tif (a.name.toLowerCase() > b.name.toLowerCase()) return 1;\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t});\n\n\t\t\t\treturn { results };\n\t\t\t},\n\t\t},\n\t};\n}\n"],"mappings":"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","names":[]}