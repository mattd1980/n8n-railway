{"version":3,"sources":["../../../nodes/ReadBinaryFile/ReadBinaryFile.node.ts"],"sourcesContent":["import {\n\tNodeConnectionTypes,\n\ttype IExecuteFunctions,\n\ttype INodeExecutionData,\n\ttype INodeType,\n\ttype INodeTypeDescription,\n} from 'n8n-workflow';\n\nexport class ReadBinaryFile implements INodeType {\n\tdescription: INodeTypeDescription = {\n\t\tdisplayName: 'Read Binary File',\n\t\tname: 'readBinaryFile',\n\t\ticon: 'fa:file-import',\n\t\tgroup: ['input'],\n\t\tversion: 1,\n\t\thidden: true,\n\t\tdescription: 'Reads a binary file from disk',\n\t\tdefaults: {\n\t\t\tname: 'Read Binary File',\n\t\t\tcolor: '#449922',\n\t\t},\n\t\tinputs: [NodeConnectionTypes.Main],\n\t\toutputs: [NodeConnectionTypes.Main],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tdisplayName: 'File Path',\n\t\t\t\tname: 'filePath',\n\t\t\t\ttype: 'string',\n\t\t\t\tdefault: '',\n\t\t\t\trequired: true,\n\t\t\t\tplaceholder: '/data/example.jpg',\n\t\t\t\tdescription: 'Path of the file to read',\n\t\t\t},\n\t\t\t{\n\t\t\t\tdisplayName: 'Property Name',\n\t\t\t\tname: 'dataPropertyName',\n\t\t\t\ttype: 'string',\n\t\t\t\tdefault: 'data',\n\t\t\t\trequired: true,\n\t\t\t\tdescription: 'Name of the binary property to which to write the data of the read file',\n\t\t\t},\n\t\t],\n\t};\n\n\tasync execute(this: IExecuteFunctions): Promise<INodeExecutionData[][]> {\n\t\tconst items = this.getInputData();\n\n\t\tconst returnData: INodeExecutionData[] = [];\n\t\tconst length = items.length;\n\t\tlet item: INodeExecutionData;\n\n\t\tfor (let itemIndex = 0; itemIndex < length; itemIndex++) {\n\t\t\ttry {\n\t\t\t\titem = items[itemIndex];\n\t\t\t\tconst newItem: INodeExecutionData = {\n\t\t\t\t\tjson: item.json,\n\t\t\t\t\tbinary: {},\n\t\t\t\t\tpairedItem: {\n\t\t\t\t\t\titem: itemIndex,\n\t\t\t\t\t},\n\t\t\t\t};\n\n\t\t\t\tif (item.binary !== undefined && newItem.binary) {\n\t\t\t\t\t// Create a shallow copy of the binary data so that the old\n\t\t\t\t\t// data references which do not get changed still stay behind\n\t\t\t\t\t// but the incoming data does not get changed.\n\t\t\t\t\tObject.assign(newItem.binary, item.binary);\n\t\t\t\t}\n\n\t\t\t\tconst filePath = this.getNodeParameter('filePath', itemIndex);\n\n\t\t\t\tconst stream = await this.helpers.createReadStream(filePath);\n\t\t\t\tconst dataPropertyName = this.getNodeParameter('dataPropertyName', itemIndex);\n\n\t\t\t\tnewItem.binary![dataPropertyName] = await this.helpers.prepareBinaryData(stream, filePath);\n\t\t\t\treturnData.push(newItem);\n\t\t\t} catch (error) {\n\t\t\t\tif (this.continueOnFail()) {\n\t\t\t\t\treturnData.push({\n\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\terror: (error as Error).message,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tpairedItem: {\n\t\t\t\t\t\t\titem: itemIndex,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\n\t\treturn [returnData];\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAMO;AAEA,MAAM,eAAoC;AAAA,EAA1C;AACN,uBAAoC;AAAA,MACnC,aAAa;AAAA,MACb,MAAM;AAAA,MACN,MAAM;AAAA,MACN,OAAO,CAAC,OAAO;AAAA,MACf,SAAS;AAAA,MACT,QAAQ;AAAA,MACR,aAAa;AAAA,MACb,UAAU;AAAA,QACT,MAAM;AAAA,QACN,OAAO;AAAA,MACR;AAAA,MACA,QAAQ,CAAC,wCAAoB,IAAI;AAAA,MACjC,SAAS,CAAC,wCAAoB,IAAI;AAAA,MAClC,YAAY;AAAA,QACX;AAAA,UACC,aAAa;AAAA,UACb,MAAM;AAAA,UACN,MAAM;AAAA,UACN,SAAS;AAAA,UACT,UAAU;AAAA,UACV,aAAa;AAAA,UACb,aAAa;AAAA,QACd;AAAA,QACA;AAAA,UACC,aAAa;AAAA,UACb,MAAM;AAAA,UACN,MAAM;AAAA,UACN,SAAS;AAAA,UACT,UAAU;AAAA,UACV,aAAa;AAAA,QACd;AAAA,MACD;AAAA,IACD;AAAA;AAAA,EAEA,MAAM,UAAkE;AACvE,UAAM,QAAQ,KAAK,aAAa;AAEhC,UAAM,aAAmC,CAAC;AAC1C,UAAM,SAAS,MAAM;AACrB,QAAI;AAEJ,aAAS,YAAY,GAAG,YAAY,QAAQ,aAAa;AACxD,UAAI;AACH,eAAO,MAAM,SAAS;AACtB,cAAM,UAA8B;AAAA,UACnC,MAAM,KAAK;AAAA,UACX,QAAQ,CAAC;AAAA,UACT,YAAY;AAAA,YACX,MAAM;AAAA,UACP;AAAA,QACD;AAEA,YAAI,KAAK,WAAW,UAAa,QAAQ,QAAQ;AAIhD,iBAAO,OAAO,QAAQ,QAAQ,KAAK,MAAM;AAAA,QAC1C;AAEA,cAAM,WAAW,KAAK,iBAAiB,YAAY,SAAS;AAE5D,cAAM,SAAS,MAAM,KAAK,QAAQ,iBAAiB,QAAQ;AAC3D,cAAM,mBAAmB,KAAK,iBAAiB,oBAAoB,SAAS;AAE5E,gBAAQ,OAAQ,gBAAgB,IAAI,MAAM,KAAK,QAAQ,kBAAkB,QAAQ,QAAQ;AACzF,mBAAW,KAAK,OAAO;AAAA,MACxB,SAAS,OAAO;AACf,YAAI,KAAK,eAAe,GAAG;AAC1B,qBAAW,KAAK;AAAA,YACf,MAAM;AAAA,cACL,OAAQ,MAAgB;AAAA,YACzB;AAAA,YACA,YAAY;AAAA,cACX,MAAM;AAAA,YACP;AAAA,UACD,CAAC;AACD;AAAA,QACD;AACA,cAAM;AAAA,MACP;AAAA,IACD;AAEA,WAAO,CAAC,UAAU;AAAA,EACnB;AACD;","names":[]}