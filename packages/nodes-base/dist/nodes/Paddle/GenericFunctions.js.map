{"version":3,"sources":["../../../nodes/Paddle/GenericFunctions.ts"],"sourcesContent":["import type {\n\tJsonObject,\n\tIExecuteFunctions,\n\tIHookFunctions,\n\tILoadOptionsFunctions,\n\tIWebhookFunctions,\n\tIDataObject,\n\tIHttpRequestMethods,\n\tIRequestOptions,\n} from 'n8n-workflow';\nimport { NodeApiError } from 'n8n-workflow';\n\nexport async function paddleApiRequest(\n\tthis: IHookFunctions | IExecuteFunctions | ILoadOptionsFunctions | IWebhookFunctions,\n\tendpoint: string,\n\tmethod: IHttpRequestMethods,\n\n\tbody: any = {},\n\t_query?: IDataObject,\n\t_uri?: string,\n): Promise<any> {\n\tconst credentials = await this.getCredentials('paddleApi');\n\tconst productionUrl = 'https://vendors.paddle.com/api';\n\tconst sandboxUrl = 'https://sandbox-vendors.paddle.com/api';\n\n\tconst isSandbox = credentials.sandbox;\n\n\tconst options: IRequestOptions = {\n\t\tmethod,\n\t\theaders: {\n\t\t\t'content-type': 'application/json',\n\t\t},\n\t\turi: `${isSandbox === true ? sandboxUrl : productionUrl}${endpoint}`,\n\t\tbody,\n\t\tjson: true,\n\t};\n\n\tbody.vendor_id = credentials.vendorId;\n\tbody.vendor_auth_code = credentials.vendorAuthCode;\n\ttry {\n\t\tconst response = await this.helpers.request(options);\n\n\t\tif (!response.success) {\n\t\t\tthrow new NodeApiError(this.getNode(), response as JsonObject);\n\t\t}\n\n\t\treturn response;\n\t} catch (error) {\n\t\tthrow new NodeApiError(this.getNode(), error as JsonObject);\n\t}\n}\n\nexport async function paddleApiRequestAllItems(\n\tthis: IHookFunctions | IExecuteFunctions,\n\tpropertyName: string,\n\tendpoint: string,\n\tmethod: IHttpRequestMethods,\n\n\tbody: any = {},\n\tquery: IDataObject = {},\n): Promise<any> {\n\tconst returnData: IDataObject[] = [];\n\n\tlet responseData;\n\n\tbody.results_per_page = 200;\n\tbody.page = 1;\n\n\tdo {\n\t\tresponseData = await paddleApiRequest.call(this, endpoint, method, body, query);\n\t\treturnData.push.apply(returnData, responseData[propertyName] as IDataObject[]);\n\t\tbody.page++;\n\t} while (\n\t\tresponseData[propertyName].length !== 0 &&\n\t\tresponseData[propertyName].length === body.results_per_page\n\t);\n\n\treturn returnData;\n}\n\nexport function validateJSON(json: string | undefined): any {\n\tlet result;\n\ttry {\n\t\tresult = JSON.parse(json!);\n\t} catch (exception) {\n\t\tresult = undefined;\n\t}\n\treturn result;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA,0BAA6B;AAE7B,eAAsB,iBAErB,UACA,QAEA,OAAY,CAAC,GACb,QACA,MACe;AACf,QAAM,cAAc,MAAM,KAAK,eAAe,WAAW;AACzD,QAAM,gBAAgB;AACtB,QAAM,aAAa;AAEnB,QAAM,YAAY,YAAY;AAE9B,QAAM,UAA2B;AAAA,IAChC;AAAA,IACA,SAAS;AAAA,MACR,gBAAgB;AAAA,IACjB;AAAA,IACA,KAAK,GAAG,cAAc,OAAO,aAAa,aAAa,GAAG,QAAQ;AAAA,IAClE;AAAA,IACA,MAAM;AAAA,EACP;AAEA,OAAK,YAAY,YAAY;AAC7B,OAAK,mBAAmB,YAAY;AACpC,MAAI;AACH,UAAM,WAAW,MAAM,KAAK,QAAQ,QAAQ,OAAO;AAEnD,QAAI,CAAC,SAAS,SAAS;AACtB,YAAM,IAAI,iCAAa,KAAK,QAAQ,GAAG,QAAsB;AAAA,IAC9D;AAEA,WAAO;AAAA,EACR,SAAS,OAAO;AACf,UAAM,IAAI,iCAAa,KAAK,QAAQ,GAAG,KAAmB;AAAA,EAC3D;AACD;AAEA,eAAsB,yBAErB,cACA,UACA,QAEA,OAAY,CAAC,GACb,QAAqB,CAAC,GACP;AACf,QAAM,aAA4B,CAAC;AAEnC,MAAI;AAEJ,OAAK,mBAAmB;AACxB,OAAK,OAAO;AAEZ,KAAG;AACF,mBAAe,MAAM,iBAAiB,KAAK,MAAM,UAAU,QAAQ,MAAM,KAAK;AAC9E,eAAW,KAAK,MAAM,YAAY,aAAa,YAAY,CAAkB;AAC7E,SAAK;AAAA,EACN,SACC,aAAa,YAAY,EAAE,WAAW,KACtC,aAAa,YAAY,EAAE,WAAW,KAAK;AAG5C,SAAO;AACR;AAEO,SAAS,aAAa,MAA+B;AAC3D,MAAI;AACJ,MAAI;AACH,aAAS,KAAK,MAAM,IAAK;AAAA,EAC1B,SAAS,WAAW;AACnB,aAAS;AAAA,EACV;AACA,SAAO;AACR;","names":[]}