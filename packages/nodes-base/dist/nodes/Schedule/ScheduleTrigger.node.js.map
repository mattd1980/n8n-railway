{"version":3,"sources":["../../../nodes/Schedule/ScheduleTrigger.node.ts"],"sourcesContent":["import { sendAt } from 'cron';\nimport moment from 'moment-timezone';\nimport type {\n\tITriggerFunctions,\n\tINodeType,\n\tINodeTypeDescription,\n\tITriggerResponse,\n} from 'n8n-workflow';\nimport { NodeConnectionTypes, NodeOperationError } from 'n8n-workflow';\n\nimport { intervalToRecurrence, recurrenceCheck, toCronExpression } from './GenericFunctions';\nimport type { IRecurrenceRule, Rule } from './SchedulerInterface';\n\nexport class ScheduleTrigger implements INodeType {\n\tdescription: INodeTypeDescription = {\n\t\tdisplayName: 'Schedule Trigger',\n\t\tname: 'scheduleTrigger',\n\t\ticon: 'fa:clock',\n\t\tgroup: ['trigger', 'schedule'],\n\t\tversion: [1, 1.1, 1.2],\n\t\tdescription: 'Triggers the workflow on a given schedule',\n\t\teventTriggerDescription: '',\n\t\tactivationMessage:\n\t\t\t'Your schedule trigger will now trigger executions on the schedule you have defined.',\n\t\tdefaults: {\n\t\t\tname: 'Schedule Trigger',\n\t\t\tcolor: '#31C49F',\n\t\t},\n\n\t\tinputs: [],\n\t\toutputs: [NodeConnectionTypes.Main],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tdisplayName:\n\t\t\t\t\t'This workflow will run on the schedule you define here once you <a data-key=\"activate\">activate</a> it.<br><br>For testing, you can also trigger it manually: by going back to the canvas and clicking \\'execute workflow\\'',\n\t\t\t\tname: 'notice',\n\t\t\t\ttype: 'notice',\n\t\t\t\tdefault: '',\n\t\t\t},\n\t\t\t{\n\t\t\t\tdisplayName: 'Trigger Rules',\n\t\t\t\tname: 'rule',\n\t\t\t\tplaceholder: 'Add Rule',\n\t\t\t\ttype: 'fixedCollection',\n\t\t\t\ttypeOptions: {\n\t\t\t\t\tmultipleValues: true,\n\t\t\t\t},\n\t\t\t\tdefault: {\n\t\t\t\t\tinterval: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfield: 'days',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\toptions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'interval',\n\t\t\t\t\t\tdisplayName: 'Trigger Interval',\n\t\t\t\t\t\tvalues: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdisplayName: 'Trigger Interval',\n\t\t\t\t\t\t\t\tname: 'field',\n\t\t\t\t\t\t\t\ttype: 'options',\n\t\t\t\t\t\t\t\tdefault: 'days',\n\t\t\t\t\t\t\t\t// eslint-disable-next-line n8n-nodes-base/node-param-options-type-unsorted-items\n\t\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Seconds',\n\t\t\t\t\t\t\t\t\t\tvalue: 'seconds',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Minutes',\n\t\t\t\t\t\t\t\t\t\tvalue: 'minutes',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Hours',\n\t\t\t\t\t\t\t\t\t\tvalue: 'hours',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Days',\n\t\t\t\t\t\t\t\t\t\tvalue: 'days',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Weeks',\n\t\t\t\t\t\t\t\t\t\tvalue: 'weeks',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Months',\n\t\t\t\t\t\t\t\t\t\tvalue: 'months',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Custom (Cron)',\n\t\t\t\t\t\t\t\t\t\tvalue: 'cronExpression',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdisplayName: 'Seconds Between Triggers',\n\t\t\t\t\t\t\t\tname: 'secondsInterval',\n\t\t\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\t\t\tdefault: 30,\n\t\t\t\t\t\t\t\tdisplayOptions: {\n\t\t\t\t\t\t\t\t\tshow: {\n\t\t\t\t\t\t\t\t\t\tfield: ['seconds'],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdescription: 'Number of seconds between each workflow trigger',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdisplayName: 'Minutes Between Triggers',\n\t\t\t\t\t\t\t\tname: 'minutesInterval',\n\t\t\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\t\t\tdefault: 5,\n\t\t\t\t\t\t\t\tdisplayOptions: {\n\t\t\t\t\t\t\t\t\tshow: {\n\t\t\t\t\t\t\t\t\t\tfield: ['minutes'],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdescription: 'Number of minutes between each workflow trigger',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdisplayName: 'Hours Between Triggers',\n\t\t\t\t\t\t\t\tname: 'hoursInterval',\n\t\t\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\t\t\tdisplayOptions: {\n\t\t\t\t\t\t\t\t\tshow: {\n\t\t\t\t\t\t\t\t\t\tfield: ['hours'],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdefault: 1,\n\t\t\t\t\t\t\t\tdescription: 'Number of hours between each workflow trigger',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdisplayName: 'Days Between Triggers',\n\t\t\t\t\t\t\t\tname: 'daysInterval',\n\t\t\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\t\t\tdisplayOptions: {\n\t\t\t\t\t\t\t\t\tshow: {\n\t\t\t\t\t\t\t\t\t\tfield: ['days'],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdefault: 1,\n\t\t\t\t\t\t\t\tdescription: 'Number of days between each workflow trigger',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdisplayName: 'Weeks Between Triggers',\n\t\t\t\t\t\t\t\tname: 'weeksInterval',\n\t\t\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\t\t\tdisplayOptions: {\n\t\t\t\t\t\t\t\t\tshow: {\n\t\t\t\t\t\t\t\t\t\tfield: ['weeks'],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdefault: 1,\n\t\t\t\t\t\t\t\tdescription: 'Would run every week unless specified otherwise',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdisplayName: 'Months Between Triggers',\n\t\t\t\t\t\t\t\tname: 'monthsInterval',\n\t\t\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\t\t\tdisplayOptions: {\n\t\t\t\t\t\t\t\t\tshow: {\n\t\t\t\t\t\t\t\t\t\tfield: ['months'],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdefault: 1,\n\t\t\t\t\t\t\t\tdescription: 'Would run every month unless specified otherwise',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdisplayName: 'Trigger at Day of Month',\n\t\t\t\t\t\t\t\tname: 'triggerAtDayOfMonth',\n\t\t\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\t\t\tdisplayOptions: {\n\t\t\t\t\t\t\t\t\tshow: {\n\t\t\t\t\t\t\t\t\t\tfield: ['months'],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttypeOptions: {\n\t\t\t\t\t\t\t\t\tminValue: 1,\n\t\t\t\t\t\t\t\t\tmaxValue: 31,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdefault: 1,\n\t\t\t\t\t\t\t\tdescription: 'The day of the month to trigger (1-31)',\n\t\t\t\t\t\t\t\thint: 'If a month doesn’t have this day, the node won’t trigger',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdisplayName: 'Trigger on Weekdays',\n\t\t\t\t\t\t\t\tname: 'triggerAtDay',\n\t\t\t\t\t\t\t\ttype: 'multiOptions',\n\t\t\t\t\t\t\t\tdisplayOptions: {\n\t\t\t\t\t\t\t\t\tshow: {\n\t\t\t\t\t\t\t\t\t\tfield: ['weeks'],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttypeOptions: {\n\t\t\t\t\t\t\t\t\tmaxValue: 7,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Monday',\n\t\t\t\t\t\t\t\t\t\tvalue: 1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Tuesday',\n\t\t\t\t\t\t\t\t\t\tvalue: 2,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Wednesday',\n\t\t\t\t\t\t\t\t\t\tvalue: 3,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Thursday',\n\t\t\t\t\t\t\t\t\t\tvalue: 4,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Friday',\n\t\t\t\t\t\t\t\t\t\tvalue: 5,\n\t\t\t\t\t\t\t\t\t},\n\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Saturday',\n\t\t\t\t\t\t\t\t\t\tvalue: 6,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Sunday',\n\t\t\t\t\t\t\t\t\t\tvalue: 0,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\tdefault: [0],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdisplayName: 'Trigger at Hour',\n\t\t\t\t\t\t\t\tname: 'triggerAtHour',\n\t\t\t\t\t\t\t\ttype: 'options',\n\t\t\t\t\t\t\t\tdefault: 0,\n\t\t\t\t\t\t\t\tdisplayOptions: {\n\t\t\t\t\t\t\t\t\tshow: {\n\t\t\t\t\t\t\t\t\t\tfield: ['days', 'weeks', 'months'],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Midnight',\n\t\t\t\t\t\t\t\t\t\tdisplayName: 'Midnight',\n\t\t\t\t\t\t\t\t\t\tvalue: 0,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '1am',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '1am',\n\t\t\t\t\t\t\t\t\t\tvalue: 1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '2am',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '2am',\n\t\t\t\t\t\t\t\t\t\tvalue: 2,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '3am',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '3am',\n\t\t\t\t\t\t\t\t\t\tvalue: 3,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '4am',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '4am',\n\t\t\t\t\t\t\t\t\t\tvalue: 4,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '5am',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '5am',\n\t\t\t\t\t\t\t\t\t\tvalue: 5,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '6am',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '6am',\n\t\t\t\t\t\t\t\t\t\tvalue: 6,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '7am',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '7am',\n\t\t\t\t\t\t\t\t\t\tvalue: 7,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '8am',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '8am',\n\t\t\t\t\t\t\t\t\t\tvalue: 8,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '9am',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '9am',\n\t\t\t\t\t\t\t\t\t\tvalue: 9,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '10am',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '10am',\n\t\t\t\t\t\t\t\t\t\tvalue: 10,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '11am',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '11am',\n\t\t\t\t\t\t\t\t\t\tvalue: 11,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: 'Noon',\n\t\t\t\t\t\t\t\t\t\tdisplayName: 'Noon',\n\t\t\t\t\t\t\t\t\t\tvalue: 12,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '1pm',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '1pm',\n\t\t\t\t\t\t\t\t\t\tvalue: 13,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '2pm',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '2pm',\n\t\t\t\t\t\t\t\t\t\tvalue: 14,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '3pm',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '3pm',\n\t\t\t\t\t\t\t\t\t\tvalue: 15,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '4pm',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '4pm',\n\t\t\t\t\t\t\t\t\t\tvalue: 16,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '5pm',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '5pm',\n\t\t\t\t\t\t\t\t\t\tvalue: 17,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '6pm',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '6pm',\n\t\t\t\t\t\t\t\t\t\tvalue: 18,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '7pm',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '7pm',\n\t\t\t\t\t\t\t\t\t\tvalue: 19,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '8pm',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '8pm',\n\t\t\t\t\t\t\t\t\t\tvalue: 20,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '9pm',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '9pm',\n\t\t\t\t\t\t\t\t\t\tvalue: 21,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '10pm',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '10pm',\n\t\t\t\t\t\t\t\t\t\tvalue: 22,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: '11pm',\n\t\t\t\t\t\t\t\t\t\tdisplayName: '11pm',\n\t\t\t\t\t\t\t\t\t\tvalue: 23,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\tdescription: 'The hour of the day to trigger',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdisplayName: 'Trigger at Minute',\n\t\t\t\t\t\t\t\tname: 'triggerAtMinute',\n\t\t\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\t\t\tdefault: 0,\n\t\t\t\t\t\t\t\tdisplayOptions: {\n\t\t\t\t\t\t\t\t\tshow: {\n\t\t\t\t\t\t\t\t\t\tfield: ['hours', 'days', 'weeks', 'months'],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttypeOptions: {\n\t\t\t\t\t\t\t\t\tminValue: 0,\n\t\t\t\t\t\t\t\t\tmaxValue: 59,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdescription: 'The minute past the hour to trigger (0-59)',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdisplayName:\n\t\t\t\t\t\t\t\t\t'You can find help generating your cron expression <a href=\"https://crontab.guru/examples.html\" target=\"_blank\">here</a>',\n\t\t\t\t\t\t\t\tname: 'notice',\n\t\t\t\t\t\t\t\ttype: 'notice',\n\t\t\t\t\t\t\t\tdisplayOptions: {\n\t\t\t\t\t\t\t\t\tshow: {\n\t\t\t\t\t\t\t\t\t\tfield: ['cronExpression'],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdefault: '',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdisplayName: 'Expression',\n\t\t\t\t\t\t\t\tname: 'expression',\n\t\t\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\t\t\tdefault: '',\n\t\t\t\t\t\t\t\tplaceholder: 'eg. 0 15 * 1 sun',\n\t\t\t\t\t\t\t\tdisplayOptions: {\n\t\t\t\t\t\t\t\t\tshow: {\n\t\t\t\t\t\t\t\t\t\tfield: ['cronExpression'],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\thint: 'Format: [Second] [Minute] [Hour] [Day of Month] [Month] [Day of Week]',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t],\n\t};\n\n\tasync trigger(this: ITriggerFunctions): Promise<ITriggerResponse> {\n\t\tconst { interval: intervals } = this.getNodeParameter('rule', []) as Rule;\n\t\tconst timezone = this.getTimezone();\n\t\tconst staticData = this.getWorkflowStaticData('node') as {\n\t\t\trecurrenceRules: number[];\n\t\t};\n\t\tif (!staticData.recurrenceRules) {\n\t\t\tstaticData.recurrenceRules = [];\n\t\t}\n\n\t\tconst executeTrigger = (recurrence: IRecurrenceRule) => {\n\t\t\tconst shouldTrigger = recurrenceCheck(recurrence, staticData.recurrenceRules, timezone);\n\t\t\tif (!shouldTrigger) return;\n\n\t\t\tconst momentTz = moment.tz(timezone);\n\t\t\tconst resultData = {\n\t\t\t\ttimestamp: momentTz.toISOString(true),\n\t\t\t\t'Readable date': momentTz.format('MMMM Do YYYY, h:mm:ss a'),\n\t\t\t\t'Readable time': momentTz.format('h:mm:ss a'),\n\t\t\t\t'Day of week': momentTz.format('dddd'),\n\t\t\t\tYear: momentTz.format('YYYY'),\n\t\t\t\tMonth: momentTz.format('MMMM'),\n\t\t\t\t'Day of month': momentTz.format('DD'),\n\t\t\t\tHour: momentTz.format('HH'),\n\t\t\t\tMinute: momentTz.format('mm'),\n\t\t\t\tSecond: momentTz.format('ss'),\n\t\t\t\tTimezone: `${timezone} (UTC${momentTz.format('Z')})`,\n\t\t\t};\n\n\t\t\tthis.emit([this.helpers.returnJsonArray([resultData])]);\n\t\t};\n\n\t\tconst rules = intervals.map((interval, i) => ({\n\t\t\tinterval,\n\t\t\tcronExpression: toCronExpression(interval),\n\t\t\trecurrence: intervalToRecurrence(interval, i),\n\t\t}));\n\n\t\tif (this.getMode() !== 'manual') {\n\t\t\tfor (const { interval, cronExpression, recurrence } of rules) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.helpers.registerCron(cronExpression, () => executeTrigger(recurrence));\n\t\t\t\t} catch (error) {\n\t\t\t\t\tif (interval.field === 'cronExpression') {\n\t\t\t\t\t\tthrow new NodeOperationError(this.getNode(), 'Invalid cron expression', {\n\t\t\t\t\t\t\tdescription: 'More information on how to build them at https://crontab.guru/',\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow error;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {};\n\t\t} else {\n\t\t\tconst manualTriggerFunction = async () => {\n\t\t\t\tconst { interval, cronExpression, recurrence } = rules[0];\n\t\t\t\tif (interval.field === 'cronExpression') {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tsendAt(cronExpression);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tthrow new NodeOperationError(this.getNode(), 'Invalid cron expression', {\n\t\t\t\t\t\t\tdescription: 'More information on how to build them at https://crontab.guru/',\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\texecuteTrigger(recurrence);\n\t\t\t};\n\n\t\t\treturn { manualTriggerFunction };\n\t\t}\n\t}\n}\n"],"mappings":"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oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,oBACA;AAAA,sBACC,MAAM;AAAA,sBACN,aAAa;AAAA,sBACb,OAAO;AAAA,oBACR;AAAA,kBACD;AAAA,kBACA,aAAa;AAAA,gBACd;AAAA,gBACA;AAAA,kBACC,aAAa;AAAA,kBACb,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,SAAS;AAAA,kBACT,gBAAgB;AAAA,oBACf,MAAM;AAAA,sBACL,OAAO,CAAC,SAAS,QAAQ,SAAS,QAAQ;AAAA,oBAC3C;AAAA,kBACD;AAAA,kBACA,aAAa;AAAA,oBACZ,UAAU;AAAA,oBACV,UAAU;AAAA,kBACX;AAAA,kBACA,aAAa;AAAA,gBACd;AAAA,gBACA;AAAA,kBACC,aACC;AAAA,kBACD,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,gBAAgB;AAAA,oBACf,MAAM;AAAA,sBACL,OAAO,CAAC,gBAAgB;AAAA,oBACzB;AAAA,kBACD;AAAA,kBACA,SAAS;AAAA,gBACV;AAAA,gBACA;AAAA,kBACC,aAAa;AAAA,kBACb,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,SAAS;AAAA,kBACT,aAAa;AAAA,kBACb,gBAAgB;AAAA,oBACf,MAAM;AAAA,sBACL,OAAO,CAAC,gBAAgB;AAAA,oBACzB;AAAA,kBACD;AAAA,kBACA,MAAM;AAAA,gBACP;AAAA,cACD;AAAA,YACD;AAAA,UACD;AAAA,QACD;AAAA,MACD;AAAA,IACD;AAAA;AAAA,EAEA,MAAM,UAA4D;AACjE,UAAM,EAAE,UAAU,UAAU,IAAI,KAAK,iBAAiB,QAAQ,CAAC,CAAC;AAChE,UAAM,WAAW,KAAK,YAAY;AAClC,UAAM,aAAa,KAAK,sBAAsB,MAAM;AAGpD,QAAI,CAAC,WAAW,iBAAiB;AAChC,iBAAW,kBAAkB,CAAC;AAAA,IAC/B;AAEA,UAAM,iBAAiB,CAAC,eAAgC;AACvD,YAAM,oBAAgB,yCAAgB,YAAY,WAAW,iBAAiB,QAAQ;AACtF,UAAI,CAAC,cAAe;AAEpB,YAAM,WAAW,uBAAAA,QAAO,GAAG,QAAQ;AACnC,YAAM,aAAa;AAAA,QAClB,WAAW,SAAS,YAAY,IAAI;AAAA,QACpC,iBAAiB,SAAS,OAAO,yBAAyB;AAAA,QAC1D,iBAAiB,SAAS,OAAO,WAAW;AAAA,QAC5C,eAAe,SAAS,OAAO,MAAM;AAAA,QACrC,MAAM,SAAS,OAAO,MAAM;AAAA,QAC5B,OAAO,SAAS,OAAO,MAAM;AAAA,QAC7B,gBAAgB,SAAS,OAAO,IAAI;AAAA,QACpC,MAAM,SAAS,OAAO,IAAI;AAAA,QAC1B,QAAQ,SAAS,OAAO,IAAI;AAAA,QAC5B,QAAQ,SAAS,OAAO,IAAI;AAAA,QAC5B,UAAU,GAAG,QAAQ,QAAQ,SAAS,OAAO,GAAG,CAAC;AAAA,MAClD;AAEA,WAAK,KAAK,CAAC,KAAK,QAAQ,gBAAgB,CAAC,UAAU,CAAC,CAAC,CAAC;AAAA,IACvD;AAEA,UAAM,QAAQ,UAAU,IAAI,CAAC,UAAU,OAAO;AAAA,MAC7C;AAAA,MACA,oBAAgB,0CAAiB,QAAQ;AAAA,MACzC,gBAAY,8CAAqB,UAAU,CAAC;AAAA,IAC7C,EAAE;AAEF,QAAI,KAAK,QAAQ,MAAM,UAAU;AAChC,iBAAW,EAAE,UAAU,gBAAgB,WAAW,KAAK,OAAO;AAC7D,YAAI;AACH,eAAK,QAAQ,aAAa,gBAAgB,MAAM,eAAe,UAAU,CAAC;AAAA,QAC3E,SAAS,OAAO;AACf,cAAI,SAAS,UAAU,kBAAkB;AACxC,kBAAM,IAAI,uCAAmB,KAAK,QAAQ,GAAG,2BAA2B;AAAA,cACvE,aAAa;AAAA,YACd,CAAC;AAAA,UACF,OAAO;AACN,kBAAM;AAAA,UACP;AAAA,QACD;AAAA,MACD;AACA,aAAO,CAAC;AAAA,IACT,OAAO;AACN,YAAM,wBAAwB,YAAY;AACzC,cAAM,EAAE,UAAU,gBAAgB,WAAW,IAAI,MAAM,CAAC;AACxD,YAAI,SAAS,UAAU,kBAAkB;AACxC,cAAI;AACH,oCAAO,cAAc;AAAA,UACtB,SAAS,OAAO;AACf,kBAAM,IAAI,uCAAmB,KAAK,QAAQ,GAAG,2BAA2B;AAAA,cACvE,aAAa;AAAA,YACd,CAAC;AAAA,UACF;AAAA,QACD;AACA,uBAAe,UAAU;AAAA,MAC1B;AAEA,aAAO,EAAE,sBAAsB;AAAA,IAChC;AAAA,EACD;AACD;","names":["moment"]}