{"version":3,"sources":["../../../nodes/N8nTrigger/N8nTrigger.node.ts"],"sourcesContent":["import type {\n\tITriggerFunctions,\n\tINodeType,\n\tINodeTypeDescription,\n\tITriggerResponse,\n} from 'n8n-workflow';\nimport { NodeConnectionTypes } from 'n8n-workflow';\n\ntype eventType = 'Instance started' | 'Workflow activated' | 'Workflow updated' | undefined;\n\nexport class N8nTrigger implements INodeType {\n\tdescription: INodeTypeDescription = {\n\t\tdisplayName: 'n8n Trigger',\n\t\tname: 'n8nTrigger',\n\t\ticon: 'file:n8nTrigger.svg',\n\t\tgroup: ['trigger'],\n\t\tversion: 1,\n\t\tdescription: 'Handle events and perform actions on your n8n instance',\n\t\teventTriggerDescription: '',\n\t\tmockManualExecution: true,\n\t\tdefaults: {\n\t\t\tname: 'n8n Trigger',\n\t\t},\n\t\tinputs: [],\n\t\toutputs: [NodeConnectionTypes.Main],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tdisplayName: 'Events',\n\t\t\t\tname: 'events',\n\t\t\t\ttype: 'multiOptions',\n\t\t\t\trequired: true,\n\t\t\t\tdefault: [],\n\t\t\t\tdescription: `Specifies under which conditions an execution should happen:\n\t\t\t\t<ul>\n\t\t\t\t\t<li><b>Active Workflow Updated</b>: Triggers when this workflow is updated</li>\n\t\t\t\t\t<li><b>Instance Started</b>:  Triggers when this n8n instance is started or re-started</li>\n\t\t\t\t\t<li><b>Workflow Activated</b>: Triggers when this workflow is activated</li>\n\t\t\t\t</ul>`,\n\t\t\t\toptions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Active Workflow Updated',\n\t\t\t\t\t\tvalue: 'update',\n\t\t\t\t\t\tdescription: 'Triggers when this workflow is updated',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Instance Started',\n\t\t\t\t\t\tvalue: 'init',\n\t\t\t\t\t\tdescription: 'Triggers when this n8n instance is started or re-started',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'Workflow Activated',\n\t\t\t\t\t\tvalue: 'activate',\n\t\t\t\t\t\tdescription: 'Triggers when this workflow is activated',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t],\n\t};\n\n\tasync trigger(this: ITriggerFunctions): Promise<ITriggerResponse> {\n\t\tconst events = (this.getNodeParameter('events') as string[]) || [];\n\n\t\tconst activationMode = this.getActivationMode();\n\n\t\tif (events.includes(activationMode)) {\n\t\t\tlet event: eventType;\n\t\t\tif (activationMode === 'activate') {\n\t\t\t\tevent = 'Workflow activated';\n\t\t\t}\n\t\t\tif (activationMode === 'update') {\n\t\t\t\tevent = 'Workflow updated';\n\t\t\t}\n\t\t\tif (activationMode === 'init') {\n\t\t\t\tevent = 'Instance started';\n\t\t\t}\n\t\t\tthis.emit([\n\t\t\t\tthis.helpers.returnJsonArray([\n\t\t\t\t\t{ event, timestamp: new Date().toISOString(), workflow_id: this.getWorkflow().id },\n\t\t\t\t]),\n\t\t\t]);\n\t\t}\n\n\t\tconst manualTriggerFunction = async () => {\n\t\t\tthis.emit([\n\t\t\t\tthis.helpers.returnJsonArray([\n\t\t\t\t\t{\n\t\t\t\t\t\tevent: 'Manual execution',\n\t\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\t\tworkflow_id: this.getWorkflow().id,\n\t\t\t\t\t},\n\t\t\t\t]),\n\t\t\t]);\n\t\t};\n\n\t\treturn {\n\t\t\tmanualTriggerFunction,\n\t\t};\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA,0BAAoC;AAI7B,MAAM,WAAgC;AAAA,EAAtC;AACN,uBAAoC;AAAA,MACnC,aAAa;AAAA,MACb,MAAM;AAAA,MACN,MAAM;AAAA,MACN,OAAO,CAAC,SAAS;AAAA,MACjB,SAAS;AAAA,MACT,aAAa;AAAA,MACb,yBAAyB;AAAA,MACzB,qBAAqB;AAAA,MACrB,UAAU;AAAA,QACT,MAAM;AAAA,MACP;AAAA,MACA,QAAQ,CAAC;AAAA,MACT,SAAS,CAAC,wCAAoB,IAAI;AAAA,MAClC,YAAY;AAAA,QACX;AAAA,UACC,aAAa;AAAA,UACb,MAAM;AAAA,UACN,MAAM;AAAA,UACN,UAAU;AAAA,UACV,SAAS,CAAC;AAAA,UACV,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAMb,SAAS;AAAA,YACR;AAAA,cACC,MAAM;AAAA,cACN,OAAO;AAAA,cACP,aAAa;AAAA,YACd;AAAA,YACA;AAAA,cACC,MAAM;AAAA,cACN,OAAO;AAAA,cACP,aAAa;AAAA,YACd;AAAA,YACA;AAAA,cACC,MAAM;AAAA,cACN,OAAO;AAAA,cACP,aAAa;AAAA,YACd;AAAA,UACD;AAAA,QACD;AAAA,MACD;AAAA,IACD;AAAA;AAAA,EAEA,MAAM,UAA4D;AACjE,UAAM,SAAU,KAAK,iBAAiB,QAAQ,KAAkB,CAAC;AAEjE,UAAM,iBAAiB,KAAK,kBAAkB;AAE9C,QAAI,OAAO,SAAS,cAAc,GAAG;AACpC,UAAI;AACJ,UAAI,mBAAmB,YAAY;AAClC,gBAAQ;AAAA,MACT;AACA,UAAI,mBAAmB,UAAU;AAChC,gBAAQ;AAAA,MACT;AACA,UAAI,mBAAmB,QAAQ;AAC9B,gBAAQ;AAAA,MACT;AACA,WAAK,KAAK;AAAA,QACT,KAAK,QAAQ,gBAAgB;AAAA,UAC5B,EAAE,OAAO,YAAW,oBAAI,KAAK,GAAE,YAAY,GAAG,aAAa,KAAK,YAAY,EAAE,GAAG;AAAA,QAClF,CAAC;AAAA,MACF,CAAC;AAAA,IACF;AAEA,UAAM,wBAAwB,YAAY;AACzC,WAAK,KAAK;AAAA,QACT,KAAK,QAAQ,gBAAgB;AAAA,UAC5B;AAAA,YACC,OAAO;AAAA,YACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,YAClC,aAAa,KAAK,YAAY,EAAE;AAAA,UACjC;AAAA,QACD,CAAC;AAAA,MACF,CAAC;AAAA,IACF;AAEA,WAAO;AAAA,MACN;AAAA,IACD;AAAA,EACD;AACD;","names":[]}