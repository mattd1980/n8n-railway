{"version":3,"sources":["../../../../../nodes/Splunk/v2/actions/router.ts"],"sourcesContent":["import set from 'lodash/set';\nimport type { IExecuteFunctions, INodeExecutionData } from 'n8n-workflow';\nimport { NodeApiError, NodeOperationError } from 'n8n-workflow';\n\nimport * as alert from './alert';\nimport type { SplunkType } from './node.type';\nimport * as report from './report';\nimport * as search from './search';\nimport * as user from './user';\n\nexport async function router(this: IExecuteFunctions): Promise<INodeExecutionData[][]> {\n\tconst items = this.getInputData();\n\tlet returnData: INodeExecutionData[] = [];\n\n\tconst resource = this.getNodeParameter<SplunkType>('resource', 0);\n\tconst operation = this.getNodeParameter('operation', 0);\n\n\tconst splunkNodeData = {\n\t\tresource,\n\t\toperation,\n\t} as SplunkType;\n\n\tlet responseData;\n\n\tfor (let i = 0; i < items.length; i++) {\n\t\ttry {\n\t\t\tswitch (splunkNodeData.resource) {\n\t\t\t\tcase 'alert':\n\t\t\t\t\tresponseData = await alert[splunkNodeData.operation].execute.call(this, i);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'report':\n\t\t\t\t\tresponseData = await report[splunkNodeData.operation].execute.call(this, i);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'search':\n\t\t\t\t\tresponseData = await search[splunkNodeData.operation].execute.call(this, i);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'user':\n\t\t\t\t\tresponseData = await user[splunkNodeData.operation].execute.call(this, i);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new NodeOperationError(this.getNode(), 'Resource not found', { itemIndex: i });\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tif (this.continueOnFail()) {\n\t\t\t\treturnData.push({ json: { error: error.cause.error }, pairedItem: { item: i } });\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (error instanceof NodeApiError) {\n\t\t\t\tset(error, 'context.itemIndex', i);\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\tif (error instanceof NodeOperationError) {\n\t\t\t\tif (error?.context?.itemIndex === undefined) {\n\t\t\t\t\tset(error, 'context.itemIndex', i);\n\t\t\t\t}\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\tthrow new NodeOperationError(this.getNode(), error, { itemIndex: i });\n\t\t}\n\n\t\tconst executionData = this.helpers.constructExecutionMetaData(\n\t\t\tthis.helpers.returnJsonArray(responseData),\n\t\t\t{ itemData: { item: i } },\n\t\t);\n\n\t\treturnData = returnData.concat(executionData);\n\t}\n\n\treturn [returnData];\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAgB;AAEhB,0BAAiD;AAEjD,YAAuB;AAEvB,aAAwB;AACxB,aAAwB;AACxB,WAAsB;AAEtB,eAAsB,SAAiE;AACtF,QAAM,QAAQ,KAAK,aAAa;AAChC,MAAI,aAAmC,CAAC;AAExC,QAAM,WAAW,KAAK,iBAA6B,YAAY,CAAC;AAChE,QAAM,YAAY,KAAK,iBAAiB,aAAa,CAAC;AAEtD,QAAM,iBAAiB;AAAA,IACtB;AAAA,IACA;AAAA,EACD;AAEA,MAAI;AAEJ,WAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACtC,QAAI;AACH,cAAQ,eAAe,UAAU;AAAA,QAChC,KAAK;AACJ,yBAAe,MAAM,MAAM,eAAe,SAAS,EAAE,QAAQ,KAAK,MAAM,CAAC;AACzE;AAAA,QACD,KAAK;AACJ,yBAAe,MAAM,OAAO,eAAe,SAAS,EAAE,QAAQ,KAAK,MAAM,CAAC;AAC1E;AAAA,QACD,KAAK;AACJ,yBAAe,MAAM,OAAO,eAAe,SAAS,EAAE,QAAQ,KAAK,MAAM,CAAC;AAC1E;AAAA,QACD,KAAK;AACJ,yBAAe,MAAM,KAAK,eAAe,SAAS,EAAE,QAAQ,KAAK,MAAM,CAAC;AACxE;AAAA,QACD;AACC,gBAAM,IAAI,uCAAmB,KAAK,QAAQ,GAAG,sBAAsB,EAAE,WAAW,EAAE,CAAC;AAAA,MACrF;AAAA,IACD,SAAS,OAAO;AACf,UAAI,KAAK,eAAe,GAAG;AAC1B,mBAAW,KAAK,EAAE,MAAM,EAAE,OAAO,MAAM,MAAM,MAAM,GAAG,YAAY,EAAE,MAAM,EAAE,EAAE,CAAC;AAC/E;AAAA,MACD;AAEA,UAAI,iBAAiB,kCAAc;AAClC,uBAAAA,SAAI,OAAO,qBAAqB,CAAC;AACjC,cAAM;AAAA,MACP;AAEA,UAAI,iBAAiB,wCAAoB;AACxC,YAAI,OAAO,SAAS,cAAc,QAAW;AAC5C,yBAAAA,SAAI,OAAO,qBAAqB,CAAC;AAAA,QAClC;AACA,cAAM;AAAA,MACP;AAEA,YAAM,IAAI,uCAAmB,KAAK,QAAQ,GAAG,OAAO,EAAE,WAAW,EAAE,CAAC;AAAA,IACrE;AAEA,UAAM,gBAAgB,KAAK,QAAQ;AAAA,MAClC,KAAK,QAAQ,gBAAgB,YAAY;AAAA,MACzC,EAAE,UAAU,EAAE,MAAM,EAAE,EAAE;AAAA,IACzB;AAEA,iBAAa,WAAW,OAAO,aAAa;AAAA,EAC7C;AAEA,SAAO,CAAC,UAAU;AACnB;","names":["set"]}